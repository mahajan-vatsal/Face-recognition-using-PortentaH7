\doxysection{lstm\+\_\+test\+\_\+data\+\_\+utils Namespace Reference}
\hypertarget{namespacelstm__test__data__utils}{}\label{namespacelstm__test__data__utils}\index{lstm\_test\_data\_utils@{lstm\_test\_data\_utils}}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classlstm__test__data__utils_1_1_quantized_gate_params}{Quantized\+Gate\+Params}}
\item 
class \mbox{\hyperlink{classlstm__test__data__utils_1_1_quantized_l_s_t_m_debugger}{Quantized\+LSTMDebugger}}
\item 
class \mbox{\hyperlink{classlstm__test__data__utils_1_1_quantized_tensor}{Quantized\+Tensor}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacelstm__test__data__utils_a327410e0daa0da035f8ea5a2890a808a}{clip\+\_\+range}} (vals, bit\+\_\+width)
\item 
\mbox{\hyperlink{namespacelstm__test__data__utils_a7cf8b8670a8bbaac9fb1940e8782e694}{quantize\+\_\+data}} (\mbox{\hyperlink{hello__world__model_8cc_ab2a9259b73b53c0bb06a6b242aa7ae32}{data}}, \mbox{\hyperlink{batch__matmul__test_8cc_ab89fe30f475eefcbf59653d919c456bd}{scale}}, \mbox{\hyperlink{batch__matmul__test_8cc_a26c07acd3fa6a6da13ddae2bc5c64b55}{zero\+\_\+point}}=0, bit\+\_\+width=8)
\item 
\mbox{\hyperlink{namespacelstm__test__data__utils_a3eb7d7e300844d06151ee2b2e3361f73}{dequantize\+\_\+data}} (\mbox{\hyperlink{batch__matmul__test_8cc_a960b49b4072eb4f96ad154be724c49f5}{quantized\+\_\+data}}, \mbox{\hyperlink{batch__matmul__test_8cc_ab89fe30f475eefcbf59653d919c456bd}{scale}}, \mbox{\hyperlink{batch__matmul__test_8cc_a26c07acd3fa6a6da13ddae2bc5c64b55}{zero\+\_\+point}}=0)
\item 
\mbox{\hyperlink{namespacelstm__test__data__utils_a4d4251bdb6ad5b553bdcaaebe552bdc1}{rescale}} (\mbox{\hyperlink{hello__world__model_8cc_ab2a9259b73b53c0bb06a6b242aa7ae32}{data}}, effective\+\_\+scale, \mbox{\hyperlink{batch__matmul__test_8cc_a26c07acd3fa6a6da13ddae2bc5c64b55}{zero\+\_\+point}}, num\+\_\+bits)
\item 
\mbox{\hyperlink{namespacelstm__test__data__utils_a39a9c01919d9508ee0c23c5c72614815}{calculate\+\_\+scale}} (min\+\_\+val, max\+\_\+val, num\+\_\+bits=8, symmetry=False)
\item 
\mbox{\hyperlink{namespacelstm__test__data__utils_a25183b71d2b246f6c094ff358edf8a3a}{calculate\+\_\+zp}} (min\+\_\+val, \mbox{\hyperlink{batch__matmul__test_8cc_ab89fe30f475eefcbf59653d919c456bd}{scale}}, num\+\_\+bits=8)
\item 
\mbox{\hyperlink{namespacelstm__test__data__utils_ad681f4ef7a02f011b2795851b7715d1e}{sigmoid}} (\mbox{\hyperlink{_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcbb3c8e6cb6b1b9e60f2136ee8b58a8b6_a6150e0515f7202e2fb518f7206ed97dc}{x}})
\item 
\mbox{\hyperlink{namespacelstm__test__data__utils_a9f75e3ef5e81fc5426200ee40b5d7cc2}{quantized\+\_\+sigmoid}} (\mbox{\hyperlink{_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2src5afb18c45f6346167aa977a363205143_a9cebfb3d6ddd692fbdd268cf4b9ad024}{input}}, input\+\_\+scale, \mbox{\hyperlink{micro_2kernels_2filter__bank__log_8cc_aad7699ab55cc1f497d8d2861fd2d0dd2}{output\+\_\+scale}}, num\+\_\+bits=16)
\item 
\mbox{\hyperlink{namespacelstm__test__data__utils_a0b66b84f63642eb3e13a16135efadc5d}{quantized\+\_\+tanh}} (\mbox{\hyperlink{_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2src5afb18c45f6346167aa977a363205143_a9cebfb3d6ddd692fbdd268cf4b9ad024}{input}}, input\+\_\+scale, \mbox{\hyperlink{micro_2kernels_2filter__bank__log_8cc_aad7699ab55cc1f497d8d2861fd2d0dd2}{output\+\_\+scale}}, num\+\_\+bits=16)
\item 
\mbox{\hyperlink{namespacelstm__test__data__utils_a170cd9f97c42040386ad1dddfea187d5}{assemble\+\_\+quantized\+\_\+tensor}} (float\+\_\+data, min\+\_\+val, max\+\_\+val, symmetry, num\+\_\+bits=8)
\item 
\mbox{\hyperlink{namespacelstm__test__data__utils_a25df5d07fd2a5825645437db7104fabc}{create\+\_\+gate\+\_\+params}} (gate\+\_\+parameters, model\+\_\+config, modulation=False)
\item 
\mbox{\hyperlink{namespacelstm__test__data__utils_ac6cb9277bd104fd458d547c47cb22bda}{gate\+\_\+calculation}} (\mbox{\hyperlink{_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2src5afb18c45f6346167aa977a363205143_a9cebfb3d6ddd692fbdd268cf4b9ad024}{input}}, hidden\+\_\+state, gate\+\_\+params, \mbox{\hyperlink{ei__fill__result__struct_8h_a881f62341b5a41a3c5707268bd537be1}{debug}}=False)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Utils to lstm_test_data_generator.py that helps to generate the test data for lstm kernel (lstm_test_data.cc)\end{DoxyVerb}
 

\doxysubsection{Function Documentation}
\Hypertarget{namespacelstm__test__data__utils_a170cd9f97c42040386ad1dddfea187d5}\index{lstm\_test\_data\_utils@{lstm\_test\_data\_utils}!assemble\_quantized\_tensor@{assemble\_quantized\_tensor}}
\index{assemble\_quantized\_tensor@{assemble\_quantized\_tensor}!lstm\_test\_data\_utils@{lstm\_test\_data\_utils}}
\doxysubsubsection{\texorpdfstring{assemble\_quantized\_tensor()}{assemble\_quantized\_tensor()}}
{\footnotesize\ttfamily \label{namespacelstm__test__data__utils_a170cd9f97c42040386ad1dddfea187d5} 
lstm\+\_\+test\+\_\+data\+\_\+utils.\+assemble\+\_\+quantized\+\_\+tensor (\begin{DoxyParamCaption}\item[{}]{float\+\_\+data}{, }\item[{}]{min\+\_\+val}{, }\item[{}]{max\+\_\+val}{, }\item[{}]{symmetry}{, }\item[{}]{num\+\_\+bits}{ = {\ttfamily 8}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Create a QuantizedTensor using floating point data, range information, and bit width\end{DoxyVerb}
 \Hypertarget{namespacelstm__test__data__utils_a39a9c01919d9508ee0c23c5c72614815}\index{lstm\_test\_data\_utils@{lstm\_test\_data\_utils}!calculate\_scale@{calculate\_scale}}
\index{calculate\_scale@{calculate\_scale}!lstm\_test\_data\_utils@{lstm\_test\_data\_utils}}
\doxysubsubsection{\texorpdfstring{calculate\_scale()}{calculate\_scale()}}
{\footnotesize\ttfamily \label{namespacelstm__test__data__utils_a39a9c01919d9508ee0c23c5c72614815} 
lstm\+\_\+test\+\_\+data\+\_\+utils.\+calculate\+\_\+scale (\begin{DoxyParamCaption}\item[{}]{min\+\_\+val}{, }\item[{}]{max\+\_\+val}{, }\item[{}]{num\+\_\+bits}{ = {\ttfamily 8}, }\item[{}]{symmetry}{ = {\ttfamily False}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Calculate quantization scale from the range and bit width\end{DoxyVerb}
 \Hypertarget{namespacelstm__test__data__utils_a25183b71d2b246f6c094ff358edf8a3a}\index{lstm\_test\_data\_utils@{lstm\_test\_data\_utils}!calculate\_zp@{calculate\_zp}}
\index{calculate\_zp@{calculate\_zp}!lstm\_test\_data\_utils@{lstm\_test\_data\_utils}}
\doxysubsubsection{\texorpdfstring{calculate\_zp()}{calculate\_zp()}}
{\footnotesize\ttfamily \label{namespacelstm__test__data__utils_a25183b71d2b246f6c094ff358edf8a3a} 
lstm\+\_\+test\+\_\+data\+\_\+utils.\+calculate\+\_\+zp (\begin{DoxyParamCaption}\item[{}]{min\+\_\+val}{, }\item[{}]{scale}{, }\item[{}]{num\+\_\+bits}{ = {\ttfamily 8}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Calculate the zero point from the minimal value\end{DoxyVerb}
 \Hypertarget{namespacelstm__test__data__utils_a327410e0daa0da035f8ea5a2890a808a}\index{lstm\_test\_data\_utils@{lstm\_test\_data\_utils}!clip\_range@{clip\_range}}
\index{clip\_range@{clip\_range}!lstm\_test\_data\_utils@{lstm\_test\_data\_utils}}
\doxysubsubsection{\texorpdfstring{clip\_range()}{clip\_range()}}
{\footnotesize\ttfamily \label{namespacelstm__test__data__utils_a327410e0daa0da035f8ea5a2890a808a} 
lstm\+\_\+test\+\_\+data\+\_\+utils.\+clip\+\_\+range (\begin{DoxyParamCaption}\item[{}]{vals}{, }\item[{}]{bit\+\_\+width}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Mimic integer calculation.
Clip the range of vals based on bit width.
e.g., clip_range([300], 8) = [127] since int8 have range [-128, 127]
Args:
    vals (np.array): float representation of the integer values
    bit_width (int): number of desired bits for vals
Returns:
    np.array : clipped vals
\end{DoxyVerb}
 \Hypertarget{namespacelstm__test__data__utils_a25df5d07fd2a5825645437db7104fabc}\index{lstm\_test\_data\_utils@{lstm\_test\_data\_utils}!create\_gate\_params@{create\_gate\_params}}
\index{create\_gate\_params@{create\_gate\_params}!lstm\_test\_data\_utils@{lstm\_test\_data\_utils}}
\doxysubsubsection{\texorpdfstring{create\_gate\_params()}{create\_gate\_params()}}
{\footnotesize\ttfamily \label{namespacelstm__test__data__utils_a25df5d07fd2a5825645437db7104fabc} 
lstm\+\_\+test\+\_\+data\+\_\+utils.\+create\+\_\+gate\+\_\+params (\begin{DoxyParamCaption}\item[{}]{gate\+\_\+parameters}{, }\item[{}]{model\+\_\+config}{, }\item[{}]{modulation}{ = {\ttfamily False}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Create a QuantizedGateParams using the gate paramater information and the model configuration\end{DoxyVerb}
 \Hypertarget{namespacelstm__test__data__utils_a3eb7d7e300844d06151ee2b2e3361f73}\index{lstm\_test\_data\_utils@{lstm\_test\_data\_utils}!dequantize\_data@{dequantize\_data}}
\index{dequantize\_data@{dequantize\_data}!lstm\_test\_data\_utils@{lstm\_test\_data\_utils}}
\doxysubsubsection{\texorpdfstring{dequantize\_data()}{dequantize\_data()}}
{\footnotesize\ttfamily \label{namespacelstm__test__data__utils_a3eb7d7e300844d06151ee2b2e3361f73} 
lstm\+\_\+test\+\_\+data\+\_\+utils.\+dequantize\+\_\+data (\begin{DoxyParamCaption}\item[{}]{quantized\+\_\+data}{, }\item[{}]{scale}{, }\item[{}]{zero\+\_\+point}{ = {\ttfamily 0}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Dequantize the data to integer type with desired bit width.
Args:
    quantized_data (np.array): quantized data
    scale (float): quantization scale of the data
    zero_point (integer): quantization zero point of the data
Returns:
    np.array : dequantized data
\end{DoxyVerb}
 \Hypertarget{namespacelstm__test__data__utils_ac6cb9277bd104fd458d547c47cb22bda}\index{lstm\_test\_data\_utils@{lstm\_test\_data\_utils}!gate\_calculation@{gate\_calculation}}
\index{gate\_calculation@{gate\_calculation}!lstm\_test\_data\_utils@{lstm\_test\_data\_utils}}
\doxysubsubsection{\texorpdfstring{gate\_calculation()}{gate\_calculation()}}
{\footnotesize\ttfamily \label{namespacelstm__test__data__utils_ac6cb9277bd104fd458d547c47cb22bda} 
lstm\+\_\+test\+\_\+data\+\_\+utils.\+gate\+\_\+calculation (\begin{DoxyParamCaption}\item[{}]{input}{, }\item[{}]{hidden\+\_\+state}{, }\item[{}]{gate\+\_\+params}{, }\item[{}]{debug}{ = {\ttfamily False}}\end{DoxyParamCaption})}

\begin{DoxyVerb}A gate calculation is tanh(FC(activation, activation weight) + FC(recurrent, recurrent weight)). 
For modulation gate, sigmoid is used instead of tanh.

Note: for debugging purpose, floating point calculation is conducted in parallel with the integer calculation
\end{DoxyVerb}
 \Hypertarget{namespacelstm__test__data__utils_a7cf8b8670a8bbaac9fb1940e8782e694}\index{lstm\_test\_data\_utils@{lstm\_test\_data\_utils}!quantize\_data@{quantize\_data}}
\index{quantize\_data@{quantize\_data}!lstm\_test\_data\_utils@{lstm\_test\_data\_utils}}
\doxysubsubsection{\texorpdfstring{quantize\_data()}{quantize\_data()}}
{\footnotesize\ttfamily \label{namespacelstm__test__data__utils_a7cf8b8670a8bbaac9fb1940e8782e694} 
lstm\+\_\+test\+\_\+data\+\_\+utils.\+quantize\+\_\+data (\begin{DoxyParamCaption}\item[{}]{data}{, }\item[{}]{scale}{, }\item[{}]{zero\+\_\+point}{ = {\ttfamily 0}, }\item[{}]{bit\+\_\+width}{ = {\ttfamily 8}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Quantize the data to integer type with desired bit width.
The quantized data is represented using float since integer calculation in
numpy may differ from other implementations (e.g., no integer saturation
protection in numpy)
Args:
    data (np.array): float data
    scale (float): quantization scale of the data
    zero_point (integer): quantization zero point of the data
    bit_width (int): number of representative bits for vals
Returns:
    np.array : quantized data in float but clipped range
\end{DoxyVerb}
 \Hypertarget{namespacelstm__test__data__utils_a9f75e3ef5e81fc5426200ee40b5d7cc2}\index{lstm\_test\_data\_utils@{lstm\_test\_data\_utils}!quantized\_sigmoid@{quantized\_sigmoid}}
\index{quantized\_sigmoid@{quantized\_sigmoid}!lstm\_test\_data\_utils@{lstm\_test\_data\_utils}}
\doxysubsubsection{\texorpdfstring{quantized\_sigmoid()}{quantized\_sigmoid()}}
{\footnotesize\ttfamily \label{namespacelstm__test__data__utils_a9f75e3ef5e81fc5426200ee40b5d7cc2} 
lstm\+\_\+test\+\_\+data\+\_\+utils.\+quantized\+\_\+sigmoid (\begin{DoxyParamCaption}\item[{}]{input}{, }\item[{}]{input\+\_\+scale}{, }\item[{}]{output\+\_\+scale}{, }\item[{}]{num\+\_\+bits}{ = {\ttfamily 16}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Sigmoid (interger)\end{DoxyVerb}
 \Hypertarget{namespacelstm__test__data__utils_a0b66b84f63642eb3e13a16135efadc5d}\index{lstm\_test\_data\_utils@{lstm\_test\_data\_utils}!quantized\_tanh@{quantized\_tanh}}
\index{quantized\_tanh@{quantized\_tanh}!lstm\_test\_data\_utils@{lstm\_test\_data\_utils}}
\doxysubsubsection{\texorpdfstring{quantized\_tanh()}{quantized\_tanh()}}
{\footnotesize\ttfamily \label{namespacelstm__test__data__utils_a0b66b84f63642eb3e13a16135efadc5d} 
lstm\+\_\+test\+\_\+data\+\_\+utils.\+quantized\+\_\+tanh (\begin{DoxyParamCaption}\item[{}]{input}{, }\item[{}]{input\+\_\+scale}{, }\item[{}]{output\+\_\+scale}{, }\item[{}]{num\+\_\+bits}{ = {\ttfamily 16}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Tanh (interger)\end{DoxyVerb}
 \Hypertarget{namespacelstm__test__data__utils_a4d4251bdb6ad5b553bdcaaebe552bdc1}\index{lstm\_test\_data\_utils@{lstm\_test\_data\_utils}!rescale@{rescale}}
\index{rescale@{rescale}!lstm\_test\_data\_utils@{lstm\_test\_data\_utils}}
\doxysubsubsection{\texorpdfstring{rescale()}{rescale()}}
{\footnotesize\ttfamily \label{namespacelstm__test__data__utils_a4d4251bdb6ad5b553bdcaaebe552bdc1} 
lstm\+\_\+test\+\_\+data\+\_\+utils.\+rescale (\begin{DoxyParamCaption}\item[{}]{data}{, }\item[{}]{effective\+\_\+scale}{, }\item[{}]{zero\+\_\+point}{, }\item[{}]{num\+\_\+bits}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Rescale the data to the effective scale \end{DoxyVerb}
 \Hypertarget{namespacelstm__test__data__utils_ad681f4ef7a02f011b2795851b7715d1e}\index{lstm\_test\_data\_utils@{lstm\_test\_data\_utils}!sigmoid@{sigmoid}}
\index{sigmoid@{sigmoid}!lstm\_test\_data\_utils@{lstm\_test\_data\_utils}}
\doxysubsubsection{\texorpdfstring{sigmoid()}{sigmoid()}}
{\footnotesize\ttfamily \label{namespacelstm__test__data__utils_ad681f4ef7a02f011b2795851b7715d1e} 
lstm\+\_\+test\+\_\+data\+\_\+utils.\+sigmoid (\begin{DoxyParamCaption}\item[{}]{x}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Sigmoid (floating point)\end{DoxyVerb}
 