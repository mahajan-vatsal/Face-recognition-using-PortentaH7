\doxysection{Face\+\_\+\+Access\+\_\+inferencing/examples/esp32/esp32\+\_\+microphone/esp32\+\_\+microphone.ino File Reference}
\hypertarget{esp32__microphone_8ino}{}\label{esp32__microphone_8ino}\index{Face\_Access\_inferencing/examples/esp32/esp32\_microphone/esp32\_microphone.ino@{Face\_Access\_inferencing/examples/esp32/esp32\_microphone/esp32\_microphone.ino}}
{\ttfamily \#include $<$Face\+\_\+\+Access\+\_\+inferencing.\+h$>$}\newline
{\ttfamily \#include "{}freertos/\+Free\+RTOS.\+h"{}}\newline
{\ttfamily \#include "{}freertos/task.\+h"{}}\newline
{\ttfamily \#include "{}driver/i2s.\+h"{}}\newline
Include dependency graph for esp32\+\_\+microphone.\+ino\+:
% FIG 0
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structinference__t}{inference\+\_\+t}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{esp32__microphone_8ino_a84f0987db19e2d3300d7c63929613f66}{EIDSP\+\_\+\+QUANTIZE\+\_\+\+FILTERBANK}}~0
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{esp32__microphone_8ino_a4fc01d736fe50cf5b977f755b675f11d}{setup}} ()
\begin{DoxyCompactList}\small\item\em Arduino setup function. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{esp32__microphone_8ino_afe461d27b9c48d5921c00d521181f12f}{loop}} ()
\begin{DoxyCompactList}\small\item\em Arduino main function. Runs the inferencing loop. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{esp32__microphone_8ino_af45313a921f8382da57d2b2b1e84e1b9}{audio\+\_\+inference\+\_\+callback}} (uint32\+\_\+t n\+\_\+bytes)
\item 
static void \mbox{\hyperlink{esp32__microphone_8ino_a018cec004d1a1b255c6d87cec9459ffd}{capture\+\_\+samples}} (void \texorpdfstring{$\ast$}{*}arg)
\item 
static bool \mbox{\hyperlink{esp32__microphone_8ino_ab74ee7e3943fe5e0eb9f6c0c2ca18c45}{microphone\+\_\+inference\+\_\+start}} (uint32\+\_\+t n\+\_\+samples)
\begin{DoxyCompactList}\small\item\em Init inferencing struct and setup/start PDM. \end{DoxyCompactList}\item 
static bool \mbox{\hyperlink{esp32__microphone_8ino_ac3b50445cd9fdfc75ac49692ab0f910c}{microphone\+\_\+inference\+\_\+record}} (void)
\begin{DoxyCompactList}\small\item\em Wait on new data. \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{esp32__microphone_8ino_a3f715c2399692f3c7368ecda003c8fe0}{microphone\+\_\+audio\+\_\+signal\+\_\+get\+\_\+data}} (size\+\_\+t \mbox{\hyperlink{_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcaf138809236f667e9686fdd4aaf17705_aed7ea92f45bd273dde380a45ddced592}{offset}}, size\+\_\+t length, float \texorpdfstring{$\ast$}{*}out\+\_\+ptr)
\item 
static void \mbox{\hyperlink{esp32__microphone_8ino_af8bdb6be12449c8fa46f6fcc91847087}{microphone\+\_\+inference\+\_\+end}} (void)
\begin{DoxyCompactList}\small\item\em Stop PDM and release buffers. \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{esp32__microphone_8ino_a1ea951d3801a0ce6883f2ba18bb4672b}{i2s\+\_\+init}} (uint32\+\_\+t sampling\+\_\+rate)
\item 
static int \mbox{\hyperlink{esp32__microphone_8ino_a10d2e443928dc00572606a1f93f5edb6}{i2s\+\_\+deinit}} (void)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{structinference__t}{inference\+\_\+t}} \mbox{\hyperlink{esp32__microphone_8ino_a5fe36ec121fc3857a29308445d1c863c}{inference}}
\item 
static const uint32\+\_\+t \mbox{\hyperlink{esp32__microphone_8ino_a3ee836e9696e977a8f80e3f22abd6065}{sample\+\_\+buffer\+\_\+size}} = 2048
\item 
static signed short \mbox{\hyperlink{esp32__microphone_8ino_a6d876f0aebde1d3e088a0fc018527436}{sample\+Buffer}} \mbox{[}\mbox{\hyperlink{esp32__microphone_8ino_a3ee836e9696e977a8f80e3f22abd6065}{sample\+\_\+buffer\+\_\+size}}\mbox{]}
\item 
static bool \mbox{\hyperlink{esp32__microphone_8ino_ac810bc03820882580f7d2a2589678973}{debug\+\_\+nn}} = false
\item 
static bool \mbox{\hyperlink{esp32__microphone_8ino_a72d211873e188434a26aa70f5a92a3c3}{record\+\_\+status}} = \mbox{\hyperlink{ei__fill__result__struct_8h_a930920b2bc42824a5c03be681830f4b2}{true}}
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\Hypertarget{esp32__microphone_8ino_a84f0987db19e2d3300d7c63929613f66}\index{esp32\_microphone.ino@{esp32\_microphone.ino}!EIDSP\_QUANTIZE\_FILTERBANK@{EIDSP\_QUANTIZE\_FILTERBANK}}
\index{EIDSP\_QUANTIZE\_FILTERBANK@{EIDSP\_QUANTIZE\_FILTERBANK}!esp32\_microphone.ino@{esp32\_microphone.ino}}
\doxysubsubsection{\texorpdfstring{EIDSP\_QUANTIZE\_FILTERBANK}{EIDSP\_QUANTIZE\_FILTERBANK}}
{\footnotesize\ttfamily \label{esp32__microphone_8ino_a84f0987db19e2d3300d7c63929613f66} 
\#define EIDSP\+\_\+\+QUANTIZE\+\_\+\+FILTERBANK~0}



\doxysubsection{Function Documentation}
\Hypertarget{esp32__microphone_8ino_af45313a921f8382da57d2b2b1e84e1b9}\index{esp32\_microphone.ino@{esp32\_microphone.ino}!audio\_inference\_callback@{audio\_inference\_callback}}
\index{audio\_inference\_callback@{audio\_inference\_callback}!esp32\_microphone.ino@{esp32\_microphone.ino}}
\doxysubsubsection{\texorpdfstring{audio\_inference\_callback()}{audio\_inference\_callback()}}
{\footnotesize\ttfamily \label{esp32__microphone_8ino_af45313a921f8382da57d2b2b1e84e1b9} 
static void audio\+\_\+inference\+\_\+callback (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{n\+\_\+bytes}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\Hypertarget{esp32__microphone_8ino_a018cec004d1a1b255c6d87cec9459ffd}\index{esp32\_microphone.ino@{esp32\_microphone.ino}!capture\_samples@{capture\_samples}}
\index{capture\_samples@{capture\_samples}!esp32\_microphone.ino@{esp32\_microphone.ino}}
\doxysubsubsection{\texorpdfstring{capture\_samples()}{capture\_samples()}}
{\footnotesize\ttfamily \label{esp32__microphone_8ino_a018cec004d1a1b255c6d87cec9459ffd} 
static void capture\+\_\+samples (\begin{DoxyParamCaption}\item[{void \texorpdfstring{$\ast$}{*}}]{arg}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\Hypertarget{esp32__microphone_8ino_a10d2e443928dc00572606a1f93f5edb6}\index{esp32\_microphone.ino@{esp32\_microphone.ino}!i2s\_deinit@{i2s\_deinit}}
\index{i2s\_deinit@{i2s\_deinit}!esp32\_microphone.ino@{esp32\_microphone.ino}}
\doxysubsubsection{\texorpdfstring{i2s\_deinit()}{i2s\_deinit()}}
{\footnotesize\ttfamily \label{esp32__microphone_8ino_a10d2e443928dc00572606a1f93f5edb6} 
static int i2s\+\_\+deinit (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\Hypertarget{esp32__microphone_8ino_a1ea951d3801a0ce6883f2ba18bb4672b}\index{esp32\_microphone.ino@{esp32\_microphone.ino}!i2s\_init@{i2s\_init}}
\index{i2s\_init@{i2s\_init}!esp32\_microphone.ino@{esp32\_microphone.ino}}
\doxysubsubsection{\texorpdfstring{i2s\_init()}{i2s\_init()}}
{\footnotesize\ttfamily \label{esp32__microphone_8ino_a1ea951d3801a0ce6883f2ba18bb4672b} 
static int i2s\+\_\+init (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{sampling\+\_\+rate}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\Hypertarget{esp32__microphone_8ino_afe461d27b9c48d5921c00d521181f12f}\index{esp32\_microphone.ino@{esp32\_microphone.ino}!loop@{loop}}
\index{loop@{loop}!esp32\_microphone.ino@{esp32\_microphone.ino}}
\doxysubsubsection{\texorpdfstring{loop()}{loop()}}
{\footnotesize\ttfamily \label{esp32__microphone_8ino_afe461d27b9c48d5921c00d521181f12f} 
void loop (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}



Arduino main function. Runs the inferencing loop. 

Get data and run inferencing. \Hypertarget{esp32__microphone_8ino_a3f715c2399692f3c7368ecda003c8fe0}\index{esp32\_microphone.ino@{esp32\_microphone.ino}!microphone\_audio\_signal\_get\_data@{microphone\_audio\_signal\_get\_data}}
\index{microphone\_audio\_signal\_get\_data@{microphone\_audio\_signal\_get\_data}!esp32\_microphone.ino@{esp32\_microphone.ino}}
\doxysubsubsection{\texorpdfstring{microphone\_audio\_signal\_get\_data()}{microphone\_audio\_signal\_get\_data()}}
{\footnotesize\ttfamily \label{esp32__microphone_8ino_a3f715c2399692f3c7368ecda003c8fe0} 
static int microphone\+\_\+audio\+\_\+signal\+\_\+get\+\_\+data (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{offset}{, }\item[{size\+\_\+t}]{length}{, }\item[{float \texorpdfstring{$\ast$}{*}}]{out\+\_\+ptr}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Get raw audio signal data \Hypertarget{esp32__microphone_8ino_af8bdb6be12449c8fa46f6fcc91847087}\index{esp32\_microphone.ino@{esp32\_microphone.ino}!microphone\_inference\_end@{microphone\_inference\_end}}
\index{microphone\_inference\_end@{microphone\_inference\_end}!esp32\_microphone.ino@{esp32\_microphone.ino}}
\doxysubsubsection{\texorpdfstring{microphone\_inference\_end()}{microphone\_inference\_end()}}
{\footnotesize\ttfamily \label{esp32__microphone_8ino_af8bdb6be12449c8fa46f6fcc91847087} 
static void microphone\+\_\+inference\+\_\+end (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Stop PDM and release buffers. 

\Hypertarget{esp32__microphone_8ino_ac3b50445cd9fdfc75ac49692ab0f910c}\index{esp32\_microphone.ino@{esp32\_microphone.ino}!microphone\_inference\_record@{microphone\_inference\_record}}
\index{microphone\_inference\_record@{microphone\_inference\_record}!esp32\_microphone.ino@{esp32\_microphone.ino}}
\doxysubsubsection{\texorpdfstring{microphone\_inference\_record()}{microphone\_inference\_record()}}
{\footnotesize\ttfamily \label{esp32__microphone_8ino_ac3b50445cd9fdfc75ac49692ab0f910c} 
static bool microphone\+\_\+inference\+\_\+record (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Wait on new data. 

\begin{DoxyReturn}{Returns}
True when finished 
\end{DoxyReturn}
\Hypertarget{esp32__microphone_8ino_ab74ee7e3943fe5e0eb9f6c0c2ca18c45}\index{esp32\_microphone.ino@{esp32\_microphone.ino}!microphone\_inference\_start@{microphone\_inference\_start}}
\index{microphone\_inference\_start@{microphone\_inference\_start}!esp32\_microphone.ino@{esp32\_microphone.ino}}
\doxysubsubsection{\texorpdfstring{microphone\_inference\_start()}{microphone\_inference\_start()}}
{\footnotesize\ttfamily \label{esp32__microphone_8ino_ab74ee7e3943fe5e0eb9f6c0c2ca18c45} 
static bool microphone\+\_\+inference\+\_\+start (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{n\+\_\+samples}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Init inferencing struct and setup/start PDM. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em n\+\_\+samples} & The n samples\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\{ description\+\_\+of\+\_\+the\+\_\+return\+\_\+value \} 
\end{DoxyReturn}
\Hypertarget{esp32__microphone_8ino_a4fc01d736fe50cf5b977f755b675f11d}\index{esp32\_microphone.ino@{esp32\_microphone.ino}!setup@{setup}}
\index{setup@{setup}!esp32\_microphone.ino@{esp32\_microphone.ino}}
\doxysubsubsection{\texorpdfstring{setup()}{setup()}}
{\footnotesize\ttfamily \label{esp32__microphone_8ino_a4fc01d736fe50cf5b977f755b675f11d} 
void setup (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}



Arduino setup function. 



\doxysubsection{Variable Documentation}
\Hypertarget{esp32__microphone_8ino_ac810bc03820882580f7d2a2589678973}\index{esp32\_microphone.ino@{esp32\_microphone.ino}!debug\_nn@{debug\_nn}}
\index{debug\_nn@{debug\_nn}!esp32\_microphone.ino@{esp32\_microphone.ino}}
\doxysubsubsection{\texorpdfstring{debug\_nn}{debug\_nn}}
{\footnotesize\ttfamily \label{esp32__microphone_8ino_ac810bc03820882580f7d2a2589678973} 
bool debug\+\_\+nn = false\hspace{0.3cm}{\ttfamily [static]}}

\Hypertarget{esp32__microphone_8ino_a5fe36ec121fc3857a29308445d1c863c}\index{esp32\_microphone.ino@{esp32\_microphone.ino}!inference@{inference}}
\index{inference@{inference}!esp32\_microphone.ino@{esp32\_microphone.ino}}
\doxysubsubsection{\texorpdfstring{inference}{inference}}
{\footnotesize\ttfamily \label{esp32__microphone_8ino_a5fe36ec121fc3857a29308445d1c863c} 
\mbox{\hyperlink{structinference__t}{inference\+\_\+t}} inference\hspace{0.3cm}{\ttfamily [static]}}

\Hypertarget{esp32__microphone_8ino_a72d211873e188434a26aa70f5a92a3c3}\index{esp32\_microphone.ino@{esp32\_microphone.ino}!record\_status@{record\_status}}
\index{record\_status@{record\_status}!esp32\_microphone.ino@{esp32\_microphone.ino}}
\doxysubsubsection{\texorpdfstring{record\_status}{record\_status}}
{\footnotesize\ttfamily \label{esp32__microphone_8ino_a72d211873e188434a26aa70f5a92a3c3} 
bool record\+\_\+status = \mbox{\hyperlink{ei__fill__result__struct_8h_a930920b2bc42824a5c03be681830f4b2}{true}}\hspace{0.3cm}{\ttfamily [static]}}

\Hypertarget{esp32__microphone_8ino_a3ee836e9696e977a8f80e3f22abd6065}\index{esp32\_microphone.ino@{esp32\_microphone.ino}!sample\_buffer\_size@{sample\_buffer\_size}}
\index{sample\_buffer\_size@{sample\_buffer\_size}!esp32\_microphone.ino@{esp32\_microphone.ino}}
\doxysubsubsection{\texorpdfstring{sample\_buffer\_size}{sample\_buffer\_size}}
{\footnotesize\ttfamily \label{esp32__microphone_8ino_a3ee836e9696e977a8f80e3f22abd6065} 
const uint32\+\_\+t sample\+\_\+buffer\+\_\+size = 2048\hspace{0.3cm}{\ttfamily [static]}}

\Hypertarget{esp32__microphone_8ino_a6d876f0aebde1d3e088a0fc018527436}\index{esp32\_microphone.ino@{esp32\_microphone.ino}!sampleBuffer@{sampleBuffer}}
\index{sampleBuffer@{sampleBuffer}!esp32\_microphone.ino@{esp32\_microphone.ino}}
\doxysubsubsection{\texorpdfstring{sampleBuffer}{sampleBuffer}}
{\footnotesize\ttfamily \label{esp32__microphone_8ino_a6d876f0aebde1d3e088a0fc018527436} 
signed short sample\+Buffer\mbox{[}\mbox{\hyperlink{esp32__microphone_8ino_a3ee836e9696e977a8f80e3f22abd6065}{sample\+\_\+buffer\+\_\+size}}\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}

