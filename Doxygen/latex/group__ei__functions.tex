\doxysection{Functions}
\hypertarget{group__ei__functions}{}\label{group__ei__functions}\index{Functions@{Functions}}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{group__ei__functions_ga1f01a5a562ec8528c0b5fe61aa9dacc3}{run\+\_\+classifier\+\_\+init}} (void)
\begin{DoxyCompactList}\small\item\em Initialize static variables for running preprocessing and inference continuously. \end{DoxyCompactList}\item 
\mbox{\hyperlink{group__ei__functions_ga8f5c7143bf386c91e3210280ebc152d6}{\+\_\+\+\_\+attribute\+\_\+\+\_\+}} ((unused)) void display\+\_\+results(\mbox{\hyperlink{classei__impulse__handle__t}{ei\+\_\+impulse\+\_\+handle\+\_\+t}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{ei__run__dsp_8h_a701ab73428c38eac35ba17226b628ffa}{handle}}
\begin{DoxyCompactList}\small\item\em Display the results of the inference. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group__ei__functions_ga6c5d3f11303dbc8ba3a3f72e24c0079d}{run\+\_\+classifier\+\_\+deinit}} (void)
\begin{DoxyCompactList}\small\item\em Deletes static variables when running preprocessing and inference continuously. \end{DoxyCompactList}\item 
\mbox{\hyperlink{group__ei__returntypes_gad9580b47a6cd5e74cfc31a03bdfecebe}{EI\+\_\+\+IMPULSE\+\_\+\+ERROR}} \mbox{\hyperlink{group__ei__functions_gacf3414ec2ec4639e982fc966144a02ec}{run\+\_\+classifier\+\_\+continuous}} (\mbox{\hyperlink{group__ei__structs_gaa11c321d559d65dd1adff6af0edf54e4}{signal\+\_\+t}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classei_1_1signal}{signal}}, \mbox{\hyperlink{structei__impulse__result__t}{ei\+\_\+impulse\+\_\+result\+\_\+t}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{group__ei__functions_gaf4ad914acba713176b1f00a800e781ba}{result}}, bool \mbox{\hyperlink{ei__fill__result__struct_8h_a881f62341b5a41a3c5707268bd537be1}{debug}}=false, bool enable\+\_\+maf\+\_\+unused=\mbox{\hyperlink{ei__fill__result__struct_8h_a930920b2bc42824a5c03be681830f4b2}{true}})
\begin{DoxyCompactList}\small\item\em Run preprocessing (DSP) on new slice of raw features. Add output features to rolling matrix and run inference on full sample. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{group__ei__structs_gaa11c321d559d65dd1adff6af0edf54e4}{signal\+\_\+t}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{group__ei__functions_ga46d130150ef0ce589284705bdc4c8b69}{signal}}
\item 
\mbox{\hyperlink{structei__impulse__result__t}{ei\+\_\+impulse\+\_\+result\+\_\+t}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{group__ei__functions_ga13eb9155f59e00a4ca0bc9aaebd14733}{result}}
\item 
\mbox{\hyperlink{group__ei__structs_gaa11c321d559d65dd1adff6af0edf54e4}{signal\+\_\+t}} \mbox{\hyperlink{structei__impulse__result__t}{ei\+\_\+impulse\+\_\+result\+\_\+t}} bool \mbox{\hyperlink{group__ei__functions_gafdfda4c8506d9909518cc30338fc0646}{debug}} = false
\item 
const \mbox{\hyperlink{structei__learning__block__config__tflite__graph__t}{ei\+\_\+learning\+\_\+block\+\_\+config\+\_\+tflite\+\_\+graph\+\_\+t}} \mbox{\hyperlink{structei__impulse__result__t}{ei\+\_\+impulse\+\_\+result\+\_\+t}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{group__ei__functions_gaf4ad914acba713176b1f00a800e781ba}{result}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Public-\/facing functions for running inference using the Edge Impulse C++ library.

{\bfseries{Source}}\+: \href{https://github.com/edgeimpulse/inferencing-sdk-cpp/blob/master/classifier/ei_run_classifier.h}{\texttt{ classifier/ei\+\_\+run\+\_\+classifier.\+h}}

\doxysubsection{Function Documentation}
\Hypertarget{group__ei__functions_ga8f5c7143bf386c91e3210280ebc152d6}\index{Functions@{Functions}!\_\_attribute\_\_@{\_\_attribute\_\_}}
\index{\_\_attribute\_\_@{\_\_attribute\_\_}!Functions@{Functions}}
\doxysubsubsection{\texorpdfstring{\_\_attribute\_\_()}{\_\_attribute\_\_()}}
{\footnotesize\ttfamily \label{group__ei__functions_ga8f5c7143bf386c91e3210280ebc152d6} 
\+\_\+\+\_\+attribute\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{(unused)}]{}{}\end{DoxyParamCaption})}



Display the results of the inference. 

Run preprocessing (DSP) on new slice of raw features. Add output features to rolling matrix and run inference on full sample.

Initialize static variables for running preprocessing and inference continuously.


\begin{DoxyParams}{Parameters}
{\em result} & The result\\
\hline
\end{DoxyParams}
Check if the current impulse could be used by \textquotesingle{}run\+\_\+classifier\+\_\+image\+\_\+quantized\textquotesingle{}

Initializes and clears any internal static variables needed by {\ttfamily \doxylink{group__ei__functions_gacf3414ec2ec4639e982fc966144a02ec}{run\+\_\+classifier\+\_\+continuous()}}. This includes the moving average filter (MAF). This function should be called prior to calling {\ttfamily \doxylink{group__ei__functions_gacf3414ec2ec4639e982fc966144a02ec}{run\+\_\+classifier\+\_\+continuous()}}.

{\bfseries{Blocking}}\+: yes

{\bfseries{Example}}\+: \href{https://github.com/edgeimpulse/example-lacuna-ls200/blob/main/nano_ble33_sense_microphone_continous/nano_ble33_sense_microphone_continuous.ino}{\texttt{ nano\+\_\+ble33\+\_\+sense\+\_\+microphone\+\_\+continuous.\+ino}}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em handle} & struct with information about model and DSP\\
\hline
\end{DoxyParams}
Accepts a new slice of features give by the callback defined in the {\ttfamily signal} parameter. It performs preprocessing (DSP) on this new slice of features and appends the output to a sliding window of pre-\/processed features (stored in a static features matrix). The matrix stores the new slice and as many old slices as necessary to make up one full sample for performing inference.

{\ttfamily \doxylink{group__ei__functions_ga1f01a5a562ec8528c0b5fe61aa9dacc3}{run\+\_\+classifier\+\_\+init()}} must be called before making any calls to {\ttfamily \doxylink{group__ei__functions_gacf3414ec2ec4639e982fc966144a02ec}{run\+\_\+classifier\+\_\+continuous()}.}

For example, if you are doing keyword spotting on 1-\/second slices of audio and you want to perform inference 4 times per second (given by {\ttfamily EI\+\_\+\+CLASSIFIER\+\_\+\+SLICES\+\_\+\+PER\+\_\+\+MODEL\+\_\+\+WINDOW}), you would collect 0.\+25 seconds of audio and call \doxylink{group__ei__functions_gacf3414ec2ec4639e982fc966144a02ec}{run\+\_\+classifier\+\_\+continuous()}. The function would compute the Mel-\/\+Frequency Cepstral Coefficients (MFCCs) for that 0.\+25 second slice of audio, drop the oldest 0.\+25 seconds\textquotesingle{} worth of MFCCs from its internal matrix, and append the newest slice of MFCCs. This process allows the library to keep track of the pre-\/processed features (e.\+g. MFCCs) in the window instead of the entire set of raw features (e.\+g. raw audio data), which can potentially save a lot of space in RAM. After updating the static matrix, inference is performed using the whole matrix, which acts as a sliding window of pre-\/processed features.

Additionally, a moving average filter (MAF) can be enabled for {\ttfamily \doxylink{group__ei__functions_gacf3414ec2ec4639e982fc966144a02ec}{run\+\_\+classifier\+\_\+continuous()}}, which averages (arithmetic mean) the last {\itshape n} inference results for each class. {\itshape n} is {\ttfamily EI\+\_\+\+CLASSIFIER\+\_\+\+SLICES\+\_\+\+PER\+\_\+\+MODEL\+\_\+\+WINDOW / 2}. In our example above, if we enabled the MAF, the values in {\ttfamily result} would contain predictions averaged from the previous 2 inferences.

To learn more about {\ttfamily \doxylink{group__ei__functions_gacf3414ec2ec4639e982fc966144a02ec}{run\+\_\+classifier\+\_\+continuous()}}, see \href{https://docs.edgeimpulse.com/docs/tutorials/advanced-inferencing/continuous-audio-sampling}{\texttt{ this guide}} on continuous audio sampling. While the guide is written for audio signals, the concepts of continuous sampling and inference can be extrapolated to any time-\/series data.

{\bfseries{Blocking}}\+: yes

{\bfseries{Example}}\+: \href{https://github.com/edgeimpulse/example-lacuna-ls200/blob/main/nano_ble33_sense_microphone_continous/nano_ble33_sense_microphone_continuous.ino}{\texttt{ nano\+\_\+ble33\+\_\+sense\+\_\+microphone\+\_\+continuous.\+ino}}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em impulse} & {\ttfamily \doxylink{classei__impulse__handle__t}{ei\+\_\+impulse\+\_\+handle\+\_\+t}} struct with information about preprocessing and model. \\
\hline
\mbox{\texttt{ in}}  & {\em signal} & Pointer to a signal\+\_\+t struct that contains the number of elements in the slice of raw features (e.\+g. {\ttfamily EI\+\_\+\+CLASSIFIER\+\_\+\+SLICE\+\_\+\+SIZE}) and a pointer to a callback that reads in the slice of raw features. \\
\hline
\mbox{\texttt{ out}}  & {\em result} & Pointer to an {\ttfamily \doxylink{structei__impulse__result__t}{ei\+\_\+impulse\+\_\+result\+\_\+t}} struct that contains the various output results from inference after run\+\_\+classifier() returns. \\
\hline
\mbox{\texttt{ in}}  & {\em debug} & Print internal preprocessing and inference debugging information via {\ttfamily \doxylink{ei__run__classifier_8h_adda641ea28ba092cca93ceb401fe0807}{ei\+\_\+printf()}}. \\
\hline
\mbox{\texttt{ in}}  & {\em enable\+\_\+maf\+\_\+unused} & Enable the moving average filter (MAF) for the classifier -\/ deprecated, replaced with Performance Calibration\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code as defined by {\ttfamily EI\+\_\+\+IMPULSE\+\_\+\+ERROR} enum. Will be {\ttfamily EI\+\_\+\+IMPULSE\+\_\+\+OK} if inference completed successfully. 
\end{DoxyReturn}
\Hypertarget{group__ei__functions_gacf3414ec2ec4639e982fc966144a02ec}\index{Functions@{Functions}!run\_classifier\_continuous@{run\_classifier\_continuous}}
\index{run\_classifier\_continuous@{run\_classifier\_continuous}!Functions@{Functions}}
\doxysubsubsection{\texorpdfstring{run\_classifier\_continuous()}{run\_classifier\_continuous()}}
{\footnotesize\ttfamily \label{group__ei__functions_gacf3414ec2ec4639e982fc966144a02ec} 
\mbox{\hyperlink{group__ei__returntypes_gad9580b47a6cd5e74cfc31a03bdfecebe}{EI\+\_\+\+IMPULSE\+\_\+\+ERROR}} run\+\_\+classifier\+\_\+continuous (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{group__ei__structs_gaa11c321d559d65dd1adff6af0edf54e4}{signal\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{signal}{, }\item[{\mbox{\hyperlink{structei__impulse__result__t}{ei\+\_\+impulse\+\_\+result\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{result}{, }\item[{bool}]{debug}{ = {\ttfamily false}, }\item[{bool}]{enable\+\_\+maf\+\_\+unused}{ = {\ttfamily \mbox{\hyperlink{ei__fill__result__struct_8h_a930920b2bc42824a5c03be681830f4b2}{true}}}}\end{DoxyParamCaption})}



Run preprocessing (DSP) on new slice of raw features. Add output features to rolling matrix and run inference on full sample. 

Accepts a new slice of features give by the callback defined in the {\ttfamily signal} parameter. It performs preprocessing (DSP) on this new slice of features and appends the output to a sliding window of pre-\/processed features (stored in a static features matrix). The matrix stores the new slice and as many old slices as necessary to make up one full sample for performing inference.

{\ttfamily \doxylink{group__ei__functions_ga1f01a5a562ec8528c0b5fe61aa9dacc3}{run\+\_\+classifier\+\_\+init()}} must be called before making any calls to {\ttfamily \doxylink{group__ei__functions_gacf3414ec2ec4639e982fc966144a02ec}{run\+\_\+classifier\+\_\+continuous()}.}

For example, if you are doing keyword spotting on 1-\/second slices of audio and you want to perform inference 4 times per second (given by {\ttfamily EI\+\_\+\+CLASSIFIER\+\_\+\+SLICES\+\_\+\+PER\+\_\+\+MODEL\+\_\+\+WINDOW}), you would collect 0.\+25 seconds of audio and call \doxylink{group__ei__functions_gacf3414ec2ec4639e982fc966144a02ec}{run\+\_\+classifier\+\_\+continuous()}. The function would compute the Mel-\/\+Frequency Cepstral Coefficients (MFCCs) for that 0.\+25 second slice of audio, drop the oldest 0.\+25 seconds\textquotesingle{} worth of MFCCs from its internal matrix, and append the newest slice of MFCCs. This process allows the library to keep track of the pre-\/processed features (e.\+g. MFCCs) in the window instead of the entire set of raw features (e.\+g. raw audio data), which can potentially save a lot of space in RAM. After updating the static matrix, inference is performed using the whole matrix, which acts as a sliding window of pre-\/processed features.

Additionally, a moving average filter (MAF) can be enabled for {\ttfamily \doxylink{group__ei__functions_gacf3414ec2ec4639e982fc966144a02ec}{run\+\_\+classifier\+\_\+continuous()}}, which averages (arithmetic mean) the last {\itshape n} inference results for each class. {\itshape n} is {\ttfamily EI\+\_\+\+CLASSIFIER\+\_\+\+SLICES\+\_\+\+PER\+\_\+\+MODEL\+\_\+\+WINDOW / 2}. In our example above, if we enabled the MAF, the values in {\ttfamily result} would contain predictions averaged from the previous 2 inferences.

To learn more about {\ttfamily \doxylink{group__ei__functions_gacf3414ec2ec4639e982fc966144a02ec}{run\+\_\+classifier\+\_\+continuous()}}, see \href{https://docs.edgeimpulse.com/docs/tutorials/advanced-inferencing/continuous-audio-sampling}{\texttt{ this guide}} on continuous audio sampling. While the guide is written for audio signals, the concepts of continuous sampling and inference can be extrapolated to any time-\/series data.

{\bfseries{Blocking}}\+: yes

{\bfseries{Example}}\+: \href{https://github.com/edgeimpulse/example-lacuna-ls200/blob/main/nano_ble33_sense_microphone_continous/nano_ble33_sense_microphone_continuous.ino}{\texttt{ nano\+\_\+ble33\+\_\+sense\+\_\+microphone\+\_\+continuous.\+ino}}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em signal} & Pointer to a signal\+\_\+t struct that contains the number of elements in the slice of raw features (e.\+g. {\ttfamily EI\+\_\+\+CLASSIFIER\+\_\+\+SLICE\+\_\+\+SIZE}) and a pointer to a callback that reads in the slice of raw features. \\
\hline
\mbox{\texttt{ out}}  & {\em result} & Pointer to an {\ttfamily \doxylink{structei__impulse__result__t}{ei\+\_\+impulse\+\_\+result\+\_\+t}} struct that contains the various output results from inference after run\+\_\+classifier() returns. \\
\hline
\mbox{\texttt{ in}}  & {\em debug} & Print internal preprocessing and inference debugging information via {\ttfamily \doxylink{ei__run__classifier_8h_adda641ea28ba092cca93ceb401fe0807}{ei\+\_\+printf()}}. \\
\hline
\mbox{\texttt{ in}}  & {\em enable\+\_\+maf\+\_\+unused} & Enable the moving average filter (MAF) for the classifier -\/ deprecated, replaced with Performance Calibration\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code as defined by {\ttfamily EI\+\_\+\+IMPULSE\+\_\+\+ERROR} enum. Will be {\ttfamily EI\+\_\+\+IMPULSE\+\_\+\+OK} if inference completed successfully. 
\end{DoxyReturn}
\Hypertarget{group__ei__functions_ga6c5d3f11303dbc8ba3a3f72e24c0079d}\index{Functions@{Functions}!run\_classifier\_deinit@{run\_classifier\_deinit}}
\index{run\_classifier\_deinit@{run\_classifier\_deinit}!Functions@{Functions}}
\doxysubsubsection{\texorpdfstring{run\_classifier\_deinit()}{run\_classifier\_deinit()}}
{\footnotesize\ttfamily \label{group__ei__functions_ga6c5d3f11303dbc8ba3a3f72e24c0079d} 
void run\+\_\+classifier\+\_\+deinit (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}



Deletes static variables when running preprocessing and inference continuously. 

Deletes internal static variables used by {\ttfamily \doxylink{group__ei__functions_gacf3414ec2ec4639e982fc966144a02ec}{run\+\_\+classifier\+\_\+continuous()}}, which includes the moving average filter (MAF). This function should be called when you are done running continuous classification.

{\bfseries{Blocking}}\+: yes

{\bfseries{Example}}\+: \href{https://github.com/edgeimpulse/firmware-nordic-thingy53/blob/main/src/inference/ei_run_audio_impulse.cpp}{\texttt{ ei\+\_\+run\+\_\+audio\+\_\+impulse.\+cpp}} \Hypertarget{group__ei__functions_ga1f01a5a562ec8528c0b5fe61aa9dacc3}\index{Functions@{Functions}!run\_classifier\_init@{run\_classifier\_init}}
\index{run\_classifier\_init@{run\_classifier\_init}!Functions@{Functions}}
\doxysubsubsection{\texorpdfstring{run\_classifier\_init()}{run\_classifier\_init()}}
{\footnotesize\ttfamily \label{group__ei__functions_ga1f01a5a562ec8528c0b5fe61aa9dacc3} 
void run\+\_\+classifier\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}



Initialize static variables for running preprocessing and inference continuously. 

Initializes and clears any internal static variables needed by {\ttfamily \doxylink{group__ei__functions_gacf3414ec2ec4639e982fc966144a02ec}{run\+\_\+classifier\+\_\+continuous()}}. This includes the moving average filter (MAF). This function should be called prior to calling {\ttfamily \doxylink{group__ei__functions_gacf3414ec2ec4639e982fc966144a02ec}{run\+\_\+classifier\+\_\+continuous()}}.

{\bfseries{Blocking}}\+: yes

{\bfseries{Example}}\+: \href{https://github.com/edgeimpulse/example-lacuna-ls200/blob/main/nano_ble33_sense_microphone_continous/nano_ble33_sense_microphone_continuous.ino}{\texttt{ nano\+\_\+ble33\+\_\+sense\+\_\+microphone\+\_\+continuous.\+ino}} 

\doxysubsection{Variable Documentation}
\Hypertarget{group__ei__functions_gafdfda4c8506d9909518cc30338fc0646}\index{Functions@{Functions}!debug@{debug}}
\index{debug@{debug}!Functions@{Functions}}
\doxysubsubsection{\texorpdfstring{debug}{debug}}
{\footnotesize\ttfamily \label{group__ei__functions_gafdfda4c8506d9909518cc30338fc0646} 
\mbox{\hyperlink{group__ei__structs_gaa11c321d559d65dd1adff6af0edf54e4}{signal\+\_\+t}} \mbox{\hyperlink{structei__impulse__result__t}{ei\+\_\+impulse\+\_\+result\+\_\+t}} bool debug = false}

\Hypertarget{group__ei__functions_gaf4ad914acba713176b1f00a800e781ba}\index{Functions@{Functions}!result@{result}}
\index{result@{result}!Functions@{Functions}}
\doxysubsubsection{\texorpdfstring{result}{result}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \label{group__ei__functions_gaf4ad914acba713176b1f00a800e781ba} 
\mbox{\hyperlink{group__ei__structs_gaa11c321d559d65dd1adff6af0edf54e4}{signal\+\_\+t}} \mbox{\hyperlink{structei__impulse__result__t}{ei\+\_\+impulse\+\_\+result\+\_\+t}} \texorpdfstring{$\ast$}{*} result}

\Hypertarget{group__ei__functions_ga13eb9155f59e00a4ca0bc9aaebd14733}\index{Functions@{Functions}!result@{result}}
\index{result@{result}!Functions@{Functions}}
\doxysubsubsection{\texorpdfstring{result}{result}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \label{group__ei__functions_ga13eb9155f59e00a4ca0bc9aaebd14733} 
\mbox{\hyperlink{group__ei__structs_gaa11c321d559d65dd1adff6af0edf54e4}{signal\+\_\+t}} \mbox{\hyperlink{structei__impulse__result__t}{ei\+\_\+impulse\+\_\+result\+\_\+t}}\texorpdfstring{$\ast$}{*} result}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ }
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{ei__run__classifier_8h_adda641ea28ba092cca93ceb401fe0807}{ei\_printf}}(\textcolor{stringliteral}{"{}Predictions\ (DSP:\ "{}})}

\end{DoxyCode}
\Hypertarget{group__ei__functions_ga46d130150ef0ce589284705bdc4c8b69}\index{Functions@{Functions}!signal@{signal}}
\index{signal@{signal}!Functions@{Functions}}
\doxysubsubsection{\texorpdfstring{signal}{signal}}
{\footnotesize\ttfamily \label{group__ei__functions_ga46d130150ef0ce589284705bdc4c8b69} 
\mbox{\hyperlink{group__ei__structs_gaa11c321d559d65dd1adff6af0edf54e4}{signal\+\_\+t}}\texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classei_1_1signal}{signal}}}

