<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Machine Vision using Portenta H7: EmbARC MLI Library Based Optimizations of TensorFlow Lite Micro Kernels for ARC Platforms.</title>
<link rel="icon" href="logo.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Machine Vision using Portenta H7<span id="projectnumber">&#160;2</span>
   </div>
   <div id="projectbrief">This project aims to develop a face recognition-based access control system using the Arduino Portenta H7 and Vision Shield, leveraging Edge Impulse for machine learning. The system captures facial images, processes them locally using an AI model deployed on the Portenta H7 and determines access based on authorised personnel.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">EmbARC MLI Library Based Optimizations of TensorFlow Lite Micro Kernels for ARC Platforms.</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md319"></a></p>
<h1><a class="anchor" id="autotoc_md320"></a>
Maintainers</h1>
<ul>
<li><a href="https://github.com/dzakhar">dzakhar</a></li>
<li><a href="https://github.com/JaccovG">JaccovG</a></li>
<li><a href="https://github.com/gerbauz">gerbauz</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md321"></a>
Introduction</h1>
<p>This folder contains kernel implementations which use optimized <a href="https://github.com/foss-for-synopsys-dwc-arc-processors/embarc_mli">embARC MLI Library</a>. It allows acceleration of inference operations which use int8 (asymmetric quantization).</p>
<h1><a class="anchor" id="autotoc_md322"></a>
Usage</h1>
<p>embARC MLI Library is used to speed up execution of some kernels for asymmetrically quantized layers and can be applied with the option <code>OPTIMIZED_KERNEL_DIR=arc_mli</code>. This means that usual library generation for ARC specific target implies usage of embARC MLI.</p>
<p>For example:</p>
<div class="fragment"><div class="line">make -f tensorflow/lite/micro/tools/make/Makefile clean</div>
<div class="line">make -f tensorflow/lite/micro/tools/make/Makefile TARGET=arc_emsdp \</div>
<div class="line">OPTIMIZED_KERNEL_DIR=arc_mli TARGET_ARCH=arc \</div>
<div class="line">microlite</div>
</div><!-- fragment --><p>In case MLI implementation can’t be used, kernels in this folder fallback to TFLM reference implementations. For applications which may not benefit from MLI library, TF Lite Micro library can be generated without these implementations <b>removing</b> <code>OPTIMIZED_KERNEL_DIR=arc_mli</code> in the command line, which can reduce overall code size:</p>
<div class="fragment"><div class="line">make -f tensorflow/lite/micro/tools/make/Makefile clean</div>
<div class="line">make -f tensorflow/lite/micro/tools/make/Makefile TARGET=arc_emsdp \</div>
<div class="line">TARGET_ARCH=arc \</div>
<div class="line">microlite</div>
</div><!-- fragment --> <hr  />
 <h2><a class="anchor" id="autotoc_md324"></a>
Optional (experimental features):</h2>
<p>TFLM can be built using <a href="https://github.com/foss-for-synopsys-dwc-arc-processors/embarc_mli/tree/Release_2.0_EA">embARC MLI Library 2.0</a> as an experimental feature. To build TFLM using the embARC MLI Library 2.0, add the following tag to the command: </p><div class="fragment"><div class="line">ARC_TAGS=mli20_experimental</div>
</div><!-- fragment --><p> In this case, generated projectes will be in &lt;tcf_file_basename&gt;_mli20_arc_default folder.</p>
<p>Some of configurations may require a custom run-time library specified using the BUILD_LIB_DIR option. Please, check MLI Library 2.0 <a href="https://github.com/foss-for-synopsys-dwc-arc-processors/embarc_mli/tree/Release_2.0_EA#build-configuration-options">documentation</a> for more details. The following option can be added: </p><div class="fragment"><div class="line">BUILD_LIB_DIR=&lt;path_to_buildlib&gt;</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md325"></a>
Limitations</h1>
<p>Currently, the MLI Library provides optimized implementation only for int8 (asymmetric) versions of the following kernels:</p><ol type="1">
<li>Convolution 2D – Per axis quantization only, <code>dilation_ratio==1</code></li>
<li>Depthwise Convolution 2D – Per axis quantization only, <code>dilation_ratio==1</code></li>
<li>Average Pooling</li>
<li>Max Pooling</li>
<li>Fully Connected</li>
</ol>
<h1><a class="anchor" id="autotoc_md326"></a>
Scratch Buffers and Slicing</h1>
<p>The following information applies only for ARC EM SDP, VPX and other targets with XY or VCCM memory. embARC MLI uses specific optimizations which assumes node operands are in XY, VCCM memory and/or DCCM (Data Closely Coupled Memory). As operands might be quite big and may not fit in available XY or VCCM memory, special slicing logic is applied which allows kernel calculations to be split into multiple parts. For this reason, internal static buffers are allocated in these X, Y, VCCM and DCCM memory banks and used to execute sub-calculations.</p>
<p>All this is performed automatically and invisible to the user. Half of the DCCM memory bank and the full XY banks or 3/4 of VCCM bank are occupied for MLI specific needs. If the user needs space in XY or VCCM memory for other tasks, these arrays can be reduced by setting specific sizes. For this, add the following option to build command replacing **&lt;size[a|b|c]&gt;** with required values:</p>
<p><b>For EM:</b> </p><div class="fragment"><div class="line">EXT_CFLAGS=&quot;-DSCRATCH_MEM_Z_SIZE=&lt;size_a&gt; -DSCRATCH_MEM_X_SIZE=&lt;size_b&gt; -DSCRATCH_MEM_Y_SIZE=&lt;size_c&gt;&quot;</div>
</div><!-- fragment --><p> <b>For VPX:</b> </p><div class="fragment"><div class="line">EXT_CFLAGS=&quot;-DSCRATCH_MEM_VEC_SIZE=&lt;size_a&gt;&quot;</div>
</div><!-- fragment --><p>For example, to reduce sizes of arrays placed in DCCM and XCCM to 32k and 8k respectively, use next command:</p>
<div class="fragment"><div class="line">make -f tensorflow/lite/micro/tools/make/Makefile &lt;...&gt; \</div>
<div class="line">EXT_CFLAGS=&quot;-DSCRATCH_MEM_Z_SIZE=32*1024 -DSCRATCH_MEM_X_SIZE=8*1024&quot; \</div>
<div class="line">microlite</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md327"></a>
License</h1>
<p>TensorFlow's code is covered by the Apache2 License included in the repository, and third party dependencies are covered by their respective licenses, in the third_party folder of this package. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
