<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Machine Vision using Portenta H7: Face_Access_inferencing/src/edge-impulse-sdk/classifier/inferencing_engines/akida.h Source File</title>
<link rel="icon" href="logo.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Machine Vision using Portenta H7<span id="projectnumber">&#160;2</span>
   </div>
   <div id="projectbrief">This project aims to develop a face recognition-based access control system using the Arduino Portenta H7 and Vision Shield, leveraging Edge Impulse for machine learning. The system captures facial images, processes them locally using an AI model deployed on the Portenta H7 and determines access based on authorised personnel.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_05f86cf2d1c107dceef0ab0392ddcfcf.html">Face_Access_inferencing</a></li><li class="navelem"><a class="el" href="dir_a10e16a828caf535b3ccf4484f92e610.html">src</a></li><li class="navelem"><a class="el" href="dir_295f854905297c9d29514d45981534fb.html">edge-impulse-sdk</a></li><li class="navelem"><a class="el" href="dir_23fbe5a3fb0933f31748c7066d658296.html">classifier</a></li><li class="navelem"><a class="el" href="dir_63d11d38fe0a40715ad2e5045faba8c4.html">inferencing_engines</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">akida.h</div></div>
</div><!--header-->
<div class="contents">
<a href="akida_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/* Edge Impulse inferencing library</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> * Copyright (c) 2022 EdgeImpulse Inc.</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> *</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"> * Permission is hereby granted, free of charge, to any person obtaining a copy</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> * of this software and associated documentation files (the &quot;Software&quot;), to deal</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> * in the Software without restriction, including without limitation the rights</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"> * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"> * copies of the Software, and to permit persons to whom the Software is</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment"> * furnished to do so, subject to the following conditions:</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"> *</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"> * The above copyright notice and this permission notice shall be included in</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment"> * all copies or substantial portions of the Software.</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"> *</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"> * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment"> * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment"> * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment"> * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment"> * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment"> * SOFTWARE.</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment"> */</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#ifndef EI_CLASSIFIER_INFERENCING_ENGINE_AKIDA_H</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#define EI_CLASSIFIER_INFERENCING_ENGINE_AKIDA_H</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span> </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#if (EI_CLASSIFIER_INFERENCING_ENGINE == EI_CLASSIFIER_AKIDA)</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span> </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#ifndef EI_CLASSIFIER_USE_AKIDA_SOFTWARE</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno"><a class="line" href="akida_8h.html#a5869d3fdfd7859778956cb134e450b25">   34</a></span><span class="preprocessor">#define EI_CLASSIFIER_USE_AKIDA_HARDWARE 1</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#ifndef EI_CLASSIFIER_USE_AKIDA_HARDWARE_NO</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno"><a class="line" href="akida_8h.html#a78c6e19b13ec911a14929813c0e873a4">   44</a></span><span class="preprocessor">#define EI_CLASSIFIER_USE_AKIDA_HARDWARE_NO 0</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="preprocessor">#include &quot;<a class="code" href="model__metadata_8h.html">model-parameters/model_metadata.h</a>&quot;</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="preprocessor">#include &lt;thread&gt;</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="preprocessor">#include &quot;tensorflow-lite/tensorflow/lite/c/common.h&quot;</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="preprocessor">#include &quot;tensorflow-lite/tensorflow/lite/interpreter.h&quot;</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="preprocessor">#include &quot;tensorflow-lite/tensorflow/lite/kernels/register.h&quot;</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="preprocessor">#include &quot;tensorflow-lite/tensorflow/lite/model.h&quot;</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="preprocessor">#include &quot;tensorflow-lite/tensorflow/lite/optional_debug_tools.h&quot;</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="preprocessor">#include &quot;<a class="code" href="kernels_2custom_2tree__ensemble__classifier_8h.html">edge-impulse-sdk/tensorflow/lite/kernels/custom/tree_ensemble_classifier.h</a>&quot;</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="preprocessor">#include &quot;<a class="code" href="ei__model__types_8h.html">edge-impulse-sdk/classifier/ei_model_types.h</a>&quot;</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="preprocessor">#include &quot;<a class="code" href="ei__classifier__porting_8h.html">edge-impulse-sdk/porting/ei_classifier_porting.h</a>&quot;</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="preprocessor">#include &quot;<a class="code" href="ei__fill__result__struct_8h.html">edge-impulse-sdk/classifier/ei_fill_result_struct.h</a>&quot;</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="preprocessor">#include &quot;tensorflow-lite/tensorflow/lite/kernels/internal/reference/softmax.h&quot;</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="preprocessor">#undef EI_CLASSIFIER_INFERENCING_ENGINE</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno"><a class="line" href="akida_8h.html#a852c1b8b4e1ae56d138cc7b1bac3fb37">   60</a></span><span class="preprocessor">#define EI_CLASSIFIER_INFERENCING_ENGINE EI_CLASSIFIER_TFLITE_FULL</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span><span class="preprocessor">#include &quot;<a class="code" href="tflite__helper_8h.html">tflite_helper.h</a>&quot;</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="preprocessor">#undef EI_CLASSIFIER_INFERENCING_ENGINE</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="preprocessor">#define EI_CLASSIFIER_INFERENCING_ENGINE EI_CLASSIFIER_AKIDA</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span><span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span><span class="preprocessor">#include &quot;pybind11/embed.h&quot;</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span><span class="preprocessor">#include &quot;pybind11/numpy.h&quot;</span></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span><span class="preprocessor">#include &quot;pybind11/stl.h&quot;</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span> </div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><span class="keyword">namespace </span>py = pybind11;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno"><a class="line" href="akida_8h.html#a385b0bd18814f0f7ad3e2606c5f30f25">   77</a></span>std::stringstream <a class="code hl_variable" href="akida_8h.html#a385b0bd18814f0f7ad3e2606c5f30f25">engine_info</a>;</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno"><a class="line" href="akida_8h.html#ad3aeb8015fd4de80acbfcccbd480d4f9">   79</a></span><span class="keyword">static</span> py::module_ <a class="code hl_variable" href="akida_8h.html#ad3aeb8015fd4de80acbfcccbd480d4f9">akida</a>;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno"><a class="line" href="akida_8h.html#aae63da0a007121c8192c17ac8be89a16">   80</a></span><span class="keyword">static</span> py::object <a class="code hl_variable" href="akida_8h.html#aae63da0a007121c8192c17ac8be89a16">model</a>;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno"><a class="line" href="akida_8h.html#a0d0653d977a05dc75b9983c143d63cda">   81</a></span><span class="keyword">static</span> py::object <a class="code hl_variable" href="akida_8h.html#a0d0653d977a05dc75b9983c143d63cda">model_predict</a>;</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno"><a class="line" href="akida_8h.html#a68b6b78623e05bae409754c3103e52be">   82</a></span><span class="keyword">static</span> py::object <a class="code hl_variable" href="akida_8h.html#a68b6b78623e05bae409754c3103e52be">model_forward</a>;</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno"><a class="line" href="akida_8h.html#ad56ed4d147ee2780df7f469658e8dd67">   83</a></span><span class="keyword">static</span> py::object <a class="code hl_variable" href="akida_8h.html#ad56ed4d147ee2780df7f469658e8dd67">device</a>;</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno"><a class="line" href="akida_8h.html#af35d4fe88ce6a2e276c3ff3c542460ad">   84</a></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="akida_8h.html#af35d4fe88ce6a2e276c3ff3c542460ad">akida_initialized</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno"><a class="line" href="akida_8h.html#a0792621910eb31f95019ddc94eb3dece">   85</a></span><span class="keyword">static</span> std::vector&lt;size_t&gt; <a class="code hl_variable" href="akida_8h.html#a0792621910eb31f95019ddc94eb3dece">input_shape</a>;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno"><a class="line" href="akida_8h.html#a52cd3949eba004f3b8791be094e50549">   86</a></span><span class="keyword">static</span> <a class="code hl_class" href="classtflite_1_1_runtime_shape.html">tflite::RuntimeShape</a> <a class="code hl_variable" href="akida_8h.html#a52cd3949eba004f3b8791be094e50549">softmax_shape</a>;</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno"><a class="line" href="akida_8h.html#aa32eba6b3164559e24b544f632e08fb6">   87</a></span><span class="keyword">static</span> <a class="code hl_struct" href="structtflite_1_1_softmax_params.html">tflite::SoftmaxParams</a> <a class="code hl_variable" href="akida_8h.html#aa32eba6b3164559e24b544f632e08fb6">dummy_params</a>;</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno"><a class="line" href="akida_8h.html#a7b950177d9cb45e5c1ca09f7ff945deb">   88</a></span><span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="akida_8h.html#a7b950177d9cb45e5c1ca09f7ff945deb">model_input_bits</a> = 0;</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno"><a class="line" href="akida_8h.html#a1d28dec57cce925ad92342891bd71e7c">   89</a></span><span class="keyword">static</span> <span class="keywordtype">float</span> <a class="code hl_variable" href="akida_8h.html#a1d28dec57cce925ad92342891bd71e7c">scale</a>;</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno"><a class="line" href="akida_8h.html#abe40c211ae00ce28964899acf497071b">   90</a></span><span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="akida_8h.html#abe40c211ae00ce28964899acf497071b">down_scale</a>;</div>
<div class="foldopen" id="foldopen00091" data-start="{" data-end="};">
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno"><a class="line" href="structei__tflite__state__t.html">   91</a></span><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno"><a class="line" href="structei__tflite__state__t.html#a2a718661b2d6a6d38d0fe7d29cef2bb7">   92</a></span>    std::unique_ptr&lt;tflite::FlatBufferModel&gt; <a class="code hl_variable" href="structei__tflite__state__t.html#a2a718661b2d6a6d38d0fe7d29cef2bb7">model</a>;</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno"><a class="line" href="structei__tflite__state__t.html#af2d64469ee7ca0b7755ecf866d9880fc">   93</a></span>    std::unique_ptr&lt;tflite::Interpreter&gt; <a class="code hl_variable" href="structei__tflite__state__t.html#af2d64469ee7ca0b7755ecf866d9880fc">interpreter</a>;</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>} <a class="code hl_struct" href="structei__tflite__state__t.html">ei_tflite_state_t</a>;</div>
</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span> </div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno"><a class="line" href="akida_8h.html#a8d592742eb6381339c788d23b68712fc">   96</a></span>std::map&lt;uint32_t, ei_tflite_state_t*&gt; <a class="code hl_variable" href="akida_8h.html#a8d592742eb6381339c788d23b68712fc">ei_tflite_instances</a>;</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span> </div>
<div class="foldopen" id="foldopen00098" data-start="{" data-end="}">
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno"><a class="line" href="akida_8h.html#a0b1bcf29bf5a39167d540cd3ee1ce0f8">   98</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="akida_8h.html#a0b1bcf29bf5a39167d540cd3ee1ce0f8">init_akida</a>(<span class="keyword">const</span> uint8_t *model_arr, <span class="keywordtype">size_t</span> model_arr_size, <span class="keywordtype">bool</span> <a class="code hl_variable" href="ei__fill__result__struct_8h.html#a881f62341b5a41a3c5707268bd537be1">debug</a>)</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>{</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    py::module_ sys;</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    py::list path;</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>    <span class="keyword">constexpr</span> <span class="keywordtype">char</span> model_file_path[] = <span class="stringliteral">&quot;/tmp/akida_model.fbz&quot;</span>;</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span> </div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="ei__fill__result__struct_8h.html#a881f62341b5a41a3c5707268bd537be1">debug</a>) {</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>            sys = py::module_::import(<span class="stringliteral">&quot;sys&quot;</span>);</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>            path = sys.attr(<span class="stringliteral">&quot;path&quot;</span>);</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>            <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;DEBUG: sys.path:&quot;</span>);</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>            <span class="keywordflow">for</span> (py::handle p: path) {</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>                <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;\t%s\n&quot;</span>, p.cast&lt;std::string&gt;().c_str());</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>            }</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>        }</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>        <span class="keywordflow">catch</span> (py::error_already_set &amp;e) {</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>            <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;ERR: Importing &#39;sys&#39; library failed:\n%s\n&quot;</span>, e.what());</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>            <span class="comment">// as it is only for debug purposes, continue</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>        }</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>    }</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span> </div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>        <span class="comment">// import Python&#39;s akida module</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>        <a class="code hl_variable" href="akida_8h.html#ad3aeb8015fd4de80acbfcccbd480d4f9">akida</a> = py::module_::import(<span class="stringliteral">&quot;akida&quot;</span>);</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>    }</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    <span class="keywordflow">catch</span> (py::error_already_set &amp;e) {</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;ERR: Importing &#39;akida&#39; library failed:\n%s\n&quot;</span>, e.what());</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    }</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span> </div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="ei__fill__result__struct_8h.html#a881f62341b5a41a3c5707268bd537be1">debug</a>) {</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>        std::string ver = <a class="code hl_variable" href="akida_8h.html#ad3aeb8015fd4de80acbfcccbd480d4f9">akida</a>.attr(<span class="stringliteral">&quot;__version__&quot;</span>).cast&lt;std::string&gt;();</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;DEBUG: Akida version: %s\n&quot;</span>, ver.c_str());</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    }</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span> </div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    py::object Model = <a class="code hl_variable" href="akida_8h.html#ad3aeb8015fd4de80acbfcccbd480d4f9">akida</a>.attr(<span class="stringliteral">&quot;Model&quot;</span>);</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span> </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    <span class="comment">// deploy akida model file into temporary file</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    std::ofstream model_file(model_file_path, std::ios::out | std::ios::binary);</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    model_file.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(model_arr), model_arr_size);</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    <span class="keywordflow">if</span>(model_file.bad()) {</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;ERR: failed to unpack model ile into %s\n&quot;</span>, model_file_path);</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>        model_file.close();</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    }</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    model_file.close();</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span> </div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    <span class="comment">// load model</span></div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>        <a class="code hl_variable" href="akida_8h.html#aae63da0a007121c8192c17ac8be89a16">model</a> = Model(model_file_path);</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>    }</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    <span class="keywordflow">catch</span> (py::error_already_set &amp;e) {</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;ERR: Can&#39;t load model file from %s\n&quot;</span>, model_file_path);</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;ERR: %s\n&quot;</span>, e.what());</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    }</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span> </div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    <span class="comment">// get input shape from model</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <a class="code hl_variable" href="akida_8h.html#a0792621910eb31f95019ddc94eb3dece">input_shape</a> = <a class="code hl_variable" href="akida_8h.html#aae63da0a007121c8192c17ac8be89a16">model</a>.attr(<span class="stringliteral">&quot;input_shape&quot;</span>).cast&lt;std::vector&lt;size_t&gt;&gt;();</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>    <span class="comment">//TODO: temporarily only 3D input data is supported (see note in run_nn_inference)</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="akida_8h.html#a0792621910eb31f95019ddc94eb3dece">input_shape</a>.size() != 3) {</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;ERR: Unsupported input data shape. Expected 3 dimensions got %d\n&quot;</span>, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="akida_8h.html#a0792621910eb31f95019ddc94eb3dece">input_shape</a>.size());</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    }</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    <span class="comment">// extend input by (N, ...) - hardcoded to (1, ...)</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    <a class="code hl_variable" href="akida_8h.html#a0792621910eb31f95019ddc94eb3dece">input_shape</a>.insert(<a class="code hl_variable" href="akida_8h.html#a0792621910eb31f95019ddc94eb3dece">input_shape</a>.begin(), (<span class="keywordtype">size_t</span>)1);</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span> </div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    <span class="comment">// get model input_bits</span></div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>    std::vector&lt;py::object&gt; layers = <a class="code hl_variable" href="akida_8h.html#aae63da0a007121c8192c17ac8be89a16">model</a>.attr(<span class="stringliteral">&quot;layers&quot;</span>).cast&lt;std::vector&lt;py::object&gt;&gt;();</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    <span class="keyword">auto</span> input_layer = layers[0];</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>    <a class="code hl_variable" href="akida_8h.html#a7b950177d9cb45e5c1ca09f7ff945deb">model_input_bits</a> = input_layer.attr(<span class="stringliteral">&quot;input_bits&quot;</span>).cast&lt;<span class="keywordtype">int</span>&gt;();</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>    <span class="keywordflow">if</span>((<a class="code hl_variable" href="akida_8h.html#a7b950177d9cb45e5c1ca09f7ff945deb">model_input_bits</a> != 8) &amp;&amp; (<a class="code hl_variable" href="akida_8h.html#a7b950177d9cb45e5c1ca09f7ff945deb">model_input_bits</a> != 4)) {</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;ERR: Unsupported input_bits. Expected 4 or 8 got %d\n&quot;</span>, <a class="code hl_variable" href="akida_8h.html#a7b950177d9cb45e5c1ca09f7ff945deb">model_input_bits</a>);</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>    }</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span> </div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    <span class="comment">// initialize scale coefficients</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="akida_8h.html#a7b950177d9cb45e5c1ca09f7ff945deb">model_input_bits</a> == 8) {</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>        <a class="code hl_variable" href="akida_8h.html#a1d28dec57cce925ad92342891bd71e7c">scale</a> = 255;</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>        <a class="code hl_variable" href="akida_8h.html#abe40c211ae00ce28964899acf497071b">down_scale</a> = 1;</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>    }</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_variable" href="akida_8h.html#a7b950177d9cb45e5c1ca09f7ff945deb">model_input_bits</a> == 4) {</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>        <span class="comment">// these values are recommended by BrainChip</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>        <a class="code hl_variable" href="akida_8h.html#a1d28dec57cce925ad92342891bd71e7c">scale</a> = 15;</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>        <a class="code hl_variable" href="akida_8h.html#abe40c211ae00ce28964899acf497071b">down_scale</a> = 16;</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    }</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="ei__fill__result__struct_8h.html#a881f62341b5a41a3c5707268bd537be1">debug</a>) {</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;INFO: Model input_bits: %d\n&quot;</span>, <a class="code hl_variable" href="akida_8h.html#a7b950177d9cb45e5c1ca09f7ff945deb">model_input_bits</a>);</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;INFO: Scale: %f\n&quot;</span>, <a class="code hl_variable" href="akida_8h.html#a1d28dec57cce925ad92342891bd71e7c">scale</a>);</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;INFO: Down scale: %d\n&quot;</span>, <a class="code hl_variable" href="akida_8h.html#abe40c211ae00ce28964899acf497071b">down_scale</a>);</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    }</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span> </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span><span class="preprocessor">#if (defined(EI_CLASSIFIER_USE_AKIDA_HARDWARE) &amp;&amp; (EI_CLASSIFIER_USE_AKIDA_HARDWARE == 1))</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>    <span class="comment">// get list of available devices</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    py::list devices = <a class="code hl_variable" href="akida_8h.html#ad3aeb8015fd4de80acbfcccbd480d4f9">akida</a>.attr(<span class="stringliteral">&quot;devices&quot;</span>)();</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    <span class="keywordflow">if</span>(devices.empty() == <span class="keyword">true</span>) {</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;ERR: AKD1000 device not found!\n&quot;</span>);</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    }</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span> </div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    <span class="keywordflow">if</span>(devices.size() &gt; 1) {</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;More than one device found! Using /dev/akida%d\n&quot;</span>, <a class="code hl_define" href="akida_8h.html#a78c6e19b13ec911a14929813c0e873a4">EI_CLASSIFIER_USE_AKIDA_HARDWARE_NO</a>);</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>        <a class="code hl_variable" href="akida_8h.html#ad56ed4d147ee2780df7f469658e8dd67">device</a> = devices[<a class="code hl_define" href="akida_8h.html#a78c6e19b13ec911a14929813c0e873a4">EI_CLASSIFIER_USE_AKIDA_HARDWARE_NO</a>];</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>    }</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>        <a class="code hl_variable" href="akida_8h.html#ad56ed4d147ee2780df7f469658e8dd67">device</a> = devices[0];</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    }</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    <span class="comment">//TODO: check if selected device is correct (compare versions)</span></div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    <span class="comment">// enable power measurement</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    <a class="code hl_variable" href="akida_8h.html#ad56ed4d147ee2780df7f469658e8dd67">device</a>.attr(<span class="stringliteral">&quot;soc&quot;</span>).attr(<span class="stringliteral">&quot;power_measurement_enabled&quot;</span>) = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span> </div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    <span class="comment">// map model to the device</span></div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>        <a class="code hl_variable" href="akida_8h.html#aae63da0a007121c8192c17ac8be89a16">model</a>.attr(<span class="stringliteral">&quot;map&quot;</span>)(<a class="code hl_variable" href="akida_8h.html#ad56ed4d147ee2780df7f469658e8dd67">device</a>);</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    }</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    <span class="keywordflow">catch</span> (py::error_already_set &amp;e) {</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;ERR: Can&#39;t load the ML model onto the AKD1000 SoC\n&quot;</span>);</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;ERR: %s\n&quot;</span>, e.what());</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    }</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span><span class="preprocessor">#elif (defined(EI_CLASSIFIER_USE_AKIDA_SOFTWARE) &amp;&amp; (EI_CLASSIFIER_USE_AKIDA_SOFTWARE == 1))</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span><span class="preprocessor">#warning &quot;Akida model will be run in SIMULATION mode (not on real hardware)!&quot;</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span><span class="preprocessor">#error &quot;Neither EI_CLASSIFIER_USE_AKIDA_HARDWARE or EI_CLASSIFIER_USE_AKIDA_SOFTWARE are defined or set to 1&quot;</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span> </div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    <span class="comment">// init softmax shape</span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    std::vector&lt;size_t&gt; tmp = <a class="code hl_variable" href="akida_8h.html#aae63da0a007121c8192c17ac8be89a16">model</a>.attr(<span class="stringliteral">&quot;output_shape&quot;</span>).cast&lt;std::vector&lt;size_t&gt;&gt;();</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    <a class="code hl_variable" href="akida_8h.html#a52cd3949eba004f3b8791be094e50549">softmax_shape</a>.BuildFrom(tmp);</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    <span class="comment">// dumy beta parameter for softmax purposes</span></div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    <a class="code hl_variable" href="akida_8h.html#aa32eba6b3164559e24b544f632e08fb6">dummy_params</a>.<a class="code hl_variable" href="structtflite_1_1_softmax_params.html#a8003007436aab20a1b265453c462067f">beta</a> = 1;</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span> </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>    <span class="comment">// get reference to predict function</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    <a class="code hl_variable" href="akida_8h.html#a0d0653d977a05dc75b9983c143d63cda">model_predict</a> = <a class="code hl_variable" href="akida_8h.html#aae63da0a007121c8192c17ac8be89a16">model</a>.attr(<span class="stringliteral">&quot;predict&quot;</span>);</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    <a class="code hl_variable" href="akida_8h.html#a68b6b78623e05bae409754c3103e52be">model_forward</a> = <a class="code hl_variable" href="akida_8h.html#aae63da0a007121c8192c17ac8be89a16">model</a>.attr(<span class="stringliteral">&quot;forward&quot;</span>);</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span> </div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    <span class="comment">// clear info stream</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    <a class="code hl_variable" href="akida_8h.html#a385b0bd18814f0f7ad3e2606c5f30f25">engine_info</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span> </div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>}</div>
</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span> </div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen00242" data-start="{" data-end="}">
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno"><a class="line" href="akida_8h.html#aac1b1c836ebe120022de348aaa277d27">  242</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="akida_8h.html#aac1b1c836ebe120022de348aaa277d27">debug_print</a>(<span class="keyword">const</span> std::vector&lt;T&gt; vec, <span class="keyword">const</span> <span class="keywordtype">int</span> val_per_row = 3)</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>{</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>    <span class="keywordtype">int</span> n = 0;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span> it = vec.begin(); it != vec.end(); it++) {</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;%f &quot;</span>, *it);</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>        <span class="keywordflow">if</span>(++n &gt; val_per_row - 1) {</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>            <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>            n = 0;</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>        }</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>    }</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>}</div>
</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span> </div>
<div class="foldopen" id="foldopen00264" data-start="{" data-end="}">
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno"><a class="line" href="akida_8h.html#ae95031a834aea77650106530f566fdb5">  264</a></span><a class="code hl_enumeration" href="group__ei__returntypes.html#gad9580b47a6cd5e74cfc31a03bdfecebe">EI_IMPULSE_ERROR</a> <a class="code hl_function" href="akida_8h.html#ae95031a834aea77650106530f566fdb5">run_nn_inference</a>(</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structei__impulse.html">ei_impulse_t</a> *impulse,</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>    <a class="code hl_struct" href="structei__feature__t.html">ei_feature_t</a> *fmatrix,</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    uint32_t learn_block_index,</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    uint32_t* input_block_ids,</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>    uint32_t input_block_ids_size,</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>    <a class="code hl_struct" href="structei__impulse__result__t.html">ei_impulse_result_t</a> *<a class="code hl_variable" href="group__ei__functions.html#gaf4ad914acba713176b1f00a800e781ba">result</a>,</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>    <span class="keywordtype">void</span> *<a class="code hl_variable" href="akida_8h.html#a3658b236936f6ec57ce82f0fd8cbdabb">config_ptr</a>,</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="ei__fill__result__struct_8h.html#a881f62341b5a41a3c5707268bd537be1">debug</a>)</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>{</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    <a class="code hl_struct" href="structei__learning__block__config__tflite__graph__t.html">ei_learning_block_config_tflite_graph_t</a> *<a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a> = ((<a class="code hl_struct" href="structei__learning__block__config__tflite__graph__t.html">ei_learning_block_config_tflite_graph_t</a>*)<a class="code hl_variable" href="akida_8h.html#a3658b236936f6ec57ce82f0fd8cbdabb">config_ptr</a>);</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    <a class="code hl_struct" href="structei__config__tflite__graph__t.html">ei_config_tflite_graph_t</a> *graph_config = ((<a class="code hl_struct" href="structei__config__tflite__graph__t.html">ei_config_tflite_graph_t</a>*)<a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a>-&gt;<a class="code hl_variable" href="structei__learning__block__config__tflite__graph__t.html#a42210921fb4db239d6b53c0409f6e5d9">graph_config</a>);</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span> </div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>    <a class="code hl_enumeration" href="group__ei__returntypes.html#gad9580b47a6cd5e74cfc31a03bdfecebe">EI_IMPULSE_ERROR</a> fill_res = <a class="code hl_variable" href="ei__fill__result__struct_8h.html#a2fb43be102b153d659b668ad295aff40">EI_IMPULSE_OK</a>;</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span> </div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    <span class="comment">// init Python embedded interpreter (should be called once!)</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>    <span class="keyword">static</span> py::scoped_interpreter guard{};</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span> </div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>    <span class="comment">// check if we&#39;ve initialized the interpreter and device?</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="akida_8h.html#af35d4fe88ce6a2e276c3ff3c542460ad">akida_initialized</a> == <span class="keyword">false</span>) {</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="akida_8h.html#a0b1bcf29bf5a39167d540cd3ee1ce0f8">init_akida</a>(graph_config-&gt;<a class="code hl_variable" href="structei__config__tflite__graph__t.html#adb1b1d255db9be3eb16c0d680ae9de50">model</a>, graph_config-&gt;<a class="code hl_variable" href="structei__config__tflite__graph__t.html#ac0f014d6d63f118b2dfe9f43c84ebd71">model_size</a>, <a class="code hl_variable" href="ei__fill__result__struct_8h.html#a881f62341b5a41a3c5707268bd537be1">debug</a>) == <span class="keyword">false</span>) {</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebea1137b5ef30c8f5241a42877876e3fcd9">EI_IMPULSE_AKIDA_ERROR</a>;</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>        }</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>        <a class="code hl_variable" href="akida_8h.html#af35d4fe88ce6a2e276c3ff3c542460ad">akida_initialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>    }</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>    <span class="comment">// according to:</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>    <span class="comment">// https://doc.brainchipinc.com/api_reference/akida_apis.html#akida.Model.predict</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>    <span class="comment">// input type is always uint8</span></div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    py::array_t&lt;uint8_t&gt; <a class="code hl_variable" href="add__n__test_8cc.html#a5612ba79d1f0b544c7aeae4621166fea">input_data</a>(<a class="code hl_variable" href="akida_8h.html#a0792621910eb31f95019ddc94eb3dece">input_shape</a>);</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span> </div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span><span class="comment">     * convert data to uint8 and copy features into input tensor</span></div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span><span class="comment">     * For images RGB shape is (width, height, colors)</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span><span class="comment">     * For images BW shape is (width, height, 1)</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span><span class="comment">     * For Audio shape is (width, height, 1) - spectrogram</span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span><span class="comment">     * TODO: test with other ML models/data types</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span><span class="comment">     * For details see:</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span><span class="comment">     * https://pybind11.readthedocs.io/en/stable/advanced/pycpp/numpy.html#direct-access</span></div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span><span class="comment">     */</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    <span class="keyword">auto</span> <a class="code hl_variable" href="_test_a_p_d_s9960_color_8ino.html#acab531abaa74a7e664e3986f2522b33a">r</a> = <a class="code hl_variable" href="add__n__test_8cc.html#a5612ba79d1f0b544c7aeae4621166fea">input_data</a>.mutable_unchecked&lt;4&gt;();</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    <span class="keywordtype">float</span> <a class="code hl_function" href="nicla__sense__fusion_8ino.html#ae6219c1117781a1dbbb7839946bca32c">temp</a>;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span> </div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>    <span class="keywordtype">size_t</span> mtx_size = impulse-&gt;<a class="code hl_variable" href="structei__impulse.html#aab279e170490f9b5c0c59eff0b6fa484">dsp_blocks_size</a> + impulse-&gt;<a class="code hl_variable" href="structei__impulse.html#a686152786fe6f16b174bfecfe01308a9">learning_blocks_size</a>;</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; input_block_ids_size; i++) {</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>        uint16_t cur_mtx = input_block_ids[i];</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span><span class="preprocessor">#if EI_CLASSIFIER_SINGLE_FEATURE_INPUT == 0</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>        ei::matrix_t* matrix = NULL;</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span> </div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>        <span class="keywordflow">if</span> (!find_mtx_by_idx(fmatrix, &amp;matrix, cur_mtx, mtx_size)) {</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>            <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;ERR: Cannot find matrix with id %zu\n&quot;</span>, cur_mtx);</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebeab011336593a9cc40639bac0c8a32a51e">EI_IMPULSE_INVALID_SIZE</a>;</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>        }</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>        ei::matrix_t* matrix = fmatrix[0].<a class="code hl_variable" href="structei__feature__t.html#a971fb9c93bddb4631925e579f5b88ebf">matrix</a>;</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>        <span class="keywordflow">for</span> (py::ssize_t <a class="code hl_variable" href="akida_8h.html#ab73668665ed1903aab8905ff035a33c5">x</a> = 0; <a class="code hl_variable" href="akida_8h.html#ab73668665ed1903aab8905ff035a33c5">x</a> &lt; <a class="code hl_variable" href="_test_a_p_d_s9960_color_8ino.html#acab531abaa74a7e664e3986f2522b33a">r</a>.shape(1); <a class="code hl_variable" href="akida_8h.html#ab73668665ed1903aab8905ff035a33c5">x</a>++) {</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>            <span class="keywordflow">for</span> (py::ssize_t <a class="code hl_variable" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcbb3c8e6cb6b1b9e60f2136ee8b58a8b6.html#aa4f0d3eebc3c443f9be81bf48561a217">y</a> = 0; <a class="code hl_variable" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcbb3c8e6cb6b1b9e60f2136ee8b58a8b6.html#aa4f0d3eebc3c443f9be81bf48561a217">y</a> &lt; <a class="code hl_variable" href="_test_a_p_d_s9960_color_8ino.html#acab531abaa74a7e664e3986f2522b33a">r</a>.shape(2); <a class="code hl_variable" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcbb3c8e6cb6b1b9e60f2136ee8b58a8b6.html#aa4f0d3eebc3c443f9be81bf48561a217">y</a>++) {</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>                <span class="keywordflow">for</span>(py::ssize_t z = 0; z &lt; <a class="code hl_variable" href="_test_a_p_d_s9960_color_8ino.html#acab531abaa74a7e664e3986f2522b33a">r</a>.shape(3); z++) {</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>                    <a class="code hl_function" href="nicla__sense__fusion_8ino.html#ae6219c1117781a1dbbb7839946bca32c">temp</a> = (matrix-&gt;buffer[<a class="code hl_variable" href="akida_8h.html#ab73668665ed1903aab8905ff035a33c5">x</a> * <a class="code hl_variable" href="_test_a_p_d_s9960_color_8ino.html#acab531abaa74a7e664e3986f2522b33a">r</a>.shape(2) * <a class="code hl_variable" href="_test_a_p_d_s9960_color_8ino.html#acab531abaa74a7e664e3986f2522b33a">r</a>.shape(3) + <a class="code hl_variable" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcbb3c8e6cb6b1b9e60f2136ee8b58a8b6.html#aa4f0d3eebc3c443f9be81bf48561a217">y</a> * <a class="code hl_variable" href="_test_a_p_d_s9960_color_8ino.html#acab531abaa74a7e664e3986f2522b33a">r</a>.shape(3) + z] * <a class="code hl_variable" href="akida_8h.html#a1d28dec57cce925ad92342891bd71e7c">scale</a>);</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>                    <a class="code hl_function" href="nicla__sense__fusion_8ino.html#ae6219c1117781a1dbbb7839946bca32c">temp</a> = std::max(0.0f, std::min(<a class="code hl_function" href="nicla__sense__fusion_8ino.html#ae6219c1117781a1dbbb7839946bca32c">temp</a>, 255.0f));</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>                    <a class="code hl_variable" href="_test_a_p_d_s9960_color_8ino.html#acab531abaa74a7e664e3986f2522b33a">r</a>(0, <a class="code hl_variable" href="akida_8h.html#ab73668665ed1903aab8905ff035a33c5">x</a>, <a class="code hl_variable" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcbb3c8e6cb6b1b9e60f2136ee8b58a8b6.html#aa4f0d3eebc3c443f9be81bf48561a217">y</a>, z) = (uint8_t)(<a class="code hl_function" href="nicla__sense__fusion_8ino.html#ae6219c1117781a1dbbb7839946bca32c">temp</a> / <a class="code hl_variable" href="akida_8h.html#abe40c211ae00ce28964899acf497071b">down_scale</a>);</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>                }</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>            }</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>        }</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>    }</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span> </div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>    <span class="comment">// Run inference on AKD1000</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    uint64_t ctx_start_us = <a class="code hl_function" href="group__ei__user__functions.html#gac9aae7befaa896e21417df1f00518416">ei_read_timer_us</a>();</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    py::array_t&lt;float&gt; potentials;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>        potentials = <a class="code hl_variable" href="akida_8h.html#a0d0653d977a05dc75b9983c143d63cda">model_predict</a>(<a class="code hl_variable" href="add__n__test_8cc.html#a5612ba79d1f0b544c7aeae4621166fea">input_data</a>);</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    }</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    <span class="keywordflow">catch</span> (py::error_already_set &amp;e) {</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;ERR: Inference error:\n%s\n&quot;</span>, e.what());</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebea1137b5ef30c8f5241a42877876e3fcd9">EI_IMPULSE_AKIDA_ERROR</a>;</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    }</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>    <span class="comment">// TODO: &#39;forward&#39; is returning int8 or int32, but EI SDK supports int8 or float32 only</span></div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    <span class="comment">// py::array_t&lt;float&gt; potentials = model_forward(input_data);</span></div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>    uint64_t ctx_end_us = <a class="code hl_function" href="group__ei__user__functions.html#gac9aae7befaa896e21417df1f00518416">ei_read_timer_us</a>();</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span> </div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    potentials = potentials.squeeze();</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span> </div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="ei__fill__result__struct_8h.html#a881f62341b5a41a3c5707268bd537be1">debug</a>) {</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>        std::string ret_str = py::str(potentials).cast&lt;std::string&gt;();</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;AKD1000 raw output:\n%s\n&quot;</span>, ret_str.c_str());</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>    }</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span> </div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>    <span class="comment">// convert to vector of floats to make further processing much easier</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    std::vector&lt;float&gt; potentials_v;<span class="comment">// = potentials.cast&lt;std::vector&lt;float&gt;&gt;();</span></div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span> </div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    <span class="comment">// TODO: output conversion depending on output shape?</span></div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a>-&gt;<a class="code hl_variable" href="structei__learning__block__config__tflite__graph__t.html#af1a9b7c47a826887609d831078ccbdbc">object_detection</a> == <span class="keyword">false</span>) {</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>        potentials_v = potentials.squeeze().cast&lt;std::vector&lt;float&gt;&gt;();</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>    }</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>        <span class="comment">// TODO: output from AkidaNet/MobileNet is always N x M x P (3 dimensions)?</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>        <span class="keyword">auto</span> q = potentials.unchecked&lt;&gt;();</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>        <span class="keywordflow">for</span> (py::ssize_t <a class="code hl_variable" href="akida_8h.html#ab73668665ed1903aab8905ff035a33c5">x</a> = 0; <a class="code hl_variable" href="akida_8h.html#ab73668665ed1903aab8905ff035a33c5">x</a> &lt; q.shape(0); <a class="code hl_variable" href="akida_8h.html#ab73668665ed1903aab8905ff035a33c5">x</a>++) {</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>            <span class="keywordflow">for</span> (py::ssize_t <a class="code hl_variable" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcbb3c8e6cb6b1b9e60f2136ee8b58a8b6.html#aa4f0d3eebc3c443f9be81bf48561a217">y</a> = 0; <a class="code hl_variable" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcbb3c8e6cb6b1b9e60f2136ee8b58a8b6.html#aa4f0d3eebc3c443f9be81bf48561a217">y</a> &lt; q.shape(1); <a class="code hl_variable" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcbb3c8e6cb6b1b9e60f2136ee8b58a8b6.html#aa4f0d3eebc3c443f9be81bf48561a217">y</a>++) {</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>                <span class="keywordflow">for</span>(py::ssize_t z = 0; z &lt; q.shape(2); z++) {</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>                    potentials_v.push_back(q(<a class="code hl_variable" href="akida_8h.html#ab73668665ed1903aab8905ff035a33c5">x</a>, <a class="code hl_variable" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcbb3c8e6cb6b1b9e60f2136ee8b58a8b6.html#aa4f0d3eebc3c443f9be81bf48561a217">y</a>, z));</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>                }</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>            }</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>        }</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    }</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span> </div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a>-&gt;<a class="code hl_variable" href="structei__learning__block__config__tflite__graph__t.html#a9f1d65f69c49cecaddb6b6abb65644ef">object_detection_last_layer</a> != <a class="code hl_define" href="ei__model__types_8h.html#ac1b68c7b64d1c0040288b01023b1efc4">EI_CLASSIFIER_LAST_LAYER_YOLOV2</a>) {</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>        <span class="comment">// apply softmax, becuase Akida is not supporting this operation</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>        <a class="code hl_function" href="namespacetflite_1_1reference__ops.html#ae06af6ac80f340cc1edfb85fc6f72633">tflite::reference_ops::Softmax</a>(<a class="code hl_variable" href="akida_8h.html#aa32eba6b3164559e24b544f632e08fb6">dummy_params</a>, <a class="code hl_variable" href="akida_8h.html#a52cd3949eba004f3b8791be094e50549">softmax_shape</a>, potentials_v.data(), <a class="code hl_variable" href="akida_8h.html#a52cd3949eba004f3b8791be094e50549">softmax_shape</a>, potentials_v.data());</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    }</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span> </div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="ei__fill__result__struct_8h.html#a881f62341b5a41a3c5707268bd537be1">debug</a> == <span class="keyword">true</span>) {</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;After softmax:\n&quot;</span>);</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>        <a class="code hl_function" href="akida_8h.html#aac1b1c836ebe120022de348aaa277d27">debug_print</a>(potentials_v);</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>    }</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span> </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>    <span class="keywordtype">float</span> active_power = 0;</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span><span class="preprocessor">#if (defined(EI_CLASSIFIER_USE_AKIDA_HARDWARE))</span></div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>    <span class="comment">// power measurement post-processing</span></div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>    <span class="keywordtype">float</span> floor_power = <a class="code hl_variable" href="akida_8h.html#ad56ed4d147ee2780df7f469658e8dd67">device</a>.attr(<span class="stringliteral">&quot;soc&quot;</span>).attr(<span class="stringliteral">&quot;power_meter&quot;</span>).attr(<span class="stringliteral">&quot;floor&quot;</span>).cast&lt;<span class="keywordtype">float</span>&gt;();</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>    py::array pwr_events = <a class="code hl_variable" href="akida_8h.html#ad56ed4d147ee2780df7f469658e8dd67">device</a>.attr(<span class="stringliteral">&quot;soc&quot;</span>).attr(<span class="stringliteral">&quot;power_meter&quot;</span>).attr(<span class="stringliteral">&quot;events&quot;</span>)();</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    <span class="keyword">auto</span> events = pwr_events.mutable_unchecked&lt;py::object&gt;();</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    <span class="keywordflow">for</span> (py::ssize_t i = 0; i &lt; events.shape(0); i++) {</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>        active_power += events(i).attr(<span class="stringliteral">&quot;power&quot;</span>).cast&lt;<span class="keywordtype">float</span>&gt;();</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>    }</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>    active_power = (active_power/pwr_events.size()) - floor_power;</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span> </div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>    <a class="code hl_variable" href="group__ei__functions.html#gaf4ad914acba713176b1f00a800e781ba">result</a>-&gt;timing.classification_us = ctx_end_us - ctx_start_us;</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>    <a class="code hl_variable" href="group__ei__functions.html#gaf4ad914acba713176b1f00a800e781ba">result</a>-&gt;timing.classification = (int)(<a class="code hl_variable" href="group__ei__functions.html#gaf4ad914acba713176b1f00a800e781ba">result</a>-&gt;timing.classification_us / 1000);</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span> </div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    <span class="comment">// clear info</span></div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>    <a class="code hl_variable" href="akida_8h.html#a385b0bd18814f0f7ad3e2606c5f30f25">engine_info</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>    <a class="code hl_variable" href="akida_8h.html#a385b0bd18814f0f7ad3e2606c5f30f25">engine_info</a> &lt;&lt; <span class="stringliteral">&quot;Power consumption: &quot;</span> &lt;&lt; std::fixed &lt;&lt; std::setprecision(2) &lt;&lt; active_power &lt;&lt; <span class="stringliteral">&quot; mW\n&quot;</span>;</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    <a class="code hl_variable" href="akida_8h.html#a385b0bd18814f0f7ad3e2606c5f30f25">engine_info</a> &lt;&lt; <span class="stringliteral">&quot;Inferences per second: &quot;</span> &lt;&lt; (1000000 / <a class="code hl_variable" href="group__ei__functions.html#gaf4ad914acba713176b1f00a800e781ba">result</a>-&gt;timing.classification_us);</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span> </div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a>-&gt;<a class="code hl_variable" href="structei__learning__block__config__tflite__graph__t.html#af1a9b7c47a826887609d831078ccbdbc">object_detection</a>) {</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>        <span class="keywordflow">switch</span> (<a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a>-&gt;<a class="code hl_variable" href="structei__learning__block__config__tflite__graph__t.html#a9f1d65f69c49cecaddb6b6abb65644ef">object_detection_last_layer</a>) {</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>            <span class="keywordflow">case</span> <a class="code hl_define" href="ei__model__types_8h.html#ae9f473b0f3438b846c2c12ab84338858">EI_CLASSIFIER_LAST_LAYER_FOMO</a>: {</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>                fill_res = fill_result_struct_f32_fomo(</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>                    impulse,</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>                    <a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a>,</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>                    <a class="code hl_variable" href="group__ei__functions.html#gaf4ad914acba713176b1f00a800e781ba">result</a>,</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>                    potentials_v.data(),</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>                    impulse-&gt;<a class="code hl_variable" href="structei__impulse.html#a51d2390841b11688a861c16753380c15">fomo_output_size</a>,</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>                    impulse-&gt;<a class="code hl_variable" href="structei__impulse.html#a51d2390841b11688a861c16753380c15">fomo_output_size</a>);</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>            }</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>            <span class="keywordflow">case</span> <a class="code hl_define" href="ei__model__types_8h.html#ac1b68c7b64d1c0040288b01023b1efc4">EI_CLASSIFIER_LAST_LAYER_YOLOV2</a>: {</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>                fill_res = fill_result_struct_f32_yolov2(</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>                    impulse,</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>                    <a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a>,</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>                    <a class="code hl_variable" href="group__ei__functions.html#gaf4ad914acba713176b1f00a800e781ba">result</a>,</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>                    potentials_v.data(),</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>                    impulse-&gt;<a class="code hl_variable" href="structei__impulse.html#a4dd1368c2ed2a4e899274669e81417e4">tflite_output_features_count</a>);</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>            }</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>            <span class="keywordflow">case</span> <a class="code hl_define" href="ei__model__types_8h.html#a92c64af4832fb183ad9e80b1e9231d41">EI_CLASSIFIER_LAST_LAYER_SSD</a>: {</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>                <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;ERR: MobileNet SSD models are not implemented for Akida (%d)\n&quot;</span>,</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>                    <a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a>-&gt;<a class="code hl_variable" href="structei__learning__block__config__tflite__graph__t.html#a9f1d65f69c49cecaddb6b6abb65644ef">object_detection_last_layer</a>);</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebea399c371041be7c468a3b05a4d8352d14">EI_IMPULSE_UNSUPPORTED_INFERENCING_ENGINE</a>;</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>            }</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>            <span class="keywordflow">case</span> <a class="code hl_define" href="ei__model__types_8h.html#ab706b8178a13309b0906763696334f45">EI_CLASSIFIER_LAST_LAYER_YOLOV5</a>: {</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>                <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;ERR: YOLO v5 models are not implemented for Akida (%d)\n&quot;</span>,</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>                    <a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a>-&gt;<a class="code hl_variable" href="structei__learning__block__config__tflite__graph__t.html#a9f1d65f69c49cecaddb6b6abb65644ef">object_detection_last_layer</a>);</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebea399c371041be7c468a3b05a4d8352d14">EI_IMPULSE_UNSUPPORTED_INFERENCING_ENGINE</a>;</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>            }</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>            <span class="keywordflow">default</span>: {</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>                <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;ERR: Unsupported object detection last layer (%d)\n&quot;</span>,</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>                    <a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a>-&gt;<a class="code hl_variable" href="structei__learning__block__config__tflite__graph__t.html#a9f1d65f69c49cecaddb6b6abb65644ef">object_detection_last_layer</a>);</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebea399c371041be7c468a3b05a4d8352d14">EI_IMPULSE_UNSUPPORTED_INFERENCING_ENGINE</a>;</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>            }</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>        }</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>    }</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>        fill_res = fill_result_struct_f32(impulse, <a class="code hl_variable" href="group__ei__functions.html#gaf4ad914acba713176b1f00a800e781ba">result</a>, potentials_v.data(), <a class="code hl_variable" href="ei__fill__result__struct_8h.html#a881f62341b5a41a3c5707268bd537be1">debug</a>);</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    }</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span> </div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <span class="keywordflow">return</span> fill_res;</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>}</div>
</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span> </div>
<div class="foldopen" id="foldopen00449" data-start="{" data-end="}">
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno"><a class="line" href="akida_8h.html#ade70c8b8e08562c755284449a4aaae57">  449</a></span><span class="keyword">static</span> <a class="code hl_enumeration" href="group__ei__returntypes.html#gad9580b47a6cd5e74cfc31a03bdfecebe">EI_IMPULSE_ERROR</a> <a class="code hl_function" href="akida_8h.html#ade70c8b8e08562c755284449a4aaae57">get_interpreter</a>(<a class="code hl_struct" href="structei__learning__block__config__tflite__graph__t.html">ei_learning_block_config_tflite_graph_t</a> *<a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a>, tflite::Interpreter **<a class="code hl_variable" href="_inference_allocate_tensor_8cpp.html#a0d8f3bb5211083760f7c593d57adb17d">interpreter</a>) {</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>    <span class="comment">// not in the map yet...</span></div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="akida_8h.html#a8d592742eb6381339c788d23b68712fc">ei_tflite_instances</a>.count(<a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a>-&gt;<a class="code hl_variable" href="structei__learning__block__config__tflite__graph__t.html#a7c304bc1ccb9ff5e2b8155b5f77c91df">block_id</a>)) {</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>        <a class="code hl_struct" href="structei__config__tflite__graph__t.html">ei_config_tflite_graph_t</a> *graph_config = (<a class="code hl_struct" href="structei__config__tflite__graph__t.html">ei_config_tflite_graph_t</a>*)<a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a>-&gt;<a class="code hl_variable" href="structei__learning__block__config__tflite__graph__t.html#a42210921fb4db239d6b53c0409f6e5d9">graph_config</a>;</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>        <a class="code hl_struct" href="structei__tflite__state__t.html">ei_tflite_state_t</a> *new_state = <span class="keyword">new</span> <a class="code hl_struct" href="structei__tflite__state__t.html">ei_tflite_state_t</a>();</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span> </div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>        <span class="keyword">auto</span> new_model = tflite::FlatBufferModel::BuildFromBuffer((<span class="keyword">const</span> <span class="keywordtype">char</span>*)graph_config-&gt;<a class="code hl_variable" href="structei__config__tflite__graph__t.html#adb1b1d255db9be3eb16c0d680ae9de50">model</a>, graph_config-&gt;<a class="code hl_variable" href="structei__config__tflite__graph__t.html#ac0f014d6d63f118b2dfe9f43c84ebd71">model_size</a>);</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>        new_state-&gt;<a class="code hl_variable" href="structei__tflite__state__t.html#a2a718661b2d6a6d38d0fe7d29cef2bb7">model</a> = std::move(new_model);</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>        <span class="keywordflow">if</span> (!new_state-&gt;<a class="code hl_variable" href="structei__tflite__state__t.html#a2a718661b2d6a6d38d0fe7d29cef2bb7">model</a>) {</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>            <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;Failed to build TFLite model from buffer\n&quot;</span>);</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebeadcc41afc4542dc94f9dcf36d88c1ea31">EI_IMPULSE_TFLITE_ERROR</a>;</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>        }</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span> </div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>        tflite::ops::builtin::BuiltinOpResolver resolver;</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span><span class="preprocessor">#if EI_CLASSIFIER_HAS_TREE_ENSEMBLE_CLASSIFIER</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>        resolver.AddCustom(<span class="stringliteral">&quot;TreeEnsembleClassifier&quot;</span>,</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>            <a class="code hl_function" href="namespacetflite_1_1ops_1_1custom.html#a07a3b1e549c28600dbaf71e6fe38f3f7">tflite::ops::custom::Register_TREE_ENSEMBLE_CLASSIFIER</a>());</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>        tflite::InterpreterBuilder builder(*new_state-&gt;<a class="code hl_variable" href="structei__tflite__state__t.html#a2a718661b2d6a6d38d0fe7d29cef2bb7">model</a>, resolver);</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>        builder(&amp;new_state-&gt;<a class="code hl_variable" href="structei__tflite__state__t.html#af2d64469ee7ca0b7755ecf866d9880fc">interpreter</a>);</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span> </div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>        <span class="keywordflow">if</span> (!new_state-&gt;<a class="code hl_variable" href="structei__tflite__state__t.html#af2d64469ee7ca0b7755ecf866d9880fc">interpreter</a>) {</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>            <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;Failed to construct interpreter\n&quot;</span>);</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebeadcc41afc4542dc94f9dcf36d88c1ea31">EI_IMPULSE_TFLITE_ERROR</a>;</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>        }</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span> </div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>        <span class="keywordflow">if</span> (new_state-&gt;<a class="code hl_variable" href="structei__tflite__state__t.html#af2d64469ee7ca0b7755ecf866d9880fc">interpreter</a>-&gt;AllocateTensors() != <a class="code hl_enumvalue" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcf7df9e575f8a1f1a49c58fb0f49428b8.html#acf79d2fb5fa520303014d1303f1f6361ab25fe210808197f1b6601df8ccdcd699">kTfLiteOk</a>) {</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>            <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;AllocateTensors failed\n&quot;</span>);</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebeadcc41afc4542dc94f9dcf36d88c1ea31">EI_IMPULSE_TFLITE_ERROR</a>;</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>        }</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span> </div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>        <span class="keywordtype">int</span> hw_thread_count = (int)std::thread::hardware_concurrency();</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>        hw_thread_count -= 1; <span class="comment">// leave one thread free for the other application</span></div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>        <span class="keywordflow">if</span> (hw_thread_count &lt; 1) {</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>            hw_thread_count = 1;</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>        }</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span> </div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>        <span class="keywordflow">if</span> (new_state-&gt;<a class="code hl_variable" href="structei__tflite__state__t.html#af2d64469ee7ca0b7755ecf866d9880fc">interpreter</a>-&gt;SetNumThreads(hw_thread_count) != <a class="code hl_enumvalue" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcf7df9e575f8a1f1a49c58fb0f49428b8.html#acf79d2fb5fa520303014d1303f1f6361ab25fe210808197f1b6601df8ccdcd699">kTfLiteOk</a>) {</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>            <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;SetNumThreads failed\n&quot;</span>);</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebeadcc41afc4542dc94f9dcf36d88c1ea31">EI_IMPULSE_TFLITE_ERROR</a>;</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>        }</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span> </div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>        <a class="code hl_variable" href="akida_8h.html#a8d592742eb6381339c788d23b68712fc">ei_tflite_instances</a>.insert(std::make_pair(<a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a>-&gt;<a class="code hl_variable" href="structei__learning__block__config__tflite__graph__t.html#a7c304bc1ccb9ff5e2b8155b5f77c91df">block_id</a>, new_state));</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>    }</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span> </div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>    <span class="keyword">auto</span> tflite_state = <a class="code hl_variable" href="akida_8h.html#a8d592742eb6381339c788d23b68712fc">ei_tflite_instances</a>[<a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a>-&gt;<a class="code hl_variable" href="structei__learning__block__config__tflite__graph__t.html#a7c304bc1ccb9ff5e2b8155b5f77c91df">block_id</a>];</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    *<a class="code hl_variable" href="_inference_allocate_tensor_8cpp.html#a0d8f3bb5211083760f7c593d57adb17d">interpreter</a> = tflite_state-&gt;interpreter.get();</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="ei__fill__result__struct_8h.html#a2fb43be102b153d659b668ad295aff40">EI_IMPULSE_OK</a>;</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>}</div>
</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span> </div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span> </div>
<div class="foldopen" id="foldopen00500" data-start="{" data-end="}">
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno"><a class="line" href="akida_8h.html#a85d5688f1dbc536dde02c237f84b5aa0">  500</a></span><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <a class="code hl_enumeration" href="group__ei__returntypes.html#gad9580b47a6cd5e74cfc31a03bdfecebe">EI_IMPULSE_ERROR</a> <a class="code hl_function" href="akida_8h.html#a85d5688f1dbc536dde02c237f84b5aa0">run_nn_inference_from_dsp</a>(</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>    <a class="code hl_struct" href="structei__learning__block__config__tflite__graph__t.html">ei_learning_block_config_tflite_graph_t</a> *<a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a>,</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>    <a class="code hl_struct" href="structei__signal__t.html">signal_t</a> *<a class="code hl_class" href="classei_1_1signal.html">signal</a>,</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>    <a class="code hl_struct" href="structei__matrix.html">matrix_t</a> *<a class="code hl_variable" href="akida_8h.html#aac4d93b158d42bda5829a01a9c507312">output_matrix</a>)</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>{</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>    tflite::Interpreter *<a class="code hl_variable" href="_inference_allocate_tensor_8cpp.html#a0d8f3bb5211083760f7c593d57adb17d">interpreter</a>;</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>    <span class="keyword">auto</span> interpreter_ret = <a class="code hl_function" href="akida_8h.html#ade70c8b8e08562c755284449a4aaae57">get_interpreter</a>(<a class="code hl_variable" href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a>, &amp;<a class="code hl_variable" href="_inference_allocate_tensor_8cpp.html#a0d8f3bb5211083760f7c593d57adb17d">interpreter</a>);</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>    <span class="keywordflow">if</span> (interpreter_ret != <a class="code hl_variable" href="ei__fill__result__struct_8h.html#a2fb43be102b153d659b668ad295aff40">EI_IMPULSE_OK</a>) {</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>        <span class="keywordflow">return</span> interpreter_ret;</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>    }</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span> </div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>    <a class="code hl_struct" href="struct_tf_lite_tensor.html">TfLiteTensor</a> *<a class="code hl_variable" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2src5afb18c45f6346167aa977a363205143.html#a9cebfb3d6ddd692fbdd268cf4b9ad024">input</a> = <a class="code hl_variable" href="_inference_allocate_tensor_8cpp.html#a0d8f3bb5211083760f7c593d57adb17d">interpreter</a>-&gt;<a class="code hl_function" href="classtflite_1_1_micro_interpreter.html#ac9046fdf3b601b6cbbcdcd4e28ad165d">input_tensor</a>(0);</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>    <a class="code hl_struct" href="struct_tf_lite_tensor.html">TfLiteTensor</a> *<a class="code hl_variable" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcbcd3bbe90c4644d53fde1ce4e312f437.html#a7a2a916a8059078c2d7a05f46c7126fd">output</a> = <a class="code hl_variable" href="_inference_allocate_tensor_8cpp.html#a0d8f3bb5211083760f7c593d57adb17d">interpreter</a>-&gt;<a class="code hl_function" href="classtflite_1_1_micro_interpreter.html#a03736f71506229819aa4d7a79947add3">output_tensor</a>(0);</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span> </div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2src5afb18c45f6346167aa977a363205143.html#a9cebfb3d6ddd692fbdd268cf4b9ad024">input</a>) {</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebeaffedb491b7409e8e885e1ab4abebaeeb">EI_IMPULSE_INPUT_TENSOR_WAS_NULL</a>;</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>    }</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcbcd3bbe90c4644d53fde1ce4e312f437.html#a7a2a916a8059078c2d7a05f46c7126fd">output</a>) {</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebea044ed37f0ac423223909460bad7850b4">EI_IMPULSE_OUTPUT_TENSOR_WAS_NULL</a>;</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>    }</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span> </div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>    <span class="keyword">auto</span> input_res = <a class="code hl_function" href="tflite__helper_8h.html#a055a4032becfb6fe674cae7cd44a30e4">fill_input_tensor_from_signal</a>(<a class="code hl_class" href="classei_1_1signal.html">signal</a>, <a class="code hl_variable" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2src5afb18c45f6346167aa977a363205143.html#a9cebfb3d6ddd692fbdd268cf4b9ad024">input</a>);</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>    <span class="keywordflow">if</span> (input_res != <a class="code hl_variable" href="ei__fill__result__struct_8h.html#a2fb43be102b153d659b668ad295aff40">EI_IMPULSE_OK</a>) {</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>        <span class="keywordflow">return</span> input_res;</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>    }</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span> </div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>    <a class="code hl_enumeration" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcf7df9e575f8a1f1a49c58fb0f49428b8.html#acf79d2fb5fa520303014d1303f1f6361">TfLiteStatus</a> <a class="code hl_variable" href="_simple_web_server_8ino.html#a6e27f49150e9a14580fb313cc2777e00">status</a> = <a class="code hl_variable" href="_inference_allocate_tensor_8cpp.html#a0d8f3bb5211083760f7c593d57adb17d">interpreter</a>-&gt;<a class="code hl_function" href="classtflite_1_1_micro_interpreter.html#a2d76c06ba8d41944e185c3d330e3d554">Invoke</a>();</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="_simple_web_server_8ino.html#a6e27f49150e9a14580fb313cc2777e00">status</a> != <a class="code hl_enumvalue" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcf7df9e575f8a1f1a49c58fb0f49428b8.html#acf79d2fb5fa520303014d1303f1f6361ab25fe210808197f1b6601df8ccdcd699">kTfLiteOk</a>) {</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>        <a class="code hl_function" href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a>(<span class="stringliteral">&quot;ERR: interpreter-&gt;Invoke() failed with %d\n&quot;</span>, <a class="code hl_variable" href="_simple_web_server_8ino.html#a6e27f49150e9a14580fb313cc2777e00">status</a>);</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebeadcc41afc4542dc94f9dcf36d88c1ea31">EI_IMPULSE_TFLITE_ERROR</a>;</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>    }</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span> </div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>    <span class="keyword">auto</span> output_res = <a class="code hl_function" href="tflite__helper_8h.html#a9e3b34d1ab6e54f17b2064eb046b0f1c">fill_output_matrix_from_tensor</a>(<a class="code hl_variable" href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcbcd3bbe90c4644d53fde1ce4e312f437.html#a7a2a916a8059078c2d7a05f46c7126fd">output</a>, <a class="code hl_variable" href="akida_8h.html#aac4d93b158d42bda5829a01a9c507312">output_matrix</a>);</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>    <span class="keywordflow">if</span> (output_res != <a class="code hl_variable" href="ei__fill__result__struct_8h.html#a2fb43be102b153d659b668ad295aff40">EI_IMPULSE_OK</a>) {</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>        <span class="keywordflow">return</span> output_res;</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>    }</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span> </div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>    <span class="comment">// on Linux we&#39;re not worried about free&#39;ing (for now)</span></div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span> </div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="ei__fill__result__struct_8h.html#a2fb43be102b153d659b668ad295aff40">EI_IMPULSE_OK</a>;</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>}</div>
</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno"><a class="line" href="akida_8h.html#aeeaf5d523ee6a290407328d5e17fa721">  542</a></span><a class="code hl_function" href="akida_8h.html#aeeaf5d523ee6a290407328d5e17fa721">__attribute__</a>((unused)) <span class="keywordtype">int</span> <a class="code hl_function" href="engines_8h.html#a335f8f33ce6e68893a2f4f7915e54cd4">extract_tflite_features</a>(<a class="code hl_struct" href="structei__signal__t.html">signal_t</a> *<a class="code hl_class" href="classei_1_1signal.html">signal</a>, <a class="code hl_struct" href="structei__matrix.html">matrix_t</a> *<a class="code hl_variable" href="akida_8h.html#aac4d93b158d42bda5829a01a9c507312">output_matrix</a>, <span class="keywordtype">void</span> *<a class="code hl_variable" href="akida_8h.html#a3658b236936f6ec57ce82f0fd8cbdabb">config_ptr</a>, <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_variable" href="akida_8h.html#a25c6eab61238d97eb4aaef9fc6d1fa4e">frequency</a>) {</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span> </div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>    <a class="code hl_struct" href="structei__dsp__config__tflite__t.html">ei_dsp_config_tflite_t</a> *dsp_config = (<a class="code hl_struct" href="structei__dsp__config__tflite__t.html">ei_dsp_config_tflite_t</a>*)<a class="code hl_variable" href="akida_8h.html#a3658b236936f6ec57ce82f0fd8cbdabb">config_ptr</a>;</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span> </div>
<div class="foldopen" id="foldopen00546" data-start="{" data-end="};">
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno"><a class="line" href="akida_8h.html#a3898ea656a9ba90bf49f93ba3906d1ee">  546</a></span>    <a class="code hl_struct" href="structei__config__tflite__graph__t.html">ei_config_tflite_graph_t</a> <a class="code hl_variable" href="akida_8h.html#a3898ea656a9ba90bf49f93ba3906d1ee">ei_config_tflite_graph_0</a> = {</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>        .implementation_version = 1,</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>        .model = dsp_config-&gt;<a class="code hl_variable" href="structei__dsp__config__tflite__t.html#a123eb13b7717010c84bc6e29a45b573b">model</a>,</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>        .model_size = dsp_config-&gt;<a class="code hl_variable" href="structei__dsp__config__tflite__t.html#a0990565bb857f0ddf54125a7c27bcf12">model_size</a>,</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>        .arena_size = dsp_config-&gt;<a class="code hl_variable" href="structei__dsp__config__tflite__t.html#a1a887092369ac7fba59caaf55788a814">arena_size</a></div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>    };</div>
</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span> </div>
<div class="foldopen" id="foldopen00553" data-start="{" data-end="};">
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno"><a class="line" href="akida_8h.html#ab7daefa6e7828a2d77c57f1b54404881">  553</a></span>    <a class="code hl_struct" href="structei__learning__block__config__tflite__graph__t.html">ei_learning_block_config_tflite_graph_t</a> <a class="code hl_variable" href="akida_8h.html#ab7daefa6e7828a2d77c57f1b54404881">ei_learning_block_config</a> = {</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>        .implementation_version = 1,</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>        .classification_mode = <a class="code hl_define" href="ei__model__types_8h.html#a76c13cf6c356590ec9aa183c25b90a5e">EI_CLASSIFIER_CLASSIFICATION_MODE_DSP</a>,</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>        .block_id = dsp_config-&gt;<a class="code hl_variable" href="structei__dsp__config__tflite__t.html#a301036544ec7e6b7a09ee37be2ac720d">block_id</a>,</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>        .object_detection = <span class="keyword">false</span>,</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>        .object_detection_last_layer = <a class="code hl_define" href="ei__model__types_8h.html#a67edebb42ed0ac73b3a4337ae07a281e">EI_CLASSIFIER_LAST_LAYER_UNKNOWN</a>,</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>        .output_data_tensor = 0,</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>        .output_labels_tensor = 255,</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>        .output_score_tensor = 255,</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>        .threshold = 0,</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>        .quantized = 0,</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>        .compiled = 1,</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>        .graph_config = &amp;<a class="code hl_variable" href="akida_8h.html#a3898ea656a9ba90bf49f93ba3906d1ee">ei_config_tflite_graph_0</a></div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>    };</div>
</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span> </div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno"><a class="line" href="akida_8h.html#ab73668665ed1903aab8905ff035a33c5">  568</a></span>    <span class="keyword">auto</span> <a class="code hl_variable" href="akida_8h.html#ab73668665ed1903aab8905ff035a33c5">x</a> = <a class="code hl_function" href="akida_8h.html#a85d5688f1dbc536dde02c237f84b5aa0">run_nn_inference_from_dsp</a>(&amp;<a class="code hl_variable" href="akida_8h.html#ab7daefa6e7828a2d77c57f1b54404881">ei_learning_block_config</a>, <a class="code hl_class" href="classei_1_1signal.html">signal</a>, <a class="code hl_variable" href="akida_8h.html#aac4d93b158d42bda5829a01a9c507312">output_matrix</a>);</div>
<div class="foldopen" id="foldopen00569" data-start="{" data-end="}">
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno"><a class="line" href="akida_8h.html#a93caf3ab6ba7b29b743c765d2b83fa79">  569</a></span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="akida_8h.html#ab73668665ed1903aab8905ff035a33c5">x</a> != 0) {</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="akida_8h.html#ab73668665ed1903aab8905ff035a33c5">x</a>;</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>    }</div>
</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span> </div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno"><a class="line" href="akida_8h.html#a54eac5b77b39bd93efe5b92bbf779cd8">  573</a></span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="akida_8h.html#a54eac5b77b39bd93efe5b92bbf779cd8">EIDSP_OK</a>;</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>}</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span> </div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span><span class="preprocessor">#endif </span><span class="comment">// EI_CLASSIFIER_INFERENCING_ENGINE == EI_CLASSIFIER_AKIDA</span></div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span> </div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span><span class="preprocessor">#endif </span><span class="comment">/* EI_CLASSIFIER_INFERENCING_ENGINE_AKIDA_H */</span><span class="preprocessor"></span></div>
<div class="ttc" id="a_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2src5afb18c45f6346167aa977a363205143_html_a9cebfb3d6ddd692fbdd268cf4b9ad024"><div class="ttname"><a href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2src5afb18c45f6346167aa977a363205143.html#a9cebfb3d6ddd692fbdd268cf4b9ad024">input</a></div><div class="ttdeci">TfLiteTensor * input</div><div class="ttdef"><b>Definition</b> squeeze.cpp:43</div></div>
<div class="ttc" id="a_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcbb3c8e6cb6b1b9e60f2136ee8b58a8b6_html_aa4f0d3eebc3c443f9be81bf48561a217"><div class="ttname"><a href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcbb3c8e6cb6b1b9e60f2136ee8b58a8b6.html#aa4f0d3eebc3c443f9be81bf48561a217">y</a></div><div class="ttdeci">float y</div><div class="ttdef"><b>Definition</b> detection_postprocess.cpp:80</div></div>
<div class="ttc" id="a_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcbcd3bbe90c4644d53fde1ce4e312f437_html_a7a2a916a8059078c2d7a05f46c7126fd"><div class="ttname"><a href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcbcd3bbe90c4644d53fde1ce4e312f437.html#a7a2a916a8059078c2d7a05f46c7126fd">output</a></div><div class="ttdeci">TfLiteEvalTensor * output</div><div class="ttdef"><b>Definition</b> maximum_minimum.cpp:49</div></div>
<div class="ttc" id="a_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcf7df9e575f8a1f1a49c58fb0f49428b8_html_acf79d2fb5fa520303014d1303f1f6361"><div class="ttname"><a href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcf7df9e575f8a1f1a49c58fb0f49428b8.html#acf79d2fb5fa520303014d1303f1f6361">TfLiteStatus</a></div><div class="ttdeci">TfLiteStatus</div><div class="ttdef"><b>Definition</b> c_api_types.h:55</div></div>
<div class="ttc" id="a_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcf7df9e575f8a1f1a49c58fb0f49428b8_html_acf79d2fb5fa520303014d1303f1f6361ab25fe210808197f1b6601df8ccdcd699"><div class="ttname"><a href="_arduino_2_get_started_with_machine_learning_on_arduino_2tflite-micro-arduino-examples-main_2srcf7df9e575f8a1f1a49c58fb0f49428b8.html#acf79d2fb5fa520303014d1303f1f6361ab25fe210808197f1b6601df8ccdcd699">kTfLiteOk</a></div><div class="ttdeci">@ kTfLiteOk</div><div class="ttdef"><b>Definition</b> c_api_types.h:56</div></div>
<div class="ttc" id="a_inference_allocate_tensor_8cpp_html_a0d8f3bb5211083760f7c593d57adb17d"><div class="ttname"><a href="_inference_allocate_tensor_8cpp.html#a0d8f3bb5211083760f7c593d57adb17d">interpreter</a></div><div class="ttdeci">tflite::MicroInterpreter interpreter(model, resolver, tensor_arena, kTensorArenaSize, error_reporter)</div></div>
<div class="ttc" id="a_simple_web_server_8ino_html_a6e27f49150e9a14580fb313cc2777e00"><div class="ttname"><a href="_simple_web_server_8ino.html#a6e27f49150e9a14580fb313cc2777e00">status</a></div><div class="ttdeci">int status</div><div class="ttdef"><b>Definition</b> SimpleWebServer.ino:9</div></div>
<div class="ttc" id="a_test_a_p_d_s9960_color_8ino_html_acab531abaa74a7e664e3986f2522b33a"><div class="ttname"><a href="_test_a_p_d_s9960_color_8ino.html#acab531abaa74a7e664e3986f2522b33a">r</a></div><div class="ttdeci">int r</div><div class="ttdef"><b>Definition</b> TestAPDS9960Color.ino:10</div></div>
<div class="ttc" id="aadd__n__test_8cc_html_a5612ba79d1f0b544c7aeae4621166fea"><div class="ttname"><a href="add__n__test_8cc.html#a5612ba79d1f0b544c7aeae4621166fea">input_data</a></div><div class="ttdeci">T input_data[kNumInputs][kOutputSize]</div><div class="ttdef"><b>Definition</b> add_n_test.cc:77</div></div>
<div class="ttc" id="aakida_8h_html_a0792621910eb31f95019ddc94eb3dece"><div class="ttname"><a href="akida_8h.html#a0792621910eb31f95019ddc94eb3dece">input_shape</a></div><div class="ttdeci">static std::vector&lt; size_t &gt; input_shape</div><div class="ttdef"><b>Definition</b> akida.h:85</div></div>
<div class="ttc" id="aakida_8h_html_a0b1bcf29bf5a39167d540cd3ee1ce0f8"><div class="ttname"><a href="akida_8h.html#a0b1bcf29bf5a39167d540cd3ee1ce0f8">init_akida</a></div><div class="ttdeci">bool init_akida(const uint8_t *model_arr, size_t model_arr_size, bool debug)</div><div class="ttdef"><b>Definition</b> akida.h:98</div></div>
<div class="ttc" id="aakida_8h_html_a0d0653d977a05dc75b9983c143d63cda"><div class="ttname"><a href="akida_8h.html#a0d0653d977a05dc75b9983c143d63cda">model_predict</a></div><div class="ttdeci">static py::object model_predict</div><div class="ttdef"><b>Definition</b> akida.h:81</div></div>
<div class="ttc" id="aakida_8h_html_a1d28dec57cce925ad92342891bd71e7c"><div class="ttname"><a href="akida_8h.html#a1d28dec57cce925ad92342891bd71e7c">scale</a></div><div class="ttdeci">static float scale</div><div class="ttdef"><b>Definition</b> akida.h:89</div></div>
<div class="ttc" id="aakida_8h_html_a25c6eab61238d97eb4aaef9fc6d1fa4e"><div class="ttname"><a href="akida_8h.html#a25c6eab61238d97eb4aaef9fc6d1fa4e">frequency</a></div><div class="ttdeci">matrix_t void const float frequency</div><div class="ttdef"><b>Definition</b> akida.h:542</div></div>
<div class="ttc" id="aakida_8h_html_a3658b236936f6ec57ce82f0fd8cbdabb"><div class="ttname"><a href="akida_8h.html#a3658b236936f6ec57ce82f0fd8cbdabb">config_ptr</a></div><div class="ttdeci">matrix_t void * config_ptr</div><div class="ttdef"><b>Definition</b> akida.h:542</div></div>
<div class="ttc" id="aakida_8h_html_a385b0bd18814f0f7ad3e2606c5f30f25"><div class="ttname"><a href="akida_8h.html#a385b0bd18814f0f7ad3e2606c5f30f25">engine_info</a></div><div class="ttdeci">std::stringstream engine_info</div><div class="ttdef"><b>Definition</b> akida.h:77</div></div>
<div class="ttc" id="aakida_8h_html_a3898ea656a9ba90bf49f93ba3906d1ee"><div class="ttname"><a href="akida_8h.html#a3898ea656a9ba90bf49f93ba3906d1ee">ei_config_tflite_graph_0</a></div><div class="ttdeci">ei_config_tflite_graph_t ei_config_tflite_graph_0</div><div class="ttdef"><b>Definition</b> akida.h:546</div></div>
<div class="ttc" id="aakida_8h_html_a52cd3949eba004f3b8791be094e50549"><div class="ttname"><a href="akida_8h.html#a52cd3949eba004f3b8791be094e50549">softmax_shape</a></div><div class="ttdeci">static tflite::RuntimeShape softmax_shape</div><div class="ttdef"><b>Definition</b> akida.h:86</div></div>
<div class="ttc" id="aakida_8h_html_a54eac5b77b39bd93efe5b92bbf779cd8"><div class="ttname"><a href="akida_8h.html#a54eac5b77b39bd93efe5b92bbf779cd8">EIDSP_OK</a></div><div class="ttdeci">return EIDSP_OK</div><div class="ttdef"><b>Definition</b> akida.h:573</div></div>
<div class="ttc" id="aakida_8h_html_a68b6b78623e05bae409754c3103e52be"><div class="ttname"><a href="akida_8h.html#a68b6b78623e05bae409754c3103e52be">model_forward</a></div><div class="ttdeci">static py::object model_forward</div><div class="ttdef"><b>Definition</b> akida.h:82</div></div>
<div class="ttc" id="aakida_8h_html_a78c6e19b13ec911a14929813c0e873a4"><div class="ttname"><a href="akida_8h.html#a78c6e19b13ec911a14929813c0e873a4">EI_CLASSIFIER_USE_AKIDA_HARDWARE_NO</a></div><div class="ttdeci">#define EI_CLASSIFIER_USE_AKIDA_HARDWARE_NO</div><div class="ttdoc">If more than one device is present in system setting this to device index can select a proper device....</div><div class="ttdef"><b>Definition</b> akida.h:44</div></div>
<div class="ttc" id="aakida_8h_html_a7b950177d9cb45e5c1ca09f7ff945deb"><div class="ttname"><a href="akida_8h.html#a7b950177d9cb45e5c1ca09f7ff945deb">model_input_bits</a></div><div class="ttdeci">static int model_input_bits</div><div class="ttdef"><b>Definition</b> akida.h:88</div></div>
<div class="ttc" id="aakida_8h_html_a85d5688f1dbc536dde02c237f84b5aa0"><div class="ttname"><a href="akida_8h.html#a85d5688f1dbc536dde02c237f84b5aa0">run_nn_inference_from_dsp</a></div><div class="ttdeci">EI_IMPULSE_ERROR run_nn_inference_from_dsp(ei_learning_block_config_tflite_graph_t *block_config, signal_t *signal, matrix_t *output_matrix)</div><div class="ttdef"><b>Definition</b> akida.h:500</div></div>
<div class="ttc" id="aakida_8h_html_a8d592742eb6381339c788d23b68712fc"><div class="ttname"><a href="akida_8h.html#a8d592742eb6381339c788d23b68712fc">ei_tflite_instances</a></div><div class="ttdeci">std::map&lt; uint32_t, ei_tflite_state_t * &gt; ei_tflite_instances</div><div class="ttdef"><b>Definition</b> akida.h:96</div></div>
<div class="ttc" id="aakida_8h_html_aa32eba6b3164559e24b544f632e08fb6"><div class="ttname"><a href="akida_8h.html#aa32eba6b3164559e24b544f632e08fb6">dummy_params</a></div><div class="ttdeci">static tflite::SoftmaxParams dummy_params</div><div class="ttdef"><b>Definition</b> akida.h:87</div></div>
<div class="ttc" id="aakida_8h_html_aac1b1c836ebe120022de348aaa277d27"><div class="ttname"><a href="akida_8h.html#aac1b1c836ebe120022de348aaa277d27">debug_print</a></div><div class="ttdeci">void debug_print(const std::vector&lt; T &gt; vec, const int val_per_row=3)</div><div class="ttdef"><b>Definition</b> akida.h:242</div></div>
<div class="ttc" id="aakida_8h_html_aac4d93b158d42bda5829a01a9c507312"><div class="ttname"><a href="akida_8h.html#aac4d93b158d42bda5829a01a9c507312">output_matrix</a></div><div class="ttdeci">matrix_t * output_matrix</div><div class="ttdef"><b>Definition</b> akida.h:542</div></div>
<div class="ttc" id="aakida_8h_html_aae63da0a007121c8192c17ac8be89a16"><div class="ttname"><a href="akida_8h.html#aae63da0a007121c8192c17ac8be89a16">model</a></div><div class="ttdeci">static py::object model</div><div class="ttdef"><b>Definition</b> akida.h:80</div></div>
<div class="ttc" id="aakida_8h_html_ab73668665ed1903aab8905ff035a33c5"><div class="ttname"><a href="akida_8h.html#ab73668665ed1903aab8905ff035a33c5">x</a></div><div class="ttdeci">auto x</div><div class="ttdef"><b>Definition</b> akida.h:568</div></div>
<div class="ttc" id="aakida_8h_html_ab7daefa6e7828a2d77c57f1b54404881"><div class="ttname"><a href="akida_8h.html#ab7daefa6e7828a2d77c57f1b54404881">ei_learning_block_config</a></div><div class="ttdeci">ei_learning_block_config_tflite_graph_t ei_learning_block_config</div><div class="ttdef"><b>Definition</b> akida.h:553</div></div>
<div class="ttc" id="aakida_8h_html_abe40c211ae00ce28964899acf497071b"><div class="ttname"><a href="akida_8h.html#abe40c211ae00ce28964899acf497071b">down_scale</a></div><div class="ttdeci">static int down_scale</div><div class="ttdef"><b>Definition</b> akida.h:90</div></div>
<div class="ttc" id="aakida_8h_html_ad3aeb8015fd4de80acbfcccbd480d4f9"><div class="ttname"><a href="akida_8h.html#ad3aeb8015fd4de80acbfcccbd480d4f9">akida</a></div><div class="ttdeci">static py::module_ akida</div><div class="ttdef"><b>Definition</b> akida.h:79</div></div>
<div class="ttc" id="aakida_8h_html_ad56ed4d147ee2780df7f469658e8dd67"><div class="ttname"><a href="akida_8h.html#ad56ed4d147ee2780df7f469658e8dd67">device</a></div><div class="ttdeci">static py::object device</div><div class="ttdef"><b>Definition</b> akida.h:83</div></div>
<div class="ttc" id="aakida_8h_html_ade70c8b8e08562c755284449a4aaae57"><div class="ttname"><a href="akida_8h.html#ade70c8b8e08562c755284449a4aaae57">get_interpreter</a></div><div class="ttdeci">static EI_IMPULSE_ERROR get_interpreter(ei_learning_block_config_tflite_graph_t *block_config, tflite::Interpreter **interpreter)</div><div class="ttdef"><b>Definition</b> akida.h:449</div></div>
<div class="ttc" id="aakida_8h_html_ae95031a834aea77650106530f566fdb5"><div class="ttname"><a href="akida_8h.html#ae95031a834aea77650106530f566fdb5">run_nn_inference</a></div><div class="ttdeci">EI_IMPULSE_ERROR run_nn_inference(const ei_impulse_t *impulse, ei_feature_t *fmatrix, uint32_t learn_block_index, uint32_t *input_block_ids, uint32_t input_block_ids_size, ei_impulse_result_t *result, void *config_ptr, bool debug)</div><div class="ttdoc">Do neural network inferencing over the processed feature matrix.</div><div class="ttdef"><b>Definition</b> akida.h:264</div></div>
<div class="ttc" id="aakida_8h_html_aeeaf5d523ee6a290407328d5e17fa721"><div class="ttname"><a href="akida_8h.html#aeeaf5d523ee6a290407328d5e17fa721">__attribute__</a></div><div class="ttdeci">__attribute__((unused)) int extract_tflite_features(signal_t *signal</div></div>
<div class="ttc" id="aakida_8h_html_af35d4fe88ce6a2e276c3ff3c542460ad"><div class="ttname"><a href="akida_8h.html#af35d4fe88ce6a2e276c3ff3c542460ad">akida_initialized</a></div><div class="ttdeci">static bool akida_initialized</div><div class="ttdef"><b>Definition</b> akida.h:84</div></div>
<div class="ttc" id="aclassei_1_1signal_html"><div class="ttname"><a href="classei_1_1signal.html">ei::signal</a></div><div class="ttdoc">Class for signal processing. tries to mimic scipy.signal.</div><div class="ttdef"><b>Definition</b> signal.hpp:45</div></div>
<div class="ttc" id="aclasstflite_1_1_micro_interpreter_html_a03736f71506229819aa4d7a79947add3"><div class="ttname"><a href="classtflite_1_1_micro_interpreter.html#a03736f71506229819aa4d7a79947add3">tflite::MicroInterpreter::output_tensor</a></div><div class="ttdeci">TfLiteTensor * output_tensor(size_t index)</div><div class="ttdef"><b>Definition</b> micro_interpreter.h:107</div></div>
<div class="ttc" id="aclasstflite_1_1_micro_interpreter_html_a2d76c06ba8d41944e185c3d330e3d554"><div class="ttname"><a href="classtflite_1_1_micro_interpreter.html#a2d76c06ba8d41944e185c3d330e3d554">tflite::MicroInterpreter::Invoke</a></div><div class="ttdeci">TfLiteStatus Invoke()</div><div class="ttdef"><b>Definition</b> micro_interpreter.cpp:273</div></div>
<div class="ttc" id="aclasstflite_1_1_micro_interpreter_html_ac9046fdf3b601b6cbbcdcd4e28ad165d"><div class="ttname"><a href="classtflite_1_1_micro_interpreter.html#ac9046fdf3b601b6cbbcdcd4e28ad165d">tflite::MicroInterpreter::input_tensor</a></div><div class="ttdeci">TfLiteTensor * input_tensor(size_t index)</div><div class="ttdef"><b>Definition</b> micro_interpreter.h:89</div></div>
<div class="ttc" id="aclasstflite_1_1_runtime_shape_html"><div class="ttname"><a href="classtflite_1_1_runtime_shape.html">tflite::RuntimeShape</a></div><div class="ttdef"><b>Definition</b> runtime_shape.h:26</div></div>
<div class="ttc" id="aei__classifier__porting_8h_html"><div class="ttname"><a href="ei__classifier__porting_8h.html">ei_classifier_porting.h</a></div></div>
<div class="ttc" id="aei__fill__result__struct_8h_html"><div class="ttname"><a href="ei__fill__result__struct_8h.html">ei_fill_result_struct.h</a></div></div>
<div class="ttc" id="aei__fill__result__struct_8h_html_a2fb43be102b153d659b668ad295aff40"><div class="ttname"><a href="ei__fill__result__struct_8h.html#a2fb43be102b153d659b668ad295aff40">EI_IMPULSE_OK</a></div><div class="ttdeci">return EI_IMPULSE_OK</div><div class="ttdef"><b>Definition</b> ei_fill_result_struct.h:230</div></div>
<div class="ttc" id="aei__fill__result__struct_8h_html_a881f62341b5a41a3c5707268bd537be1"><div class="ttname"><a href="ei__fill__result__struct_8h.html#a881f62341b5a41a3c5707268bd537be1">debug</a></div><div class="ttdeci">const ei_learning_block_config_tflite_graph_t ei_impulse_result_t float float float bool debug</div><div class="ttdef"><b>Definition</b> ei_fill_result_struct.h:281</div></div>
<div class="ttc" id="aei__fill__result__struct_8h_html_aafcd7d36638d6a564b6edbceef06ea8b"><div class="ttname"><a href="ei__fill__result__struct_8h.html#aafcd7d36638d6a564b6edbceef06ea8b">block_config</a></div><div class="ttdeci">const ei_learning_block_config_tflite_graph_t * block_config</div><div class="ttdef"><b>Definition</b> ei_fill_result_struct.h:205</div></div>
<div class="ttc" id="aei__model__types_8h_html"><div class="ttname"><a href="ei__model__types_8h.html">ei_model_types.h</a></div></div>
<div class="ttc" id="aei__model__types_8h_html_a67edebb42ed0ac73b3a4337ae07a281e"><div class="ttname"><a href="ei__model__types_8h.html#a67edebb42ed0ac73b3a4337ae07a281e">EI_CLASSIFIER_LAST_LAYER_UNKNOWN</a></div><div class="ttdeci">#define EI_CLASSIFIER_LAST_LAYER_UNKNOWN</div><div class="ttdef"><b>Definition</b> ei_model_types.h:60</div></div>
<div class="ttc" id="aei__model__types_8h_html_a76c13cf6c356590ec9aa183c25b90a5e"><div class="ttname"><a href="ei__model__types_8h.html#a76c13cf6c356590ec9aa183c25b90a5e">EI_CLASSIFIER_CLASSIFICATION_MODE_DSP</a></div><div class="ttdeci">#define EI_CLASSIFIER_CLASSIFICATION_MODE_DSP</div><div class="ttdef"><b>Definition</b> ei_model_types.h:87</div></div>
<div class="ttc" id="aei__model__types_8h_html_a92c64af4832fb183ad9e80b1e9231d41"><div class="ttname"><a href="ei__model__types_8h.html#a92c64af4832fb183ad9e80b1e9231d41">EI_CLASSIFIER_LAST_LAYER_SSD</a></div><div class="ttdeci">#define EI_CLASSIFIER_LAST_LAYER_SSD</div><div class="ttdef"><b>Definition</b> ei_model_types.h:61</div></div>
<div class="ttc" id="aei__model__types_8h_html_ab706b8178a13309b0906763696334f45"><div class="ttname"><a href="ei__model__types_8h.html#ab706b8178a13309b0906763696334f45">EI_CLASSIFIER_LAST_LAYER_YOLOV5</a></div><div class="ttdeci">#define EI_CLASSIFIER_LAST_LAYER_YOLOV5</div><div class="ttdef"><b>Definition</b> ei_model_types.h:63</div></div>
<div class="ttc" id="aei__model__types_8h_html_ac1b68c7b64d1c0040288b01023b1efc4"><div class="ttname"><a href="ei__model__types_8h.html#ac1b68c7b64d1c0040288b01023b1efc4">EI_CLASSIFIER_LAST_LAYER_YOLOV2</a></div><div class="ttdeci">#define EI_CLASSIFIER_LAST_LAYER_YOLOV2</div><div class="ttdef"><b>Definition</b> ei_model_types.h:71</div></div>
<div class="ttc" id="aei__model__types_8h_html_ae9f473b0f3438b846c2c12ab84338858"><div class="ttname"><a href="ei__model__types_8h.html#ae9f473b0f3438b846c2c12ab84338858">EI_CLASSIFIER_LAST_LAYER_FOMO</a></div><div class="ttdeci">#define EI_CLASSIFIER_LAST_LAYER_FOMO</div><div class="ttdef"><b>Definition</b> ei_model_types.h:62</div></div>
<div class="ttc" id="aei__run__classifier_8h_html_adda641ea28ba092cca93ceb401fe0807"><div class="ttname"><a href="ei__run__classifier_8h.html#adda641ea28ba092cca93ceb401fe0807">ei_printf</a></div><div class="ttdeci">result timing dsp_us ei_printf_float((float) result-&gt;timing.dsp_us/1000) ei_printf(&quot; ms., Classification: &quot;)</div></div>
<div class="ttc" id="aengines_8h_html_a335f8f33ce6e68893a2f4f7915e54cd4"><div class="ttname"><a href="engines_8h.html#a335f8f33ce6e68893a2f4f7915e54cd4">extract_tflite_features</a></div><div class="ttdeci">int extract_tflite_features(ei::signal_t *signal, ei::matrix_t *output_matrix, void *config_ptr, const float frequency)</div></div>
<div class="ttc" id="agroup__ei__functions_html_gaf4ad914acba713176b1f00a800e781ba"><div class="ttname"><a href="group__ei__functions.html#gaf4ad914acba713176b1f00a800e781ba">result</a></div><div class="ttdeci">const ei_learning_block_config_tflite_graph_t ei_impulse_result_t * result</div><div class="ttdef"><b>Definition</b> ei_fill_result_struct.h:206</div></div>
<div class="ttc" id="agroup__ei__returntypes_html_gad9580b47a6cd5e74cfc31a03bdfecebe"><div class="ttname"><a href="group__ei__returntypes.html#gad9580b47a6cd5e74cfc31a03bdfecebe">EI_IMPULSE_ERROR</a></div><div class="ttdeci">EI_IMPULSE_ERROR</div><div class="ttdef"><b>Definition</b> returntypes.h:48</div></div>
<div class="ttc" id="agroup__ei__returntypes_html_ggad9580b47a6cd5e74cfc31a03bdfecebea044ed37f0ac423223909460bad7850b4"><div class="ttname"><a href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebea044ed37f0ac423223909460bad7850b4">EI_IMPULSE_OUTPUT_TENSOR_WAS_NULL</a></div><div class="ttdeci">@ EI_IMPULSE_OUTPUT_TENSOR_WAS_NULL</div><div class="ttdef"><b>Definition</b> returntypes.h:61</div></div>
<div class="ttc" id="agroup__ei__returntypes_html_ggad9580b47a6cd5e74cfc31a03bdfecebea1137b5ef30c8f5241a42877876e3fcd9"><div class="ttname"><a href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebea1137b5ef30c8f5241a42877876e3fcd9">EI_IMPULSE_AKIDA_ERROR</a></div><div class="ttdeci">@ EI_IMPULSE_AKIDA_ERROR</div><div class="ttdef"><b>Definition</b> returntypes.h:70</div></div>
<div class="ttc" id="agroup__ei__returntypes_html_ggad9580b47a6cd5e74cfc31a03bdfecebea399c371041be7c468a3b05a4d8352d14"><div class="ttname"><a href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebea399c371041be7c468a3b05a4d8352d14">EI_IMPULSE_UNSUPPORTED_INFERENCING_ENGINE</a></div><div class="ttdeci">@ EI_IMPULSE_UNSUPPORTED_INFERENCING_ENGINE</div><div class="ttdef"><b>Definition</b> returntypes.h:58</div></div>
<div class="ttc" id="agroup__ei__returntypes_html_ggad9580b47a6cd5e74cfc31a03bdfecebeab011336593a9cc40639bac0c8a32a51e"><div class="ttname"><a href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebeab011336593a9cc40639bac0c8a32a51e">EI_IMPULSE_INVALID_SIZE</a></div><div class="ttdeci">@ EI_IMPULSE_INVALID_SIZE</div><div class="ttdef"><b>Definition</b> returntypes.h:71</div></div>
<div class="ttc" id="agroup__ei__returntypes_html_ggad9580b47a6cd5e74cfc31a03bdfecebeadcc41afc4542dc94f9dcf36d88c1ea31"><div class="ttname"><a href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebeadcc41afc4542dc94f9dcf36d88c1ea31">EI_IMPULSE_TFLITE_ERROR</a></div><div class="ttdeci">@ EI_IMPULSE_TFLITE_ERROR</div><div class="ttdef"><b>Definition</b> returntypes.h:52</div></div>
<div class="ttc" id="agroup__ei__returntypes_html_ggad9580b47a6cd5e74cfc31a03bdfecebeaffedb491b7409e8e885e1ab4abebaeeb"><div class="ttname"><a href="group__ei__returntypes.html#ggad9580b47a6cd5e74cfc31a03bdfecebeaffedb491b7409e8e885e1ab4abebaeeb">EI_IMPULSE_INPUT_TENSOR_WAS_NULL</a></div><div class="ttdeci">@ EI_IMPULSE_INPUT_TENSOR_WAS_NULL</div><div class="ttdef"><b>Definition</b> returntypes.h:60</div></div>
<div class="ttc" id="agroup__ei__user__functions_html_gac9aae7befaa896e21417df1f00518416"><div class="ttname"><a href="group__ei__user__functions.html#gac9aae7befaa896e21417df1f00518416">ei_read_timer_us</a></div><div class="ttdeci">uint64_t ei_read_timer_us()</div><div class="ttdoc">Read the microsecond timer.</div></div>
<div class="ttc" id="akernels_2custom_2tree__ensemble__classifier_8h_html"><div class="ttname"><a href="kernels_2custom_2tree__ensemble__classifier_8h.html">tree_ensemble_classifier.h</a></div></div>
<div class="ttc" id="amodel__metadata_8h_html"><div class="ttname"><a href="model__metadata_8h.html">model_metadata.h</a></div></div>
<div class="ttc" id="anamespacetflite_1_1ops_1_1custom_html_a07a3b1e549c28600dbaf71e6fe38f3f7"><div class="ttname"><a href="namespacetflite_1_1ops_1_1custom.html#a07a3b1e549c28600dbaf71e6fe38f3f7">tflite::ops::custom::Register_TREE_ENSEMBLE_CLASSIFIER</a></div><div class="ttdeci">TfLiteRegistration * Register_TREE_ENSEMBLE_CLASSIFIER()</div><div class="ttdef"><b>Definition</b> tree_ensemble_classifier.cpp:173</div></div>
<div class="ttc" id="anamespacetflite_1_1reference__ops_html_ae06af6ac80f340cc1edfb85fc6f72633"><div class="ttname"><a href="namespacetflite_1_1reference__ops.html#ae06af6ac80f340cc1edfb85fc6f72633">tflite::reference_ops::Softmax</a></div><div class="ttdeci">void Softmax(const SoftmaxParams &amp;params, const RuntimeShape &amp;input_shape, const float *input_data, const RuntimeShape &amp;output_shape, float *output_data)</div><div class="ttdef"><b>Definition</b> softmax.h:31</div></div>
<div class="ttc" id="anicla__sense__fusion_8ino_html_ae6219c1117781a1dbbb7839946bca32c"><div class="ttname"><a href="nicla__sense__fusion_8ino.html#ae6219c1117781a1dbbb7839946bca32c">temp</a></div><div class="ttdeci">Sensor temp(SENSOR_ID_TEMP)</div></div>
<div class="ttc" id="astruct_tf_lite_tensor_html"><div class="ttname"><a href="struct_tf_lite_tensor.html">TfLiteTensor</a></div><div class="ttdef"><b>Definition</b> common.h:411</div></div>
<div class="ttc" id="astructei__config__tflite__graph__t_html"><div class="ttname"><a href="structei__config__tflite__graph__t.html">ei_config_tflite_graph_t</a></div><div class="ttdef"><b>Definition</b> ei_model_types.h:174</div></div>
<div class="ttc" id="astructei__config__tflite__graph__t_html_ac0f014d6d63f118b2dfe9f43c84ebd71"><div class="ttname"><a href="structei__config__tflite__graph__t.html#ac0f014d6d63f118b2dfe9f43c84ebd71">ei_config_tflite_graph_t::model_size</a></div><div class="ttdeci">size_t model_size</div><div class="ttdef"><b>Definition</b> ei_model_types.h:177</div></div>
<div class="ttc" id="astructei__config__tflite__graph__t_html_adb1b1d255db9be3eb16c0d680ae9de50"><div class="ttname"><a href="structei__config__tflite__graph__t.html#adb1b1d255db9be3eb16c0d680ae9de50">ei_config_tflite_graph_t::model</a></div><div class="ttdeci">const unsigned char * model</div><div class="ttdef"><b>Definition</b> ei_model_types.h:176</div></div>
<div class="ttc" id="astructei__dsp__config__tflite__t_html"><div class="ttname"><a href="structei__dsp__config__tflite__t.html">ei_dsp_config_tflite_t</a></div><div class="ttdef"><b>Definition</b> ei_model_types.h:368</div></div>
<div class="ttc" id="astructei__dsp__config__tflite__t_html_a0990565bb857f0ddf54125a7c27bcf12"><div class="ttname"><a href="structei__dsp__config__tflite__t.html#a0990565bb857f0ddf54125a7c27bcf12">ei_dsp_config_tflite_t::model_size</a></div><div class="ttdeci">size_t model_size</div><div class="ttdef"><b>Definition</b> ei_model_types.h:373</div></div>
<div class="ttc" id="astructei__dsp__config__tflite__t_html_a123eb13b7717010c84bc6e29a45b573b"><div class="ttname"><a href="structei__dsp__config__tflite__t.html#a123eb13b7717010c84bc6e29a45b573b">ei_dsp_config_tflite_t::model</a></div><div class="ttdeci">const unsigned char * model</div><div class="ttdef"><b>Definition</b> ei_model_types.h:372</div></div>
<div class="ttc" id="astructei__dsp__config__tflite__t_html_a1a887092369ac7fba59caaf55788a814"><div class="ttname"><a href="structei__dsp__config__tflite__t.html#a1a887092369ac7fba59caaf55788a814">ei_dsp_config_tflite_t::arena_size</a></div><div class="ttdeci">size_t arena_size</div><div class="ttdef"><b>Definition</b> ei_model_types.h:374</div></div>
<div class="ttc" id="astructei__dsp__config__tflite__t_html_a301036544ec7e6b7a09ee37be2ac720d"><div class="ttname"><a href="structei__dsp__config__tflite__t.html#a301036544ec7e6b7a09ee37be2ac720d">ei_dsp_config_tflite_t::block_id</a></div><div class="ttdeci">uint32_t block_id</div><div class="ttdef"><b>Definition</b> ei_model_types.h:369</div></div>
<div class="ttc" id="astructei__feature__t_html"><div class="ttname"><a href="structei__feature__t.html">ei_feature_t</a></div><div class="ttdef"><b>Definition</b> ei_model_types.h:96</div></div>
<div class="ttc" id="astructei__feature__t_html_a971fb9c93bddb4631925e579f5b88ebf"><div class="ttname"><a href="structei__feature__t.html#a971fb9c93bddb4631925e579f5b88ebf">ei_feature_t::matrix</a></div><div class="ttdeci">ei::matrix_t * matrix</div><div class="ttdef"><b>Definition</b> ei_model_types.h:97</div></div>
<div class="ttc" id="astructei__impulse__result__t_html"><div class="ttname"><a href="structei__impulse__result__t.html">ei_impulse_result_t</a></div><div class="ttdoc">Holds the output of inference, anomaly results, and timing information.</div><div class="ttdef"><b>Definition</b> ei_classifier_types.h:233</div></div>
<div class="ttc" id="astructei__impulse_html"><div class="ttname"><a href="structei__impulse.html">ei_impulse</a></div><div class="ttdef"><b>Definition</b> ei_model_types.h:250</div></div>
<div class="ttc" id="astructei__impulse_html_a4dd1368c2ed2a4e899274669e81417e4"><div class="ttname"><a href="structei__impulse.html#a4dd1368c2ed2a4e899274669e81417e4">ei_impulse::tflite_output_features_count</a></div><div class="ttdeci">uint32_t tflite_output_features_count</div><div class="ttdef"><b>Definition</b> ei_model_types.h:277</div></div>
<div class="ttc" id="astructei__impulse_html_a51d2390841b11688a861c16753380c15"><div class="ttname"><a href="structei__impulse.html#a51d2390841b11688a861c16753380c15">ei_impulse::fomo_output_size</a></div><div class="ttdeci">uint32_t fomo_output_size</div><div class="ttdef"><b>Definition</b> ei_model_types.h:274</div></div>
<div class="ttc" id="astructei__impulse_html_a686152786fe6f16b174bfecfe01308a9"><div class="ttname"><a href="structei__impulse.html#a686152786fe6f16b174bfecfe01308a9">ei_impulse::learning_blocks_size</a></div><div class="ttdeci">const uint8_t learning_blocks_size</div><div class="ttdef"><b>Definition</b> ei_model_types.h:280</div></div>
<div class="ttc" id="astructei__impulse_html_aab279e170490f9b5c0c59eff0b6fa484"><div class="ttname"><a href="structei__impulse.html#aab279e170490f9b5c0c59eff0b6fa484">ei_impulse::dsp_blocks_size</a></div><div class="ttdeci">uint8_t dsp_blocks_size</div><div class="ttdef"><b>Definition</b> ei_model_types.h:269</div></div>
<div class="ttc" id="astructei__learning__block__config__tflite__graph__t_html"><div class="ttname"><a href="structei__learning__block__config__tflite__graph__t.html">ei_learning_block_config_tflite_graph_t</a></div><div class="ttdef"><b>Definition</b> ei_model_types.h:205</div></div>
<div class="ttc" id="astructei__learning__block__config__tflite__graph__t_html_a42210921fb4db239d6b53c0409f6e5d9"><div class="ttname"><a href="structei__learning__block__config__tflite__graph__t.html#a42210921fb4db239d6b53c0409f6e5d9">ei_learning_block_config_tflite_graph_t::graph_config</a></div><div class="ttdeci">void * graph_config</div><div class="ttdef"><b>Definition</b> ei_model_types.h:221</div></div>
<div class="ttc" id="astructei__learning__block__config__tflite__graph__t_html_a7c304bc1ccb9ff5e2b8155b5f77c91df"><div class="ttname"><a href="structei__learning__block__config__tflite__graph__t.html#a7c304bc1ccb9ff5e2b8155b5f77c91df">ei_learning_block_config_tflite_graph_t::block_id</a></div><div class="ttdeci">uint32_t block_id</div><div class="ttdef"><b>Definition</b> ei_model_types.h:208</div></div>
<div class="ttc" id="astructei__learning__block__config__tflite__graph__t_html_a9f1d65f69c49cecaddb6b6abb65644ef"><div class="ttname"><a href="structei__learning__block__config__tflite__graph__t.html#a9f1d65f69c49cecaddb6b6abb65644ef">ei_learning_block_config_tflite_graph_t::object_detection_last_layer</a></div><div class="ttdeci">int8_t object_detection_last_layer</div><div class="ttdef"><b>Definition</b> ei_model_types.h:211</div></div>
<div class="ttc" id="astructei__learning__block__config__tflite__graph__t_html_af1a9b7c47a826887609d831078ccbdbc"><div class="ttname"><a href="structei__learning__block__config__tflite__graph__t.html#af1a9b7c47a826887609d831078ccbdbc">ei_learning_block_config_tflite_graph_t::object_detection</a></div><div class="ttdeci">bool object_detection</div><div class="ttdef"><b>Definition</b> ei_model_types.h:210</div></div>
<div class="ttc" id="astructei__matrix_html"><div class="ttname"><a href="structei__matrix.html">ei_matrix</a></div><div class="ttdef"><b>Definition</b> numpy_types.h:69</div></div>
<div class="ttc" id="astructei__signal__t_html"><div class="ttname"><a href="structei__signal__t.html">ei_signal_t</a></div><div class="ttdoc">Holds the callback pointer for retrieving raw data and the length of data to be retrieved.</div><div class="ttdef"><b>Definition</b> numpy_types.h:603</div></div>
<div class="ttc" id="astructei__tflite__state__t_html"><div class="ttname"><a href="structei__tflite__state__t.html">ei_tflite_state_t</a></div><div class="ttdef"><b>Definition</b> akida.h:91</div></div>
<div class="ttc" id="astructei__tflite__state__t_html_a2a718661b2d6a6d38d0fe7d29cef2bb7"><div class="ttname"><a href="structei__tflite__state__t.html#a2a718661b2d6a6d38d0fe7d29cef2bb7">ei_tflite_state_t::model</a></div><div class="ttdeci">std::unique_ptr&lt; tflite::FlatBufferModel &gt; model</div><div class="ttdef"><b>Definition</b> akida.h:92</div></div>
<div class="ttc" id="astructei__tflite__state__t_html_af2d64469ee7ca0b7755ecf866d9880fc"><div class="ttname"><a href="structei__tflite__state__t.html#af2d64469ee7ca0b7755ecf866d9880fc">ei_tflite_state_t::interpreter</a></div><div class="ttdeci">std::unique_ptr&lt; tflite::Interpreter &gt; interpreter</div><div class="ttdef"><b>Definition</b> akida.h:93</div></div>
<div class="ttc" id="astructtflite_1_1_softmax_params_html"><div class="ttname"><a href="structtflite_1_1_softmax_params.html">tflite::SoftmaxParams</a></div><div class="ttdef"><b>Definition</b> types.h:926</div></div>
<div class="ttc" id="astructtflite_1_1_softmax_params_html_a8003007436aab20a1b265453c462067f"><div class="ttname"><a href="structtflite_1_1_softmax_params.html#a8003007436aab20a1b265453c462067f">tflite::SoftmaxParams::beta</a></div><div class="ttdeci">double beta</div><div class="ttdef"><b>Definition</b> types.h:929</div></div>
<div class="ttc" id="atflite__helper_8h_html"><div class="ttname"><a href="tflite__helper_8h.html">tflite_helper.h</a></div></div>
<div class="ttc" id="atflite__helper_8h_html_a055a4032becfb6fe674cae7cd44a30e4"><div class="ttname"><a href="tflite__helper_8h.html#a055a4032becfb6fe674cae7cd44a30e4">fill_input_tensor_from_signal</a></div><div class="ttdeci">EI_IMPULSE_ERROR fill_input_tensor_from_signal(signal_t *signal, TfLiteTensor *input)</div><div class="ttdef"><b>Definition</b> tflite_helper.h:103</div></div>
<div class="ttc" id="atflite__helper_8h_html_a9e3b34d1ab6e54f17b2064eb046b0f1c"><div class="ttname"><a href="tflite__helper_8h.html#a9e3b34d1ab6e54f17b2064eb046b0f1c">fill_output_matrix_from_tensor</a></div><div class="ttdeci">EI_IMPULSE_ERROR fill_output_matrix_from_tensor(TfLiteTensor *output, matrix_t *output_matrix)</div><div class="ttdef"><b>Definition</b> tflite_helper.h:226</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
