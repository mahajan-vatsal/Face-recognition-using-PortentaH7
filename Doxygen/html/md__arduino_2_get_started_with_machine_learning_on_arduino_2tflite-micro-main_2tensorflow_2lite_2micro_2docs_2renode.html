<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Machine Vision using Portenta H7: renode</title>
<link rel="icon" href="logo.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Machine Vision using Portenta H7<span id="projectnumber">&#160;2</span>
   </div>
   <div id="projectbrief">This project aims to develop a face recognition-based access control system using the Arduino Portenta H7 and Vision Shield, leveraging Edge Impulse for machine learning. The system captures facial images, processes them locally using an AI model deployed on the Portenta H7 and determines access based on authorised personnel.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">renode</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li>Software Emulation with Renode</li>
<li>Installation</li>
<li>Running Unit Tests<ul>
<li>Under the hood of the Testing Infrastructure</li>
</ul>
</li>
<li>Running a non-test Binary with Renode</li>
<li>Useful External Links for Renode and Robot Documentation</li>
</ul>
<h1><a class="anchor" id="autotoc_md225"></a>
Software Emulation with Renode</h1>
<p>TensorFlow Lite Micro makes use of <a href="https://github.com/renode/renode">Renode</a> to for software emulation.</p>
<p>Here, we document how Renode is used as part of the TFLM project. For more general use of Renode, please refer to the <a href="https://renode.readthedocs.io/en/latest/">Renode documentation</a>.</p>
<p>You can also read more about Renode from a <a href="https://docs.google.com/presentation/d/1j0gjI4pVkgF9CWvxaxr5XuCKakEB25YX2n-iFxlYKnE/edit">publicly available slide deck</a>.</p>
<h1><a class="anchor" id="autotoc_md226"></a>
Installation</h1>
<p>Renode can be installed and used in a variety of ways, as documented in the <a href="https://github.com/renode/renode/blob/master/README.rst#installation/">Renode README</a>. For the purpose of Tensorflow Lite Micro, we make use of the portable version for Linux.</p>
<p>Portable renode will be automatically installed when using the TfLite Micro Makefile to <code>tensorflow/lite/micro/tools/make/downloads/renode</code>.</p>
<p>The Makefile internally calls the <code>renode_download.sh</code> script:</p>
<div class="fragment"><div class="line">tensorflow/lite/micro/tools/make/renode_download.sh tensorflow/lite/micro/tools/make/downloads</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md227"></a>
Running Unit Tests</h1>
<p>All the tests for a specific platform (e.g. bluepill) can be run with:</p>
<div class="fragment"><div class="line">make -f tensorflow/lite/micro/tools/make/Makefile TARGET=bluepill test</div>
</div><!-- fragment --><ul>
<li>This makes use of the robot framework from Renode.</li>
<li>Note that the tests can currently not be run in parallel.</li>
<li>It takes about 25 second to complete all tests, including around 3 seconds for suite startup/teardown and average 0.38 second per test.</li>
</ul>
<h2><a class="anchor" id="autotoc_md228"></a>
Under the hood of the Testing Infrastructure</h2>
<p>Describe how we wait for a particular string on the UART. Some pointers into the robot files as well as any relevant documentation from Renode.</p>
<p>A test failure is the absence of a specific string on the UART so the test will wait for a specific timeout period (configured in the .robot) file before failing.</p>
<ul>
<li>What this means in practice is that a failing test will take longer to finish than a test that passes.</li>
<li>If needed, an optimization on this would be to have a specific failure message as well so that both success and failure can be detected quickly.</li>
</ul>
<h1><a class="anchor" id="autotoc_md229"></a>
Running a non-test Binary with Renode</h1>
<p>Renode can also be used to run and debug binaries interactively. For example, to debug <code>kernel_addr_test</code> on Bluepill platform, run Renode:</p>
<div class="fragment"><div class="line">tensorflow/lite/micro/tools/make/downloads/renode/renode</div>
</div><!-- fragment --><p> and issue following commands: </p><div class="fragment"><div class="line"># Create platform</div>
<div class="line">include @tensorflow/lite/micro/testing/bluepill_nontest.resc</div>
<div class="line"># Load ELF file</div>
<div class="line">sysbus LoadELF @gen/bluepill_x86_64_default/bin/kernel_add_test</div>
<div class="line"># Start simulation</div>
<div class="line">start</div>
<div class="line"> </div>
<div class="line"># To run again:</div>
<div class="line">Clear</div>
<div class="line">include @tensorflow/lite/micro/testing/bluepill_nontest.resc</div>
<div class="line">sysbus LoadELF @gen/bluepill_cortex-m3_default/bin/keyword_benchmark</div>
<div class="line">start</div>
</div><!-- fragment --><p>To make repeat runs a bit easier, you can put all the commands into a single line (up arrow will show the last command in the Renode terminal): </p><div class="fragment"><div class="line">Clear; include @tensorflow/lite/micro/testing/bluepill_nontest.resc; sysbus LoadELF @gen/bluepill_x86_64_default/bin/kernel_add_test; start</div>
</div><!-- fragment --><p>You can also connect GDB to the simulation. To do that, start the GDB server in Renode before issuing the <code>start</code> command: </p><div class="fragment"><div class="line">machine StartGdbServer 3333</div>
</div><!-- fragment --><p> Than you can connect from GDB with: </p><div class="fragment"><div class="line">target remote localhost:3333</div>
</div><!-- fragment --><p>For further reference please see the <a href="https://renode.readthedocs.io/en/latest/">Renode documentation</a>.</p>
<h1><a class="anchor" id="autotoc_md230"></a>
Useful External Links for Renode and Robot Documentation</h1>
<ul>
<li><a href="https://renode.readthedocs.io/en/latest/introduction/testing.html?highlight=robot#running-the-robot-test-script">Testing with Renode</a></li>
<li><a href="https://github.com/robotframework/robotframework">Robot Testing Framework on Github</a>. For someone new to the Robot Framework, the documentation can be a bit hard to navigate, so here are some links that are relevant to the use of the Robot Framework with Renode for TFLM:<ul>
<li><a href="http://robotframework.org/robotframework/latest/RobotFrameworkUserGuide.html#creating-test-data">Creating Test Data</a> section of the user guide.</li>
<li>Renode-specific additions to the Robot test description format are in the <a href="https://github.com/renode/renode/tree/master/src/Renode/RobotFrameworkEngine">RobotFrameworkEngine directory</a>. For example,<ul>
<li><a href="https://github.com/renode/renode/blob/master/src/Renode/RobotFrameworkEngine/RenodeKeywords.cs#L41-L42">Start Emulation</a></li>
<li><a href="https://github.com/renode/renode/blob/master/src/Renode/RobotFrameworkEngine/UartKeywords.cs#L62-L63">Wait For Line On Uart</a> is where <code>Wait For Line On Uart</code> is defined.</li>
</ul>
</li>
<li>Some documentation for all the <a href="http://robotframework.org/robotframework/#standard-libraries">Standard Libraries</a> that define commands such as:<ul>
<li><a href="http://robotframework.org/robotframework/latest/libraries/OperatingSystem.html#Remove%20File">Remove File</a></li>
<li><a href="https://robotframework.org/robotframework/latest/libraries/OperatingSystem.html#List%20Files%20In%20Directory">List Files In Directory</a> </li>
</ul>
</li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
