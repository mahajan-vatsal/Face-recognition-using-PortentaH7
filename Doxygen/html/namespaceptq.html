<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Machine Vision using Portenta H7: ptq Namespace Reference</title>
<link rel="icon" href="logo.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Machine Vision using Portenta H7<span id="projectnumber">&#160;2</span>
   </div>
   <div id="projectbrief">This project aims to develop a face recognition-based access control system using the Arduino Portenta H7 and Vision Shield, leveraging Edge Impulse for machine learning. The system captures facial images, processes them locally using an AI model deployed on the Portenta H7 and determines access based on authorised personnel.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">ptq Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa6a66664483cdc07845315fd4dc53343" id="r_aa6a66664483cdc07845315fd4dc53343"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa6a66664483cdc07845315fd4dc53343">get_data</a> ()</td></tr>
<tr class="separator:aa6a66664483cdc07845315fd4dc53343"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c7b0c4a4469e2b0b0b6dd61c135a396" id="r_a6c7b0c4a4469e2b0b0b6dd61c135a396"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6c7b0c4a4469e2b0b0b6dd61c135a396">save_tflite_model</a> (tflite_model, target_dir, model_name)</td></tr>
<tr class="separator:a6c7b0c4a4469e2b0b0b6dd61c135a396"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae5a8479c62473e5e3022e2e9af0823c" id="r_aae5a8479c62473e5e3022e2e9af0823c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aae5a8479c62473e5e3022e2e9af0823c">convert_quantized_tflite_model</a> (source_model_dir, x_values)</td></tr>
<tr class="separator:aae5a8479c62473e5e3022e2e9af0823c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a055e2902a3dd58337de27a334b7cac4f" id="r_a055e2902a3dd58337de27a334b7cac4f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a055e2902a3dd58337de27a334b7cac4f">main</a> (_)</td></tr>
<tr class="separator:a055e2902a3dd58337de27a334b7cac4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a01a1b2db5fb96a7dcc24cc72b5a987a8" id="r_a01a1b2db5fb96a7dcc24cc72b5a987a8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a01a1b2db5fb96a7dcc24cc72b5a987a8">FLAGS</a> = flags.FLAGS</td></tr>
<tr class="separator:a01a1b2db5fb96a7dcc24cc72b5a987a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">This script can create a quant(int8) model from the saved TF model.

Run:
Build the train.py script
`bazel build tensorflow/lite/micro/examples/hello_world/quantization:train`

The following command first creates the trained TF float model that we will quantize later
`bazel-bin/tensorflow/lite/micro/examples/hello_world/train --save_tf_model --save_dir=/tmp/float_model/`

Build the ptq.py script
`bazel build tensorflow/lite/micro/examples/hello_world/quantization:ptq`

Then we can run the ptq script to convert the float model to quant model as follows.
Note that we are using the directory of the TF model as the source_model_dir here.
The quant model (named hello_world_int8.tflite) will be created inside the target_dir.
`bazel-bin/tensorflow/lite/micro/examples/hello_world/quantization/ptq  --source_model_dir=/tmp/float_model --target_dir=/tmp/quant_model/`
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="aae5a8479c62473e5e3022e2e9af0823c" name="aae5a8479c62473e5e3022e2e9af0823c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae5a8479c62473e5e3022e2e9af0823c">&#9670;&#160;</a></span>convert_quantized_tflite_model()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ptq.convert_quantized_tflite_model </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>source_model_dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>x_values</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert the save TF model to tflite model, then save it as .tflite
  flatbuffer format

  Args:
      source_model_dir (tf.keras.Model): the trained hello_world flaot Model dir
      x_train (numpy.array): list of the training data

  Returns:
      The converted model in serialized format.
</pre> 
</div>
</div>
<a id="aa6a66664483cdc07845315fd4dc53343" name="aa6a66664483cdc07845315fd4dc53343"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6a66664483cdc07845315fd4dc53343">&#9670;&#160;</a></span>get_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ptq.get_data </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">The code will generate a set of random `x` values
</pre> 
</div>
</div>
<a id="a055e2902a3dd58337de27a334b7cac4f" name="a055e2902a3dd58337de27a334b7cac4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a055e2902a3dd58337de27a334b7cac4f">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ptq.main </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>_</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6c7b0c4a4469e2b0b0b6dd61c135a396" name="a6c7b0c4a4469e2b0b0b6dd61c135a396"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c7b0c4a4469e2b0b0b6dd61c135a396">&#9670;&#160;</a></span>save_tflite_model()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ptq.save_tflite_model </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>tflite_model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>target_dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>model_name</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">save the converted tflite model
Args:
    tflite_model (binary): the converted model in serialized format.
    save_dir (str): the save directory
    model_name (str): model name to be saved
</pre> 
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a01a1b2db5fb96a7dcc24cc72b5a987a8" name="a01a1b2db5fb96a7dcc24cc72b5a987a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01a1b2db5fb96a7dcc24cc72b5a987a8">&#9670;&#160;</a></span>FLAGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ptq.FLAGS = flags.FLAGS</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
