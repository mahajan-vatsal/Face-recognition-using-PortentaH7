<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Machine Vision using Portenta H7: train Namespace Reference</title>
<link rel="icon" href="logo.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Machine Vision using Portenta H7<span id="projectnumber">&#160;2</span>
   </div>
   <div id="projectbrief">This project aims to develop a face recognition-based access control system using the Arduino Portenta H7 and Vision Shield, leveraging Edge Impulse for machine learning. The system captures facial images, processes them locally using an AI model deployed on the Portenta H7 and determines access based on authorised personnel.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">train Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a03f8f9005bafb1842f04b550ede32fa9" id="r_a03f8f9005bafb1842f04b550ede32fa9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a03f8f9005bafb1842f04b550ede32fa9">get_data</a> ()</td></tr>
<tr class="separator:a03f8f9005bafb1842f04b550ede32fa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ef03f7932b3a3678637c4ff58516b55" id="r_a8ef03f7932b3a3678637c4ff58516b55"><td class="memItemLeft" align="right" valign="top">tf.keras.Model&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8ef03f7932b3a3678637c4ff58516b55">create_model</a> ()</td></tr>
<tr class="separator:a8ef03f7932b3a3678637c4ff58516b55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b2a0229e836037b5d6f724d951a8bcc" id="r_a1b2a0229e836037b5d6f724d951a8bcc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1b2a0229e836037b5d6f724d951a8bcc">convert_tflite_model</a> (<a class="el" href="_arduino_2_get_started_with_machine_learning_on_arduino_2model_8h.html#ae142afd8c2e2c711c1c62440deebe03c">model</a>)</td></tr>
<tr class="separator:a1b2a0229e836037b5d6f724d951a8bcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0c146b0ee08b9c4f6449dbdf9cfb7a1" id="r_ab0c146b0ee08b9c4f6449dbdf9cfb7a1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab0c146b0ee08b9c4f6449dbdf9cfb7a1">save_tflite_model</a> (tflite_model, save_dir, model_name)</td></tr>
<tr class="separator:ab0c146b0ee08b9c4f6449dbdf9cfb7a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ef1ead644fe16c7ffb1c336953712af" id="r_a9ef1ead644fe16c7ffb1c336953712af"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9ef1ead644fe16c7ffb1c336953712af">train_model</a> (epochs, x_values, y_values)</td></tr>
<tr class="separator:a9ef1ead644fe16c7ffb1c336953712af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97731a176b4d14d8a1849221857402f5" id="r_a97731a176b4d14d8a1849221857402f5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a97731a176b4d14d8a1849221857402f5">main</a> (_)</td></tr>
<tr class="separator:a97731a176b4d14d8a1849221857402f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2526ff2eeca1a68ab0d9f57b58baeb9" id="r_ab2526ff2eeca1a68ab0d9f57b58baeb9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab2526ff2eeca1a68ab0d9f57b58baeb9">create_model</a> (units=20)</td></tr>
<tr class="separator:ab2526ff2eeca1a68ab0d9f57b58baeb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd913e867e7114d2bd578d5ddb485ea3" id="r_acd913e867e7114d2bd578d5ddb485ea3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acd913e867e7114d2bd578d5ddb485ea3">get_train_data</a> ()</td></tr>
<tr class="separator:acd913e867e7114d2bd578d5ddb485ea3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30c23e7d8d9adfbbd06e337d861f5d58" id="r_a30c23e7d8d9adfbbd06e337d861f5d58"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a30c23e7d8d9adfbbd06e337d861f5d58">train_lstm_model</a> (epochs, x_train, y_train)</td></tr>
<tr class="separator:a30c23e7d8d9adfbbd06e337d861f5d58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4623a6c79be5e5e8e9e5f6316940cff" id="r_af4623a6c79be5e5e8e9e5f6316940cff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af4623a6c79be5e5e8e9e5f6316940cff">convert_quantized_tflite_model</a> (<a class="el" href="_arduino_2_get_started_with_machine_learning_on_arduino_2model_8h.html#ae142afd8c2e2c711c1c62440deebe03c">model</a>, x_train)</td></tr>
<tr class="separator:af4623a6c79be5e5e8e9e5f6316940cff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85cba960694f5261adf80b13702e7ddd" id="r_a85cba960694f5261adf80b13702e7ddd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85cba960694f5261adf80b13702e7ddd">prepare_trained_model</a> (trained_model)</td></tr>
<tr class="separator:a85cba960694f5261adf80b13702e7ddd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8f9801a374a3d786c86df993ee9edad2" id="r_a8f9801a374a3d786c86df993ee9edad2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8f9801a374a3d786c86df993ee9edad2">FLAGS</a> = flags.FLAGS</td></tr>
<tr class="separator:a8f9801a374a3d786c86df993ee9edad2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">hellow_world model training for sinwave recognition

Run:
`bazel build tensorflow/lite/micro/examples/hello_world:train`
`bazel-bin/tensorflow/lite/micro/examples/hello_world/train --save_tf_model --save_dir=/tmp/model_created/`
</pre><pre class="fragment">LSTM model training for MNIST recognition

This script is based on:
https://www.tensorflow.org/lite/models/convert/rnn
https://colab.research.google.com/github/tensorflow/tensorflow/blob/master/tensorflow/lite/examples/experimental_new_converter/Keras_LSTM_fusion_Codelab.ipynb

Run:
`bazel build tensorflow/lite/micro/examples/mnist_lstm:train`
`bazel-bin/tensorflow/lite/micro/examples/mnist_lstm/train`
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="af4623a6c79be5e5e8e9e5f6316940cff" name="af4623a6c79be5e5e8e9e5f6316940cff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4623a6c79be5e5e8e9e5f6316940cff">&#9670;&#160;</a></span>convert_quantized_tflite_model()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">train.convert_quantized_tflite_model </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>x_train</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert the save TF model to tflite model, then save it as .tflite flatbuffer format

  See
  https://www.tensorflow.org/lite/performance/post_training_integer_quant#convert_using_integer-only_quantization

  Args:
      model (tf.keras.Model): the trained LSTM Model
      x_train (numpy.array): list of the training data

  Returns:
      The converted model in serialized format.
</pre> 
</div>
</div>
<a id="a1b2a0229e836037b5d6f724d951a8bcc" name="a1b2a0229e836037b5d6f724d951a8bcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b2a0229e836037b5d6f724d951a8bcc">&#9670;&#160;</a></span>convert_tflite_model()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">train.convert_tflite_model </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>model</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert the save TF model to tflite model, then save it as .tflite flatbuffer format
  Args:
      model (tf.keras.Model): the trained hello_world Model
  Returns:
      The converted model in serialized format.
</pre><pre class="fragment">Convert the save TF model to tflite model, then save it as .tflite flatbuffer format

  Args:
      model (tf.keras.Model): the trained LSTM Model

  Returns:
      The converted model in serialized format.
</pre> 
</div>
</div>
<a id="a8ef03f7932b3a3678637c4ff58516b55" name="a8ef03f7932b3a3678637c4ff58516b55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ef03f7932b3a3678637c4ff58516b55">&#9670;&#160;</a></span>create_model() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> tf.keras.Model train.create_model </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab2526ff2eeca1a68ab0d9f57b58baeb9" name="ab2526ff2eeca1a68ab0d9f57b58baeb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2526ff2eeca1a68ab0d9f57b58baeb9">&#9670;&#160;</a></span>create_model() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">train.create_model </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>units</em></span><span class="paramdefsep"> = </span><span class="paramdefval">20</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create a keras LSTM model for MNIST recognition

  Args:
      units (int, optional): dimensionality of the output space for the model.
        Defaults to 20.

  Returns:
      tf.keras.Model: A Keras LSTM model</pre> 
</div>
</div>
<a id="a03f8f9005bafb1842f04b550ede32fa9" name="a03f8f9005bafb1842f04b550ede32fa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03f8f9005bafb1842f04b550ede32fa9">&#9670;&#160;</a></span>get_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">train.get_data </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">The code will generate a set of random `x` values,calculate their sine
values.
</pre> 
</div>
</div>
<a id="acd913e867e7114d2bd578d5ddb485ea3" name="acd913e867e7114d2bd578d5ddb485ea3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd913e867e7114d2bd578d5ddb485ea3">&#9670;&#160;</a></span>get_train_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">train.get_train_data </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get MNIST train and test data

  Returns:
      tuple: (data, label) pairs for train and test</pre> 
</div>
</div>
<a id="a97731a176b4d14d8a1849221857402f5" name="a97731a176b4d14d8a1849221857402f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97731a176b4d14d8a1849221857402f5">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">train.main </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>_</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a85cba960694f5261adf80b13702e7ddd" name="a85cba960694f5261adf80b13702e7ddd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85cba960694f5261adf80b13702e7ddd">&#9670;&#160;</a></span>prepare_trained_model()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">train.prepare_trained_model </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>trained_model</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Fix the input of the trained model for inference

  Args:
      trained_model (tf.keras.Model): the trained LSTM model

  Returns:
      run_model (tf.keras.Model): the trained model with fixed input tensor size for inference
</pre> 
</div>
</div>
<a id="ab0c146b0ee08b9c4f6449dbdf9cfb7a1" name="ab0c146b0ee08b9c4f6449dbdf9cfb7a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0c146b0ee08b9c4f6449dbdf9cfb7a1">&#9670;&#160;</a></span>save_tflite_model()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">train.save_tflite_model </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>tflite_model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>save_dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>model_name</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">save the converted tflite model
Args:
    tflite_model (binary): the converted model in serialized format.
    save_dir (str): the save directory
    model_name (str): model name to be saved
</pre> 
</div>
</div>
<a id="a30c23e7d8d9adfbbd06e337d861f5d58" name="a30c23e7d8d9adfbbd06e337d861f5d58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30c23e7d8d9adfbbd06e337d861f5d58">&#9670;&#160;</a></span>train_lstm_model()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">train.train_lstm_model </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>epochs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>x_train</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>y_train</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Train keras LSTM model on MNIST dataset

  Args: epochs (int) : number of epochs to train the model
      x_train (numpy.array): list of the training data
      y_train (numpy.array): list of the corresponding array

  Returns:
      tf.keras.Model: A trained keras LSTM model
</pre> 
</div>
</div>
<a id="a9ef1ead644fe16c7ffb1c336953712af" name="a9ef1ead644fe16c7ffb1c336953712af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ef1ead644fe16c7ffb1c336953712af">&#9670;&#160;</a></span>train_model()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">train.train_model </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>epochs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>x_values</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>y_values</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Train keras hello_world model
  Args: epochs (int) : number of epochs to train the model
      x_train (numpy.array): list of the training data
      y_train (numpy.array): list of the corresponding array
  Returns:
      tf.keras.Model: A trained keras hello_world model
</pre> 
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a8f9801a374a3d786c86df993ee9edad2" name="a8f9801a374a3d786c86df993ee9edad2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f9801a374a3d786c86df993ee9edad2">&#9670;&#160;</a></span>FLAGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">train.FLAGS = flags.FLAGS</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
