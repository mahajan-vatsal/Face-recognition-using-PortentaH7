<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Machine Vision using Portenta H7: TensorFlow Lite Micro Peripherals</title>
<link rel="icon" href="logo.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Machine Vision using Portenta H7<span id="projectnumber">&#160;2</span>
   </div>
   <div id="projectbrief">This project aims to develop a face recognition-based access control system using the Arduino Portenta H7 and Vision Shield, leveraging Edge Impulse for machine learning. The system captures facial images, processes them locally using an AI model deployed on the Portenta H7 and determines access based on authorised personnel.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">TensorFlow Lite Micro Peripherals</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md41"></a></p>
<p>This directory provides drivers with generic interfaces to peripherals used with the TFLM examples.</p>
<p>Currently supported peripherals:</p><ul>
<li>Waveshare WM8960 Audio HAT</li>
<li>Button on Waveshare WM8960 Audio HAT</li>
<li>Default LED on Nano 33 BLE Sense</li>
</ul>
<h1><a class="anchor" id="autotoc_md42"></a>
Table of contents</h1>
<ul>
<li>TensorFlow Lite Micro Peripherals<ul>
<li>Waveshare WM8960 Audio HAT<ul>
<li>Supported Capabilities</li>
<li>Audio Board Pin Connections</li>
<li>Use with Tiny Machine Learning Kit (TMLK)<ul>
<li>Parts List and Tools Required</li>
<li>Assembly</li>
<li>Notes</li>
</ul>
</li>
<li>Testing</li>
</ul>
</li>
<li>Button</li>
<li>LEDs</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md43"></a>
Waveshare WM8960 Audio HAT</h1>
<p>The <a href="https://www.waveshare.com/wm8960-audio-hat.htm">Waveshare WM8960 Audio HAT</a> utilizes the WM8960 codec. This audio board provides a stereo 3.5mm earphone jack and 1W speaker outputs as well as stereo microphone inputs.</p>
<p>The earphone output is best used with 24 ohm (or higher) impedance headphones.</p>
<p>The USB power source must be capable of supplying a minimum of 500 milli-amps in order to use the audio board with speakers attached.</p>
<h2><a class="anchor" id="autotoc_md44"></a>
Supported Capabilities</h2>
<p>This audio board has the following supported capabilities:</p><ul>
<li>stereo input</li>
<li>stereo output</li>
<li>earphone output</li>
<li>1W (max) speaker output</li>
<li>8 or 16 bits per channel</li>
<li>standard samples rates from 8kHz to 48kHz</li>
<li>simultaneous record and playback</li>
</ul>
<h2><a class="anchor" id="autotoc_md45"></a>
Audio Board Pin Connections</h2>
<p>Even numbered pins are on the connector outside edge. Odd numbered pins are on the connector inside edge. With back facing up and text upright, pin 1 is on the left inside edge.</p>
<p>Male connectors are used for signals, female for power:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Pin</b>   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">5   </td><td class="markdownTableBodyNone">7   </td><td class="markdownTableBodyNone">9   </td><td class="markdownTableBodyNone">11   </td><td class="markdownTableBodyNone">13   </td><td class="markdownTableBodyNone">15   </td><td class="markdownTableBodyNone">17   </td><td class="markdownTableBodyNone">19   </td><td class="markdownTableBodyNone">21   </td><td class="markdownTableBodyNone">23   </td><td class="markdownTableBodyNone">25   </td><td class="markdownTableBodyNone">27   </td><td class="markdownTableBodyNone">29   </td><td class="markdownTableBodyNone">31   </td><td class="markdownTableBodyNone">33   </td><td class="markdownTableBodyNone">35   </td><td class="markdownTableBodyNone">37   </td><td class="markdownTableBodyNone">39    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Color</b>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Red   </td><td class="markdownTableBodyNone">Orange   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Yellow   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Blue   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Function</b>   </td><td class="markdownTableBodyNone">3.3V   </td><td class="markdownTableBodyNone">I2C_DATA   </td><td class="markdownTableBodyNone">I2C_CLK   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Ground   </td><td class="markdownTableBodyNone">BUTTON <br  />
 3.3V pull-up   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">3.3V   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Ground   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">I2S_LRCLK   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Ground    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Direction</b>   </td><td class="markdownTableBodyNone">NC   </td><td class="markdownTableBodyNone">IN/OUT   </td><td class="markdownTableBodyNone">IN   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">GND   </td><td class="markdownTableBodyNone">OUT   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">NC   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">GND   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">OUT   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">GND    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
</table>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Pin</b>   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">6   </td><td class="markdownTableBodyNone">8   </td><td class="markdownTableBodyNone">10   </td><td class="markdownTableBodyNone">12   </td><td class="markdownTableBodyNone">14   </td><td class="markdownTableBodyNone">16   </td><td class="markdownTableBodyNone">18   </td><td class="markdownTableBodyNone">20   </td><td class="markdownTableBodyNone">22   </td><td class="markdownTableBodyNone">24   </td><td class="markdownTableBodyNone">26   </td><td class="markdownTableBodyNone">28   </td><td class="markdownTableBodyNone">30   </td><td class="markdownTableBodyNone">32   </td><td class="markdownTableBodyNone">34   </td><td class="markdownTableBodyNone">36   </td><td class="markdownTableBodyNone">38   </td><td class="markdownTableBodyNone">40    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Color</b>   </td><td class="markdownTableBodyNone">White   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Black   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Green   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Purple   </td><td class="markdownTableBodyNone">Gray    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Function</b>   </td><td class="markdownTableBodyNone">5V   </td><td class="markdownTableBodyNone">5V   </td><td class="markdownTableBodyNone">Ground   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">I2S_BCLK   </td><td class="markdownTableBodyNone">Ground   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Ground   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Ground   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Ground   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">I2S_ADC   </td><td class="markdownTableBodyNone">I2S_DAC    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Direction</b>   </td><td class="markdownTableBodyNone">IN   </td><td class="markdownTableBodyNone">IN   </td><td class="markdownTableBodyNone">GND   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">OUT   </td><td class="markdownTableBodyNone">GND   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">GND   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">GND   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">GND   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">OUT   </td><td class="markdownTableBodyNone">IN    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
</table>
<p><a href="/docs/TMLK_WS_wm8960_images/IMG_1356.JPG"><img src="/docs/TMLK_WS_wm8960_images/IMG_1356.JPG" alt="top" class="inline"/></a> <a href="/docs/TMLK_WS_wm8960_images/IMG_1357.JPG"><img src="/docs/TMLK_WS_wm8960_images/IMG_1357.JPG" alt="bottom" class="inline"/></a></p>
<h2><a class="anchor" id="autotoc_md46"></a>
Use with Tiny Machine Learning Kit (TMLK)</h2>
<p>Wiring color in the tables matches the images in this document. Jumper wire vendors may have other color combinations.</p>
<p>Power is supplied to the audio board by the green terminal block on the TMLK shield. <code>VIN</code> of the terminal block supplies +5V.</p>
<p>Note: <code>VIN</code> is connected to <code>VUSB</code> on the Nano 33 BLE Sense, thus when the Nano 33 BLE Sense is powered by the USB cable, <code>VIN</code> will be an output.</p>
<p>Terminal block pins for power:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Pin   </th><th class="markdownTableHeadNone">Color   </th><th class="markdownTableHeadNone">Function    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">VIN   </td><td class="markdownTableBodyNone">White   </td><td class="markdownTableBodyNone">5V    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">GND   </td><td class="markdownTableBodyNone">Black   </td><td class="markdownTableBodyNone">Ground    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
</table>
<p>Dual row 20 pin connector for signaling:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Pin   </th><th class="markdownTableHeadNone">Color   </th><th class="markdownTableHeadNone">Function   </th><th class="markdownTableHeadNone">Direction   </th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone">Pin   </th><th class="markdownTableHeadNone">Color   </th><th class="markdownTableHeadNone">Function   </th><th class="markdownTableHeadNone">Direction    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">3.3V   </td><td class="markdownTableBodyNone">OUT   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Ground   </td><td class="markdownTableBodyNone">GND    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">Orange   </td><td class="markdownTableBodyNone">I2C_CLK   </td><td class="markdownTableBodyNone">OUT   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">Red   </td><td class="markdownTableBodyNone">I2C_DATA   </td><td class="markdownTableBodyNone">IN/OUT    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">5   </td><td class="markdownTableBodyNone">Yellow   </td><td class="markdownTableBodyNone">Button <br  />
 3.3V pull-up   </td><td class="markdownTableBodyNone">IN   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">6   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">7   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">8   </td><td class="markdownTableBodyNone">Green   </td><td class="markdownTableBodyNone">I2S_BCLK   </td><td class="markdownTableBodyNone">IN    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">9   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">10   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">11   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">12   </td><td class="markdownTableBodyNone">Purple   </td><td class="markdownTableBodyNone">I2S_ADC   </td><td class="markdownTableBodyNone">IN    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">13   </td><td class="markdownTableBodyNone">Gray   </td><td class="markdownTableBodyNone">I2S_DAC   </td><td class="markdownTableBodyNone">OUT   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">14   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">15   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">16   </td><td class="markdownTableBodyNone">Blue   </td><td class="markdownTableBodyNone">I2S_LRCLK   </td><td class="markdownTableBodyNone">IN    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">17   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">18   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">19   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">20   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
</table>
<p><a href="/docs/TMLK_WS_wm8960_images/IMG_1355.JPG"><img src="/docs/TMLK_WS_wm8960_images/IMG_1355.JPG" alt="pins" class="inline"/></a></p>
<h3><a class="anchor" id="autotoc_md47"></a>
Parts List and Tools Required</h3>
<p>The following tools are required:</p><ul>
<li>2.5mm (or smaller) slotted screwdriver</li>
</ul>
<p>Parts can be ordered from a number of vendors and distributors:</p><ul>
<li>DigiKey</li>
<li>Mouser</li>
<li>ProtoSupplies</li>
<li>Adafruit</li>
<li>SparkFun</li>
<li>Amazon</li>
<li>Arduino</li>
<li>Waveshare</li>
</ul>
<p>The following is the list of parts:</p><ul>
<li><a href="https://store-usa.arduino.cc/products/arduino-tiny-machine-learning-kit">Tiny Machine Learning Kit</a></li>
<li><a href="https://www.waveshare.com/wm8960-audio-hat.htm">Waveshare WM8960 Audio HAT</a></li>
<li>20cm male-male jumper wire, 2.54mm pitch (requires 2)</li>
<li>10cm male-female jumper wire, 2.54mm pitch (requires 7)</li>
<li>M2.5 25mm male-female nylon standoffs with nuts, (requires 6 standoffs, 8 nuts)</li>
</ul>
<p>The jumper wires are usually ordered in a pack of 40.</p>
<p>The nylon standoffs are usually ordered in a box assortment.</p>
<h3><a class="anchor" id="autotoc_md48"></a>
Assembly</h3>
<ol type="1">
<li>Remove <a class="el" href="class_o_v7675.html">OV7675</a> camera from dual row 20 pin connector in middle of TMLK shield</li>
<li>Add nylon standoffs to the TMLK shield mounting holes</li>
<li>Add nylon standoffs to 3 of 4 mounting holes on the audio board (see image). The two nylon standoffs at the end of the audio board will need an extra nut on the bottom side of the board to get the correct height.</li>
<li>The audio board attaches to the TMLK shield using a single nylon standoff, with the audio board on top of the TMLK shield (see image below)</li>
<li>On the TMLK shield, unscrew the green terminal block connections until the metal gate is fully in the down (open) position</li>
<li>Insert black 20cm male-male jumper wire into the <code>GND</code> connector of the green terminal block.</li>
<li>Insert white 20cm male-male jumper wire into the <code>VIN</code> connector of the green terminal block</li>
</ol>
<ol type="1">
<li>Turn the screws on the green terminal block connectors until the jumper wire pins are firmly held in place</li>
<li>Connect the white jumper wire to pin 2 on the bottom of the audio board.</li>
<li>Connect the black jumper wire to pin 6 on the bottom of the audio board.</li>
<li>Check there is a one pin gap between the white and black jumper connections on the bottom of the audio board (see <a href="/docs/TMLK_WS_wm8960_images/IMG_1362.JPG">image</a>). Failure to do this may result in a <b>FIRE</b>. <b>Fire</b> is <b>bad</b>.</li>
<li>Connect the signal pins using the pin connection tables and images above</li>
</ol>
<p>Fully assembled:</p>
<p><a href="/docs/TMLK_WS_wm8960_images/IMG_1363.JPG"><img src="/docs/TMLK_WS_wm8960_images/IMG_1363.JPG" alt="side view" class="inline"/></a></p>
<p>Additional images of fully assembled device:</p>
<p><a href="/docs/TMLK_WS_wm8960_images/IMG_1360.JPG"><img src="../../docs/TMLK_WS_wm8960_images/IMG_1360.JPG" alt="" width="200" class="inline"/></a> <a href="/docs/TMLK_WS_wm8960_images/IMG_1361.JPG"><img src="../../docs/TMLK_WS_wm8960_images/IMG_1361.JPG" alt="" width="200" class="inline"/></a> <a href="/docs/TMLK_WS_wm8960_images/IMG_1362.JPG"><img src="../../docs/TMLK_WS_wm8960_images/IMG_1362.JPG" alt="" width="200" class="inline"/></a></p>
<h3><a class="anchor" id="autotoc_md49"></a>
Notes</h3>
<ul>
<li>VIN/GND on TMLK board with all wires connected to WM8960<ul>
<li>4.66V with USB isolator</li>
<li>4.65V without USB isolator</li>
</ul>
</li>
<li>WM8960 crystal is 23.9996MHz</li>
<li>Oscilloscope measurements for 16KHz sample rate, 16 bits per channel, two channels<ul>
<li>LR clock is 15.9998KHz</li>
<li>Bit clock is 511.992KHz</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md50"></a>
Testing</h2>
<p>The <a href="/src/peripherals/examples/audio_play_record/audio_play_record.ino">audio_play_record</a> test application is an audio API usage example.</p>
<ol type="1">
<li>Open the Arduino IDE</li>
<li>Open the <code>File</code> menu and navigate to: <code>Examples -&gt; Arduino_TensorFlowLite -&gt; src -&gt; peripherals -&gt; audio_play_record</code></li>
<li>Load the <code>audio_play_record</code> application onto the Nano 33 BLE Sense</li>
<li>The application is running when the default LED on the Nano 33 BLE Sense is blinking.</li>
<li>Press and hold the button on the audio board (not the TMLK shield button) until the LED stops blinking. <br  />
 Audio is now being recorded. There is enough memory for approx. 3 seconds of recording. Release the button to stop recording or wait until the LED is again blinking.</li>
<li>Press and release the button on the audio board to play the previously recorded audio</li>
</ol>
<h1><a class="anchor" id="autotoc_md51"></a>
Button</h1>
<p>A generic button event API is provided in the <a href="/src/peripherals/button.h">button.h</a> header file.</p>
<p>The physical button will vary between peripherals and platforms. The GPIO pin that connects to the button is defined in the <a href="/src/peripherals/peripherals.h">peripherals.h</a> header file.</p>
<p>The generic button API provides access to the debounced up/down state of the button as well as the following button events:</p>
<ul>
<li>Button-Press</li>
<li>Button-Long-Press-Down</li>
<li>Button-Long-Press-Up</li>
</ul>
<h1><a class="anchor" id="autotoc_md52"></a>
LEDs</h1>
<p>A generic LED API is provided in the <a href="/src/peripherals/led.h">led.h</a> header file.</p>
<p>The physical default LED will vary between peripherals and platforms. The GPIO pin that connects to the default LED is defined in the <a href="/src/peripherals/peripherals.h">peripherals.h</a> header file.</p>
<p>The generic LED API provides the following functionality:</p>
<ul>
<li>Turning the LED on/off</li>
<li>Blinking the LED at an application defined duty cycle and rate </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
