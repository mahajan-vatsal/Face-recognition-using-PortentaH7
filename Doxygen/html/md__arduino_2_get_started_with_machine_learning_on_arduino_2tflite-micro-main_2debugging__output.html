<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Machine Vision using Portenta H7: How to debug invalid output</title>
<link rel="icon" href="logo.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Machine Vision using Portenta H7<span id="projectnumber">&#160;2</span>
   </div>
   <div id="projectbrief">This project aims to develop a face recognition-based access control system using the Arduino Portenta H7 and Vision Shield, leveraging Edge Impulse for machine learning. The system captures facial images, processes them locally using an AI model deployed on the Portenta H7 and determines access based on authorised personnel.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">How to debug invalid output</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md89"></a></p>
<p>The TFLM debugging output tools allow TFLM users to easily debug their models by providing a tool that will compare the intermediate values(output of each OP/Kernel) from a model post invoke between the TFLM and TfLite. As well as a way to compare intermediate values between TFLM x86 implementations and Optimized Implementations.</p>
<h1><a class="anchor" id="autotoc_md90"></a>
How to debug TFLM Interpreter output on embedded targets</h1>
<p>First you call a C++ binary that takes a TfLite model and returns a file that has random inputs and their corresponding output values for each layer of the model it was provided.</p>
<p>The second is you provide a TfLite model and file outputted by C++ binary above to a python script. The script runs TFLM x86 inference comparison to the expected output.</p>
<h1><a class="anchor" id="autotoc_md91"></a>
How to debug TFLM Python Interpreter output</h1>
<p>Using a python script mentioned in the section above when only a TfLite model is provided as input, the script generates random input and compares TFLM vs TfLite inference outputs for each layer of the model.</p>
<h1><a class="anchor" id="autotoc_md92"></a>
C++ Expected Layer by Layer Output Tool on TFLite Micro</h1>
<p>This C++ binary allows you to pass in a TfLite model and returns a flatbuffer file with input and the corresponding output values appended into it that can be passed into a python debugging tool which can compare those golden values vs the x86 TFLM reference kernel implementation.</p>
<p>The C++ Tool/binary will write a debugging file to the path provide in 2nd arg using the tflite_model provided in the 1st arg.</p>
<h4><a class="anchor" id="autotoc_md93"></a>
Command bazel/blaze:</h4>
<div class="fragment"><div class="line">bazel run tensorflow/lite/micro/tools:layer_cc -- \</div>
<div class="line">   &lt;/path/to/input_model.tflite&gt;</div>
<div class="line">  &lt;/path/to/output.file_name&gt;</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md94"></a>
How to Build using Makefile :</h4>
<div class="fragment"><div class="line">make -f tensorflow/lite/micro/tools/make/Makefile layer_by_layer_output_tool -j24</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md95"></a>
Python Layer by Layer Debugging Tool</h1>
<p>The Python Tool/Script can first be used to compare TFLM vs Tflite outputs for random inputs by only providing a TfLite file.</p>
<h3><a class="anchor" id="autotoc_md96"></a>
TfLite vs TFLM command:</h3>
<div class="fragment"><div class="line">bazel run tensorflow/lite/micro/tools:layer_by_layer_debugger -- \</div>
<div class="line">   --input_tflite_file=&lt;/path/to/my_model.tflite&gt;</div>
</div><!-- fragment --><p>The Python Tool/Script can also be used to compare TFLM's python x86 output vs expected output provided by the C++ Tool/binary.</p>
<h3><a class="anchor" id="autotoc_md97"></a>
TFLM vs Expected Command:</h3>
<div class="fragment"><div class="line">bazel run tensorflow/lite/micro/tools:layer_by_layer_debugger -- \</div>
<div class="line">  --input_tflite_file=&lt;/path/to/my_model.tflite&gt; \</div>
<div class="line">  --layer_by_layer_data_file=&lt;/path/to/my_debug_flatbuffer_file&gt;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md98"></a>
Optional Flags:</h3>
<p><code>--print_dump</code> When this flag is set, it will print the TFLM output for each layer that is compared.</p>
<p><code>--rng</code> Integer random number seed for generating input data for comparisons against TFLite. (Default: 42) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
