\chapter{Algorithms}
\section{Description}

The algorithm used in our Face Recognition project is Convolutional Neural Networks (CNNs), a lightweight Image Classification algorithm designed for resource-constrained devices. Convolutional Neural Networks form the core of the recognition model. CNNs are highly effective in processing image data due to their ability to detect spatial hierarchies in visual patterns. CNN leverages the strengths of depthwise separable convolutions while ensuring low computational requirements and high efficiency. This algorithm is optimized for real-time applications on embedded systems like the Portenta H7. \cite{vascellari2024}

\section{Application}

CNN can be applied in various scenarios where real-time Image Classification is required on low-power, low-compute devices. Typical applications include:

\begin{itemize}
	\item \textbf{Facial Recognition:} Identifying or verifying a person based on their facial features. \cite{restack2024}
	\item \textbf{Social Media Tagging:} Social media platforms use CNNs for tagging friends in photos. \cite{celerdata2024}
	\item \textbf{Autonomous Vehicles:} CNNs are utilized to detect pedestrians, traffic signs, and other vehicles on the road. \cite{alliancetek2024}
	\item \textbf{Medical Imaging:} CNNs are used in medical imaging applications to segment and identify tumors in MRI or CT scans. \cite{techtarget2024}
	\item \textbf{Navigation Assistance:} CNNs help in recognizing road signs, lane markings, and obstacles, enabling safer navigation. \cite{alliancetek2024}
\end{itemize}

\section{Hyperparameter}

The key hyperparameters for the CNNs algorithm include:

 \begin{itemize}
	\item \textbf{Learning Rate:} Controls the step size during the optimization process. \cite{brown_learning_rate_2023}
	\item \textbf{Batch Size:} Number of samples processed before the modelâ€™s internal parameters are updated. \cite{brown_learning_rate_2023}
	\item \textbf{Number of Epochs:} Number of times the learning algorithm will work through the entire training dataset. \cite{brown_learning_rate_2023}
	\item \textbf{Confidence Threshold:} Minimum confidence score for a detected object to be considered valid.
\end{itemize}

\section{Requirements}

    \begin{itemize}
	\item Arduino Vision Shield module with Vision Shield camera. \cite{arduino_portenta_camera_2023}
	\item Edge Impulse account and CLI tools. \cite{instructables_tinyml_edge_impulse_2023}
	\item TensorFlow Lite for Microcontrollers
	\item Arduino IDE or PlatformIO for deploying the model
\end{itemize}

\section{Input}

The input to the CNNs algorithm consists of images captured by the Vision Shield. These images are preprocessed to grayscale and resized to a standard input size required by the model.



\section{Output}
The outputs of the CNN algorithm is the predicted class label for the input image, indicating which person it corresponds to based on the trained model. Additionally, the CNN provides confidence scores for each class, reflecting the model's certainty about the prediction as a probability value between 0 and 1.

\section{Example with a Program}

Below is an example program  ~\ref{ExampleCode_Algorithm.ino} demonstrating the use of the CNN algorithm for Face recognition on the PortentaH7:


{
	\captionof{code}{Algorithm exmaple code}\label{ExampleCode_Algorithm.ino}
	\ArduinoExternal{}{../Code/EdgeImpulse/Algorithms/ExampleAlgorithm.ino}
}